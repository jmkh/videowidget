!function e(t,i,a){function n(o,d){if(!i[o]){if(!t[o]){var s="function"==typeof require&&require;if(!d&&s)return s(o,!0);if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var p=i[o]={exports:{}};t[o][0].call(p.exports,function(e){var i=t[o][1][e];return n(i||e)},p,p.exports,e,t,i,a)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({1:[function(e,t,i){"use strict";function a(e){(this.subscribers[e.type]||[]).forEach(function(t){t.fn.call(t.ctx,e.data)})}function n(e){e.data=e.data||{};var t={};e.type==d.AD_ERROR&&(t.ERRORCODE=e.data.code),e.type!==d.AD_STOP?a.call(this,new o(o.convertFromVAST(e.type),e.data)):(this.parameters.slot.parentNode.removeChild(this.parameters.slot),a.call(this,new o(o.convertFromVAST(e.type),null)))}function r(){this.subscribers={},this.parameters={version:"2.0"},this.flags={}}var o=e("./VPAIDEvent"),d=e("./VideoEvent"),s=e("./iFrameBridge");window.Bridge=s.Bridge,window.CallAction=s.callAction;var p=function e(){this.playedCnt=0,this.flags={canSendEvent:!0,middleEvent:[!1,!1,!1,!1,!1]};var t=this;this.bridge=new Bridge,this.index=this.bridge.index,this.bridge.addAction("adEvent",function(i){if(i.hasOwnProperty("eventName"))switch(i.eventName){case"firstQuartile":t.playedCnt++,console.log(["первый квартал",i.eventName]),e.$dispatchEvent.call(t,i.eventName,t.getMetaData());break;case"MyVastEnded":t.playedCnt?(console.log(["пришло окончательное событие",i.eventName]),t.stop()):e.$dispatchEvent.call(t,d.AD_ERROR,{data:"нет роликов"});break;case"mute":e.$dispatchEvent.call(t,d.AD_MUTE,t.getMetaData());break;case"complete":break;case"error":console.log(["megogo Error",i]);break;default:o.convertFromVAST(i.eventName);e.$dispatchEvent.call(t,i.eventName,t.getMetaData())}})};p.prototype.init=function(e,t,i){if(!this.flags.inited){this.flags.inited=!0,this.parent={dispatcher:t,context:i};var a=document.createElement("style"),n=document.createElement("iframe");n.style.width="100%",n.style.height="100%",n.style.display="block",n.style.border="none",n.scrolling="no",a.innerHTML=" video{display:none !important} ",n.src="//mp.klemix.ru/test.html?index="+this.index+"&affiliate_id="+this.parent.context.parameters.affiliate_id+"&pid="+this.parent.context.parameters.pid+"&width="+this.parent.context.parameters.size.width+"&height="+this.parent.context.parameters.size.height,this.myFrame=n,this.parent.context.parameters.slot.appendChild(a),this.parent.context.parameters.slot.appendChild(n)}},p.prototype.getMetaData=function(){return{}},p.prototype.stop=function(){console.log("kontrolog"),p.$dispatchEvent.call(this,d.AD_STOP,this.getMetaData())},p.prototype.resume=function(){console.log([333,this.myFrame.contentWindow]),CallAction("PLAY",{index:"broadcast"},this.myFrame.contentWindow)},p.prototype.play=function(){this.flags.started||this.flags.stopped||(this.flags.started=!0,p.$dispatchEvent.call(this,d.AD_START,this.getMetaData()),p.$dispatchEvent.call(this,d.AD_IMPRESSION,this.getMetaData()))},p.$dispatchEvent=function(e,t){this.flags.canSendEvent&&this.parent.dispatcher.call(this.parent.context,new d(e,t,this)),this.flags.canSendEvent=!0},r.prototype.handshakeVersion=function(){return this.parameters.version},r.prototype.initAd=function(e,t,i,r,d,s){if(!this.flags.inited){this.flags.inited=!0;var c=JSON.parse(d.AdParameters||"{}");if(!c.hasOwnProperty("affiliate_id"))return a.call(this,new o(o.AdError,'Missing mandatory parameters "affiliate_id" in AdParameters'));var l=c.affiliate_id;if(!c.hasOwnProperty("pid"))return a.call(this,new o(o.AdError,'Missing mandatory parameters "pid" in AdParameters'));var A=c.pid;this.parameters.size={width:e,height:t},this.parameters.pid=A,this.parameters.affiliate_id=l,this.parameters.bitrate=r,this.parameters.adParameters=c,this.parameters.creativeData=d,this.parameters.slot=s.slot,this.mediaPlayer=new p,this.mediaPlayer.init({mediapath:"",xmlLoader:""},n,this);var h=this;this.mediaPlayer.myFrame.onload=function(){a.call(h,new o(o.AdLoaded,{}))}}},r.prototype.startAd=function(){this.flags.started||(this.flags.started=!0,this.mediaPlayer.play())},r.prototype.stopAd=function(){this.flags.stopped||(this.flags.stopped=!0)},r.prototype.skipAd=function(){this.flags.stopped||(this.flags.stopped=!0)},r.prototype.resizeAd=function(e,t){!this.flags.stopped&&this.flags.inited&&(this.parameters.slot.style.width=e+"px",this.parameters.slot.style.height=t+"px")},r.prototype.pauseAd=function(){!this.flags.stopped&&this.flags.started},r.prototype.resumeAd=function(){console.log([1,"резюмируем",this.mediaPlayer]),!this.flags.stopped&&this.flags.started&&this.mediaPlayer.resume()},r.prototype.expandAd=function(){console.log("AdLog",'The method "expandAd" is not implemented')},r.prototype.collapseAd=function(){console.log("AdLog",'The method "collapseAd" is not implemented')},r.prototype.setAdVolume=function(e){!this.flags.stopped&&this.flags.started},r.prototype.getAdVolume=function(){},r.prototype.getAdDuration=function(){},r.prototype.getAdLinear=function(){return!0},r.prototype.getAdWidth=function(){return this.parameters.width},r.prototype.getAdHeight=function(){return this.parameters.height},r.prototype.getAdRemainingTime=function(){var e=this.mediaPlayer.getMetaData();return e.duration-e.currentTime},r.prototype.getAdExpanded=function(){return!1},r.prototype.getAdSkippableState=function(){return this.parameters.skippableState},r.prototype.getAdIcons=function(){return this.parameters.icons},r.prototype.getAdCompanions=function(){return this.parameters.companions},r.prototype.subscribe=function(e,t,i){"string"==typeof t&&(t=[t]);for(var a=0,n=t.length;a<n;a++){var r=t[a];this.subscribers[r]||(this.subscribers[r]=[]),this.subscribers[r].push({fn:e,ctx:i||null})}},r.prototype.unsubscribe=function(e,t){"string"==typeof t&&(t=[t]);for(var i=t.length;i>=0;i--){var a=this.subscribers[t[i]];if(a&&Array.isArray(a)&&a.length)for(var n=0,r=a.length;n<r;n++)a[n].fn===e&&a.splice(n,1)}},t.exports=r},{"./VPAIDEvent":2,"./VideoEvent":3,"./iFrameBridge":4}],2:[function(e,t,i){"use strict";function a(e,t){this.type=e,this.data=t}a.convertToVAST=function(e){return{AdLoaded:VideoEvent.AD_READY,AdVolumeChange:VideoEvent.AD_VOLUME_CHANGE,AdError:VideoEvent.AD_ERROR,AdStarted:VideoEvent.AD_START,AdImpression:VideoEvent.AD_IMPRESSION,AdStopped:VideoEvent.AD_STOP,AdPaused:VideoEvent.AD_PAUSE,AdPlaying:VideoEvent.AD_RESUME,AdVideoStart:VideoEvent.VIDEO_START,AdVideoFirstQuartile:VideoEvent.VIDEO_FIRST_QUARTILE,AdVideoMidpoint:VideoEvent.VIDEO_MIDPOINT,AdVideoThirdQuartile:VideoEvent.VIDEO_THIRD_QUARTILE,AdVideoComplete:VideoEvent.VIDEO_COMPLETE,AdUserClose:VideoEvent.USER_CLOSE,AdSkipped:VideoEvent.USER_SKIP,AdUserAcceptInvitation:VideoEvent.USER_ACCEPT_INVENTATION,AdInteraction:VideoEvent.USER_INTERACTION,AdClickThru:VideoEvent.USER_CLICK}[e]||""},a.convertFromVAST=function(e){return{ready:a.AdLoaded,volumeChange:a.AdVolumeChange,error:a.AdError,creativeView:a.AdStarted,impression:a.AdImpression,stop:a.AdStopped,pause:a.AdPaused,resume:a.AdPlaying,start:a.AdVideoStart,firstQuartile:a.AdVideoFirstQuartile,midpoint:a.AdVideoMidpoint,thirdQuartile:a.AdVideoThirdQuartile,complete:a.AdVideoComplete,closeLinear:a.AdUserClose,skip:a.AdSkipped,acceptInvitation:a.AdUserAcceptInvitation,interaction:a.AdInteraction,click:a.AdClickThru}[e]||""},a.AdLoaded="AdLoaded",a.AdStarted="AdStarted",a.AdStopped="AdStopped",a.AdSkipped="AdSkipped",a.AdLinearChange="AdLinearChange",a.AdSizeChange="AdSizeChange",a.AdExpandedChange="AdExpandedChange",a.AdSkippableStateChange="AdSkippableStateChange",a.AdRemainingTimeChange="AdRemainingTimeChange",a.AdDurationChange="AdDurationChange",a.AdVolumeChange="AdVolumeChange",a.AdImpression="AdImpression",a.AdVideoStart="AdVideoStart",a.AdVideoFirstQuartile="AdVideoFirstQuartile",a.AdVideoMidpoint="AdVideoMidpoint",a.AdVideoThirdQuartile="AdVideoThirdQuartile",a.AdVideoComplete="AdVideoComplete",a.AdClickThru="AdClickThru",a.AdInteraction="AdInteraction",a.AdUserAcceptInvitation="AdUserAcceptInvitation",a.AdUserMinimize="AdUserMinimize",a.AdUserClose="AdUserClose",a.AdPaused="AdPaused",a.AdPlaying="AdPlaying",a.AdLog="AdLog",a.AdError="AdError",t.exports=a},{}],3:[function(e,t,i){"use strict";var a=function(e,t){this.type=e,this.data=t};a.AD_READY="ready",a.AD_VOLUME_CHANGE="volumeChange",a.AD_ERROR="error",a.AD_STOP="stop",a.AD_START="creativeView",a.AD_IMPRESSION="impression",a.AD_MUTE="mute",a.AD_UNMUTE="unmute",a.AD_PAUSE="pause",a.AD_RESUME="resume",a.AD_REWIND="rewind",a.VIDEO_START="start",a.VIDEO_FIRST_QUARTILE="firstQuartile",a.VIDEO_MIDPOINT="midpoint",a.VIDEO_THIRD_QUARTILE="thirdQuartile",a.VIDEO_COMPLETE="complete",a.VIDEO_PROGRESS="progress",a.USER_CLOSE="closeLinear",a.USER_SKIP="skip",a.USER_ACCEPT_INVENTATION="acceptInvitation",a.USER_INTERACTION="interaction",a.USER_CLICK="click",t.exports=a},{}],4:[function(e,t,i){"use strict";function a(e){var e=e||r();return void 0===window.MpFrameBridges&&(window.MpFrameBridges={}),void 0!==window.MpFrameBridges[e]?window.MpFrameBridges[e]:(window.MpFrameBridges[e]=new o(e),window.MpFrameBridges[e])}function n(e,t,i){i.postMessage({name:e,data:t,bridgeAction:!0},"*")}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function o(e){this.index=e||r();var t={default:function(){}};this.execAction=function(e,i){(t[e]||t.default||function(){}).call(this,i)},this.addAction=function(e,i){t[e]=i},this.showActions=function(){console.log(t)}}window.makeBridge=a,window.mp_bridge_listener=function(e){if("object"==typeof e.data&&void 0!==e.data.bridgeAction&&1==e.data.bridgeAction){if("broadcast"==e.data.data.index&&void 0!==window.MpFrameBridges)for(var t in window.MpFrameBridges)window.MpFrameBridges.hasOwnProperty(t)&&window.MpFrameBridges[t].execAction(e.data.name,e.data.data);a(e.data.data.index).execAction(e.data.name,e.data.data)}},void 0===window.MpBridgeListenerAttached&&(window.addEventListener?window.addEventListener("message",mp_bridge_listener):window.attachEvent("onmessage",mp_bridge_listener),window.MpBridgeListenerAttached=!0),t.exports={Bridge:a,callAction:n}},{}],5:[function(e,t,i){"use strict";var a=e("./../models/IFRAMEInterface");window.getVPAIDAd=function(){return new a}},{"./../models/IFRAMEInterface":1}]},{},[5]);