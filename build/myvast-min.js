!function e(t,i,n){function r(s,a){if(!i[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){var i=t[s][1][e];return r(i||e)},l,l.exports,e,t,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){var n={getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},setCookie:function(e,t,i){i=i||{};var n=i.expires;if("number"==typeof n&&n){var r=new Date;r.setTime(r.getTime()+1e3*n),n=i.expires=r}n&&n.toUTCString&&(i.expires=n.toUTCString()),t=encodeURIComponent(t);var o=e+"="+t;for(var s in i){o+="; "+s;var a=i[s];a!==!0&&(o+="="+a)}document.cookie=o},deleteCookie:function(e){this.setCookie(e,"",{expires:-1})},hashCode:function(e){return e.split("").reduce(function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e},0)},getUserID:function(){var e=this.getCookie("MpVideoVisitorID"),t=this;return e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),t.setCookie("MpVideoVisitorID",e,{expires:864e3})),e},saveObject:function(e,t){var i=btoa(encodeURIComponent(JSON.stringify(e))),n=t||this.hashCode(i).toString(16);return this.setCookie(n,i,{expires:864e3}),n},getObject:function(e,t){var i=this.getCookie(e),n=null;if(void 0!==i&&i){var r=decodeURIComponent(atob(i));n=JSON.parse(r)}return void 0!==t&&t&&this.deleteCookie(e),n}};t.exports=n},{}],2:[function(e,t,i){function n(e){this.slot=e||document.querySelector("#videoslot"),this.slot.style.position="absolute",this.slot.style.top="0",this.slot.style.left="0",this.slot.style.width="100%",this.slot.style.height="100%",this.slot.style.zIndex=-1,this.tick=function(){},this.player=null;var t=r.getUserID(),i=r.getObject(t);i||(i={mute:!1,tvo:.2,vo:.7}),this.plSettings=i}var r=e("./CookieDriver");n.prototype.clear=function(){this.slot.innerHTML="",this.slot.style.display="none",this.slot.style.zIndex=-1},n.prototype.renderControl=function(e,t){switch(e){case"timeoutEl":var i=parseInt(t.dur)-parseInt(t.sec);i=i>0?i:0;var n="<span class='innerSpan'>–†–µ–∫–ª–∞–º–∞: "+i;return t.showControls&&t.skipTime>0&&(n+="  –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑: "+(t.skipTime>0?t.skipTime:0)),n+=" </span>";case"advLink":return"<span class='innerSpan' >"+t+"</span>";case"skipAd":return"<span class='innerSpan'>–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å </span>";case"closeAd":return"<span class='innerSpan'> </span>";case"muteButton":return"<span class='innerSpan "+(t?"un":"")+"mute'> </span>";default:return""}},n.prototype.init=function(e){var t=this;t.clear(),t.slot.style.zIndex=999,t.player=e,t.player.adVolume=t.plSettings.mute?0:t.plSettings.vo,t.Extentions={linkTxt:"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è",isClickable:0,controls:0,skipTime:"00:10",skipTime2:"00:05",skipAd:[],addClick:[]},t.player.vast.map("ads[0].extensions",function(e){"linkTxt"==e.type&&e.value&&(t.Extentions.linkTxt=e.value.replace(/^\s+|\s+$/,"")),"isClickable"==e.type&&e.value&&(t.Extentions.isClickable=e.value.replace(/^\s+|\s+$/,"")),"controls"==e.type&&e.value&&(t.Extentions.controls=e.value.replace(/^\s+|\s+$/,"")),"skipTime"==e.type&&e.value&&(t.Extentions.skipTime=e.value.replace(/^\s+|\s+$/,"")),"skipTime2"==e.type&&e.value&&(t.Extentions.skipTime2=e.value.replace(/^\s+|\s+$/,"")),"skipAd"==e.type&&e.value&&t.Extentions.skipAd.push(e.value.replace(/^\s+|\s+$/,"")),"addClick"==e.type&&e.value&&t.Extentions.addClick.push(e.value.replace(/^\s+|\s+$/,""))}),t.drawControls(),t.clickable.onclick=function(){t.ConrolePaused(t.Extentions.isClickable)},t.player.on("AdRemainingTimeChange",function(e){t.ControllerAction(e)}),this.slot.style.display="block"},n.prototype.drawControls=function(){var e=this;e.clickable=document.createElement("DIV"),e.clickable.setAttribute("id","clickable"),e.clickable.style.width="100%",e.clickable.style.height="100%",e.clickable.style.border="1px solid #000000",e.clickable.style.position="absolute",e.clickable.style.top="0",e.clickable.style.left="0",e.clickable.style.cursor="pointer",e.clickable.style.zIndex=1e3,e.slot.appendChild(e.clickable),e.resumeButton=document.createElement("DIV"),e.resumeButton.style.zIndex=1003,e.resumeButton.style.color="#FFFFFF",e.resumeButton.style.width="100%",e.resumeButton.style.height="100%",e.resumeButton.style.cursor="pointer",e.resumeButton.style.display="none",e.resumeButton.className="resume-play",e.clickable.appendChild(e.resumeButton);var t=document.createElement("div");t.id="timeoutDiv",e.player.timeoutDiv=t,e.slot.appendChild(t);var i=document.createElement("div");i.id="closeDiv",e.player.closeDiv=i,e.slot.appendChild(i),i.innerHTML=e.renderControl("closeAd"),i.style.display="none",i.onclick=function(t){t.preventDefault(),e.player.emit("close"),e.player.stopAd()};var n=document.createElement("div");e.player.skipDiv=n,n.id="skipDiv",e.slot.appendChild(n),n.innerHTML=e.renderControl("skipAd"),n.style.display="none",n.onclick=function(t){t.preventDefault(),e.player.emit("skip");for(var i=0;i<e.Extentions.skipAd.length;i++)(new Image).src=e.Extentions.skipAd[i];e.player.stopAd()};var o=document.createElement("div");o.id="advLink",e.player.advLink=o,e.slot.appendChild(o),o.innerHTML=e.renderControl("advLink",decodeURIComponent(e.Extentions.linkTxt)),e.player.vast.get("ads[0].creatives[0].videoClicks.clickThrough")||(o.style.display="none"),o.onclick=function(t){t.preventDefault();for(var i=0;i<e.Extentions.addClick.length;i++)(new Image).src=e.Extentions.addClick[i];e.ConrolePaused(1)};var s=document.createElement("div");s.id="muteButton",s.style.border="1px solid red",s.style.zIndex=9999,s.style.position="absolute",e.player.muteButton=s,e.slot.appendChild(s),s.innerHTML=e.renderControl("muteButton",e.player.adVolume),s.onclick=function(t){t.preventDefault(),e.player.adVolume=e.player.adVolume?0:.6;var i=r.getUserID();return e.player.adVolume?e.plSettings.mute=!1:e.plSettings.mute=!0,r.saveObject(e.plSettings,i),e.player.muteButton.innerHTML=e.renderControl("muteButton",e.player.adVolume),!1}},n.prototype.ControllerAction=function(e){var t=this;if(void 0!==t.player.timeoutDiv){var i=(60*parseInt(t.Extentions.skipTime.split(":")[0])+parseInt(t.Extentions.skipTime.split(":")[1]))%parseInt(e.dur),n=(60*parseInt(t.Extentions.skipTime2.split(":")[0])+parseInt(t.Extentions.skipTime2.split(":")[1]))%parseInt(e.dur);i>n&&(i=n);var r=n<=parseInt(e.sec)&&n>0,o=i<=parseInt(e.sec)&&i>0;e.skipTime=i-parseInt(e.sec),e.showControls="1"==t.Extentions.controls;var s=t.renderControl("timeoutEl",e);t.player.timeoutDiv.innerHTML=s,"1"==t.Extentions.controls&&r&&(t.player.closeDiv.style.display="block"),"1"==t.Extentions.controls&&o&&(t.player.skipDiv.style.display="block")}},n.prototype.ConrolePaused=function(e){if(this.player.isPaused)void 0!==this.resumeButton&&(this.resumeButton.style.display="none"),this.player.isPaused=0,this.player.resumeAd();else{this.player.isPaused=1,this.player.pauseAd(),this.resumeButton,this.resumeButton.style.display="block",this.player.emit("clickThrough");var t=this.player.vast.get("ads[0].creatives[0].videoClicks.clickThrough");e&&t&&window.open(t)}},t.exports=n},{"./CookieDriver":1}],3:[function(e,t,i){"use strict";function n(){var e=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(navigator.platform)for(;e.length;)if(navigator.platform===e.pop())return!0;return!1}function r(e){var t={size:{width:"350",height:"400"},container:"#mp-video-widget-container-56015401b3da9-20",auth:{affiliate_id:"56015401b3da9",pid:"20"},errorFn:function(){},successFn:function(e){}},i=t;for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);var s=this;this.loaded=!1;var a=i.auth.host.replace(/^www\./,"");this.configUrl="https://widget.market-place.su/videoopt/"+i.auth.affiliate_id+"_"+i.auth.pid+"_"+a+".json?p="+Math.random();var u=e.errorFn||function(){};e.successFn;o.ajax(this.configUrl,{errorFn:u,successFn:function(e){try{var t=JSON.parse(e);if(void 0!==t.error)throw new Error("–í–∏–¥–∂–µ—Ç —É–¥–∞–ª—ë–Ω.");for(var r in t)t.hasOwnProperty(r)&&(s[r]=t[r]);var a=/Android|Silk|Mobile|PlayBook/.test(window.navigator.userAgent),u=n();switch(s.isDesktop=!a,!0){case u:s.ads=t["ads-mobile"].iOS;break;case a:s.ads=t["ads-mobile"].Android}o.ajax("https://widget.market-place.su/proxy_referer/",{errorFn:function(){},successFn:function(e){try{var n=JSON.parse(e);s.loaded=!0,s.referer=n,i.successFn(s),window.parent.postMessage(t,"*")}catch(e){console.log("–±–∏—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è",e)}}})}catch(e){console.log("–±–∏—Ç–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è",e)}}})}var o=e("./httpclient");t.exports=r},{"./httpclient":5}],4:[function(e,t,i){"use strict";function n(e,t,i){this.controller=document.getElementById(e),this.container=document.getElementById(e),this.placeholder=document.getElementById(i),this.extraslot=document.createElement("DIV"),this.extraslot.id="videoslot",this.container.appendChild(this.extraslot),this.VideoSlot=new s(this.extraslot),this.queueToPLay=[],this.queueToPlaySemaphore=0,this.queueSemaphores={},this.queueToPlayExit=0,this.loadedStatuses={},this.cachedConf={},this.loadedCnt=0,this.playedCnt=0,this.playedRoliks={},this.config={},this.links=[],this.AllowedStart=0,this.timerToClose=80,this.collbackFunction=function(){},this.indexMassive={},this.indexDefault={},this.cacheStatisticIndexes={},this.cookieUserid=o.getUserID(),this.lastDriverId=0,this.mytype="Autoplay",this.playedAllCnt={},this.playedJumpedTop={},this.popularTrailer=0,this.OverplayAuto=0,this.OverplayDescFirst=0,this.referer="http://apptoday.ru";var n=this;void 0===this.GlobalMyGUITemp&&(this.GlobalMyGUITemp="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),window.GlobalMyGUITemp=this.GlobalMyGUITemp),this.fromUrl=window.location!=window.parent.location?document.referrer:document.location.href,this.fromDomain=new URL(this.fromUrl).hostname,window.addEventListener("resize",function(){n.calculateParameters()},!1),n.calculateParameters()}var r=e("vast-player"),o=e("./CookieDriver"),s=e("./VideoSlot"),a=e("./iFrameBridge");window.Bridge=a.Bridge,window.CallAction=a.callAction,n.prototype.firstPlaySignal=function(){this.OverplayDescFirst||(this.OverplayDescFirst=1)},n.prototype.calculateParameters=function(){screen.width,screen.height},n.prototype.setConfig=function(e,t){if(e.ads=[{id:18,src:"http://ads.adfox.ru/233872/getCode?pp=g&ps=ckql&p2=fboi",priority:"3",title:"Webarama",created_at:"2017-04-11 14:57:23",updated_at:"2017-04-11 14:57:23",pivot:{id_block:"21",id_source:"18",prioritet:"0"}},{id:41,src:"https://video.market-place.su/vast/flash.xml?r={rnd}",priority:"401",title:"—Ç–µ—Å—Ç swf –ª–∏–Ω–µ–∞—Ä",created_at:"2017-05-03 10:10:56",updated_at:"2017-05-03 10:10:56",pivot:{id_block:"21",id_source:"41",prioritet:"1"}}],e.hasOwnProperty("site")&&(this.fromDomain=e.site,console.log(["domain —Ä–æ–¥–∏—Ç–µ–ª—è",this.fromDomain])),e.hasOwnProperty("adslimit")||(e.adslimit=2),this.config=e,e.hasOwnProperty("referer")&&e.referer&&(this.referer=e.referer),this.collbackFunction=t,e.hasOwnProperty("type"))switch(e.type){case"1":this.mytype="Autoplay";break;case"2":this.mytype="Context";break;case"3":this.mytype="Overlay";break;case"4":this.mytype="VAST-Link";break;default:this.mytype="Video"}this.loadedCnt=e.ads.length,this.restartQueue(),this.loadedCnt=e.ads.length,this.initQueue(e.ads)},n.prototype.clearController=function(){this.controller.style.display="none"},n.prototype.showController=function(){this.controller.style.display="block"},n.prototype.clearContainer=function(){this.container.style.display="none"},n.prototype.showContainer=function(){this.container.style.display="block"},n.prototype.clearPlaceholder=function(){this.placeholder.style.display="none"},n.prototype.showPlaceholder=function(){this.placeholder.style.display="block"},n.prototype.timerToCloseFn=function(){if(this.timerToClose<0){this.LastControllerPan=document.createElement("DIV"),this.LastControllerPan.style.position="absolute",this.LastControllerPan.style.top="calc(50% - 50px)",this.LastControllerPan.style.left="calc(50% - 50px)",this.LastControllerPan.style.opacity="0.5",this.LastControllerPan.style.filter="alpha(Opacity=50)",this.LastControllerPan.style.color="#FFFFFF",this.LastControllerPan.style.zIndex="4500",this.LastControllerPan.className="lastController",this.LastcloseRemain=document.createElement("DIV"),this.LastcloseRemain.style.display="block",this.LastcloseRemain.style.marginLeft="5px",this.LastcloseRemain.fontSize="12px",this.LastcloseDiv=document.createElement("DIV"),this.LastcloseDiv.style.marginLeft="5px",this.LastcloseDiv.style.backgroundImage="url(https://apptoday.ru/ug/img/exit.png) ",this.LastcloseDiv.style.backgroundRepeat="no-repeat",this.LastcloseDiv.style.backgroundSize="contain",this.LastcloseDiv.style.content="",this.LastcloseDiv.className="hover_button",this.LastcloseDiv.style.width="100px",this.LastcloseDiv.style.height="100px",this.LastcloseDiv.title="–∑–∞–∫—Ä—ã—Ç—å —Ä–µ–∫–ª–∞–º—É",this.LastcloseDiv.style.cursor="pointer",this.LastcloseDiv.style.display="block";var e=this;return this.LastcloseDiv.onmouseout=function(){e.LastControllerPan.style.opacity="0.5",e.LastControllerPan.style.filter="alpha(Opacity=50)"},this.LastcloseDiv.onmouseover=function(){e.LastControllerPan.style.opacity="0.8",e.LastControllerPan.style.filter="alpha(Opacity=80)"},this.LastcloseDiv.onclick=function(){return document.body.innerHTML="",e.config.hasOwnProperty("page_index")?window.parent.postMessage({name:"die",data:{index:e.config.page_index},bridgeAction:!0},"*"):window.parent.postMessage({die:1},"*"),!0},this.LastControllerPan.appendChild(this.LastcloseRemain),this.LastControllerPan.appendChild(this.LastcloseDiv),void(this.controller&&this.controller.appendChild(this.LastControllerPan))}this.timerToClose--;var e=this;setTimeout(function(){e.timerToCloseFn()},1e3)},n.prototype.restartQueue=function(e){this.indexMassive={},this.predLoadQueue=[],this.queueToPlayExit=0,this.cachedFlagMy=0,this.loadedCnt=0,this.predLoadQueueCachedObjects={},this.loadedStatuses={},this.queueToPLay=[],this.queueSemaphores={}},n.prototype.CheckOverplaySrc=function(e){return(31==e||32==e)&&(this.OverplayAuto=1,!0)},n.prototype.calculatePlayed=function(){var e,t=0;for(e in this.playedRoliks)t++;return t},n.prototype.prepareFrame=function(e){var t=document.createElement("DIV");return t.id=e,t.style.display="none",t.style.width="100%",t.style.height="100%",this.container.appendChild(t),t},n.prototype.checkSemaphores=function(){var e,t=0,i=0;for(e in this.queueSemaphores)i++,this.queueSemaphores[e]&&(t=1);return!!t},n.prototype.deleteSemaphore=function(e){this.queueSemaphores[e]=0},n.prototype.setSemaphore=function(e){this.queueSemaphores[e]=1},n.prototype.dispatchQueue=function(e,t){if(console.log([1,t.message]),!this.queueToPlayExit){this.deleteSemaphore(e),t.player&&(t.player.container.style.display="none");var i,n=0,r=0;for(i in this.loadedStatuses)0==this.loadedStatuses[i]&&(n|=1),r++;r<this.loadedCnt&&(n|=2),this.queueToPLay.length&&(n|=4),this.checkSemaphores()&&(n|=8),n||this.playExit()}},n.prototype.initQueue=function(e){if(!this.queueToPlayExit){this.cachedFlagMy=1;for(var t=0,i=e.length;t<i;t++)t&&this.loadedCnt/t<=2&&(this.indexMassive[e[t].id]=2),20!=e[t].pivot.id_block&&28!=e[t].pivot.id_block||(this.popularTrailer=6),this.CheckOverplaySrc(e[t].id),this.predLoadQueue.push(e[t]);this.formLoadQueue(0)}},n.prototype.formLoadQueue=function(e){if(!this.predLoadQueueCachedObjects.hasOwnProperty(e)&&!this.queueToPlayExit){var t=this.calculatePlayed();if(this.config.adslimit<=t)return this.predLoadQueue=[],void(this.loadedCnt=t);this.predLoadQueueCachedObjects[e]=1;var i=this,n=this.predLoadQueue.shift();if(n){var o="bycredit_"+n.id,s=this.prepareFrame(o),a=new r(s,{withCredentials:!0,width:i.config.width,height:i.config.height,bidgeFn:function(e,t,n){switch(t){case"firstQuartile":i.sendStatistic({id:e,eventName:"filterPlayMedia"}),i.formLoadQueue(e)}i.sendStatistic({id:e,eventName:t}),void 0!==i.config.page_index&&CallAction("adEvent",{index:i.config.page_index,eventName:t},window.parent)}});a.id_local_source=n.id,a.local_title=n.title,a.local_src=n.src,this.loadQueue(a)}}},n.prototype.loadQueue=function(e){if(!this.queueToPlayExit){var t=this,i=e.local_src.replace(/\{([a-z]+)\}/g,function(e){switch(e.replace(/[\{\}]+/g,"")){case"rnd":return Math.random();case"ref":return encodeURIComponent(t.referer)}return e});this.loadedStatuses[e.id_local_source]=0,this.sendStatistic({id:e.id_local_source,eventName:"srcRequest"}),e.load(i).then(function(){console.log(["loaded 1"]),t.sendStatistic({id:e.id_local_source,eventName:"startPlayMedia",mess:""}),e.once("AdError",function(i){t.sendStatistic({id:e.id_local_source,eventName:"errorPlayMedia",mess:""}),t.formLoadQueue(e.id_local_source),t.dispatchQueue(e.id_local_source,{player:e,message:"–≤–µ—Ä–Ω—É–ª "+e.local_title+JSON.stringify(i)})}),e.once("AdStopped",function(){t.dispatchQueue(e.id_local_source,{player:e,message:" –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω "+e.local_title})}),t.loadedStatuses[e.id_local_source]=1,e.startAd().then(function(i){t.queueToPLay.length||3==e.id_local_source||36==e.id_local_source||40==e.id_local_source||2==e.pType?(e.pau=1,e.pauseAd()):e.pau=0,t.filterQueue(e)}).catch(function(i){t.sendStatistic({id:e.id_local_source,eventName:"errorPlayMedia",mess:""}),t.formLoadQueue(e.id_local_source),t.loadedStatuses[e.id_local_source]=2,t.dispatchQueue(e.id_local_source,{player:e,message:"–Ω–µ –∏–≥—Ä–∞–µ—Ç "+e.local_title+JSON.stringify(i)})})}).catch(function(i){t.sendStatistic({id:e.id_local_source,eventName:"errorPlayMedia",mess:""}),t.formLoadQueue(e.id_local_source),t.loadedStatuses[e.id_local_source]=2,t.dispatchQueue(e.id_local_source,{player:e,message:"–æ—à–∏–±–∫–∞ "+e.local_title+JSON.stringify(i)})})}},n.prototype.filterQueue=function(e){this.queueToPlayExit||(this.queueToPLay.push(e),this.playQueue())},n.prototype.playQueue=function(){if(!this.queueToPlayExit){var e=this;if(this.checkSemaphores())return void setTimeout(function(){e.playQueue()},500);var t=this.queueToPLay.shift();this.setSemaphore(t.id_local_source);var i=t.container;if(this.showController(),this.showContainer(),this.clearPlaceholder(),i.style.display="block",this.firstPlaySignal(),this.VideoSlot.clear(),3!=t.pType&&36!=t.pType||this.VideoSlot.init(t),4==t.pType||this.CheckOverplaySrc(t.id_local_source)){var n=1;t.on("AdRemainingTimeChange",function(t){n&&(n=0,e.clearPlaceholder())}),this.VideoSlot.clear(),2==this.playType&&t.once("AdPlaying",function(){e.container.style.opacity="0",e.container.style.filter="alpha(Opacity=0)"}),this.CheckOverplaySrc(t.id_local_source)&&t.once("AdPlaying",function(){e.OverplayAut=2,t.container.style.opacity="1",t.container.style.filter="alpha(Opacity=100)",e.container.style.opacity="1",e.container.style.filter="alpha(Opacity=100)",e.formLoadQueue(t.id_local_source),e.sendStatistic({id:t.id_local_source,eventName:"filterPlayMedia"})}),t.once("AdClickThru",function(i,n,r){e.showPlaceholder(),t.__private__.player.video.play(),t.container.style.opacity="1",t.container.style.filter="alpha(Opacity=100)",e.container.style.opacity="1",e.container.style.filter="alpha(Opacity=100)",e.VideoSlot.init(t)})}else t.container.style.opacity="1",t.container.style.filter="alpha(Opacity=100)",e.container.style.opacity="1",e.container.style.filter="alpha(Opacity=100)",1!=this.OverplayAut&&1==t.pau&&t.resumeAd()}},n.prototype.playExit=function(){this.queueToPlayExit||(this.queueToPlayExit=1,this.VideoSlot.clear(),this.controller.style.display="none",this.collbackFunction(this.config))},n.prototype.sendStatistic=function(e){if(!this.indexDefault.hasOwnProperty(e.id)){var t="";if(void 0!==e.eventName&&(void 0===this.cacheStatisticIndexes[e.id]&&(this.cacheStatisticIndexes[e.id]={}),void 0!==e.mess&&(t=e.mess),void 0===this.cacheStatisticIndexes[e.id][e.eventName])){switch(e.eventName){case"filterPlayMedia":this.playedRoliks[e.id]="fd"}this.cacheStatisticIndexes[e.id][e.eventName]=1;var i={key:this.GlobalMyGUITemp,fromUrl:encodeURIComponent(this.fromUrl),pid:this.config.pid,affiliate_id:this.config.affiliate_id,cookie_id:this.cookieUserid,id_src:e.id,event:e.eventName,mess:t},n="https://api.market-place.su/Product/video/l1stat.php?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(i));new Image(1,1).src=n}}},n.prototype.playAds=function(e,t){var i=this,n="bycredit_"+e.id,o=this.prepareFrame(n),s=new r(o,{withCredentials:!0,bidgeFn:function(e,t,i){t}});s.id_local_source=e.id,s.local_title=e.title,s.local_src=e.src,s.id_local_source;var a=s.local_src.replace(/\{([a-z]+)\}/g,function(e){switch(e.replace(/[\{\}]+/g,"")){case"rnd":return Math.random();case"ref":return encodeURIComponent(i.referer)}return e});s.load(a).then(function(){s.once("AdError",function(e){s.container.style.display="none",i.VideoSlot.clear(),t()}),s.once("AdStopped",function(){s.container.style.display="none",i.VideoSlot.clear(),t()}),s.id_local_source==-5&&(s.__private__.player.video.muted=!0,s.__private__.player.video.controls=!0),s.startAd().then(function(e){if(s.pauseAd(),i.showController(),i.showContainer(),i.clearPlaceholder(),o.style.display="block",3==s.pType&&(s.id_local_source==-5?s.__private__.player.video.controls=!0:i.VideoSlot.init(s)),4!=s.pType)s.container.style.opacity="1",s.container.style.filter="alpha(Opacity=100)",i.container.style.opacity="1",i.container.style.filter="alpha(Opacity=100)",s.resumeAd();else{if(s.id_local_source==-4)return s.container.style.display="none",i.VideoSlot.clear(),void t();var n=1;s.on("AdRemainingTimeChange",function(e){n&&(n=0,i.clearPlaceholder())}),i.VideoSlot.clear(),2==i.playType&&(i.container.style.opacity="0",i.container.style.filter="alpha(Opacity=0)"),s.once("AdClickThru",function(e,t,n){i.showPlaceholder(),s.__private__.player.video.play(),s.container.style.opacity="1",s.container.style.filter="alpha(Opacity=100)",i.container.style.opacity="1",i.container.style.filter="alpha(Opacity=100)",s.id_local_source==-5||i.VideoSlot.init(s)})}}).catch(function(e){s.container.style.display="none",i.VideoSlot.clear(),t()})}).catch(function(e){s.container.style.display="none",i.VideoSlot.clear(),t()})},n.prototype.playDefault=function(e){if(1&this.popularTrailer)return void e();this.popularTrailer|=1;if(this.config.hasOwnProperty("default")&&this.config.default){var t={id:-3,src:this.config.default,priority:"10",title:"–ó–∞–≥–ª—É—à–∫–∞",created_at:"2017-03-22 16:29:45",updated_at:"2017-03-22 16:29:45",pivot:{id_block:"-3",id_source:"-3",prioritet:"0"}};this.playAds(t,e)}else e()},n.prototype.playTvigle=function(e){if(2&this.popularTrailer)return void e();if(console.log("play tvigle 1"),this.popularTrailer|=2,/(android)/i.test(navigator.userAgent))return void e();var t={id:-4,src:"https://video.market-place.su/vast/tvigle.xml?r={rnd}",priority:"10",title:"–¢–≤–∏–≥–ª",created_at:"2017-03-22 16:29:45",updated_at:"2017-03-22 16:29:45",pivot:{id_block:"-4",id_source:"-4",prioritet:"0"}};this.playAds(t,e)},n.prototype.playTrailer=function(e){if(4&this.popularTrailer)return void e();this.popularTrailer|=4;var t={id:-5,src:"https://video.market-place.su/proxy_trailer/",priority:"10",title:"–¢—Ä–µ–π–ª–µ—Ä—ã",created_at:"2017-03-22 16:29:45",updated_at:"2017-03-22 16:29:45",pivot:{id_block:"-5",id_source:"-5",prioritet:"0"}};this.playAds(t,e)},t.exports=n},{"./CookieDriver":1,"./VideoSlot":2,"./iFrameBridge":6,"vast-player":25}],5:[function(e,t,i){"use strict";var n={ajax:function(e,t){var i=e;t=t||{};var n=t.errorFn||function(){},r=t.successFn||function(){},o=t.type||"GET",s=t.data||{},a=JSON.stringify(s);if(o=o.toUpperCase(),window.XMLHttpRequest)var u=new XMLHttpRequest;else var u=new ActiveXObject("Microsoft.XMLHTTP");if("GET"==o){a=null,i.indexOf("?")<0&&(i+="?1=1");for(var l in s)s.hasOwnProperty(l)&&(i+="&"+l+"="+s[l])}u.open(o,i,!0),u.onreadystatechange=function(){4==u.readyState?200==u.status?r({response:u.responseText}):n({status:u.status}):n({status:u.readyState})},u.onreadystatechange=function(){4==u.readyState&&(200==u.status?r(u.responseText):n({status:u.status}))};try{u.withCredentials=t.withCredentials||!1,u.send(a)}catch(e){}}};t.exports=n},{}],6:[function(e,t,i){"use strict";function n(e){var e=e||o();return void 0===window.MpFrameBridges&&(window.MpFrameBridges={}),void 0!==window.MpFrameBridges[e]?window.MpFrameBridges[e]:(window.MpFrameBridges[e]=new s(e),window.MpFrameBridges[e])}function r(e,t,i){i.postMessage({name:e,data:t,bridgeAction:!0},"*")}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function s(e){this.index=e||o();var t={default:function(){}};this.execAction=function(e,i){(t[e]||t.default||function(){}).call(this,i)},this.addAction=function(e,i){t[e]=i},this.showActions=function(){console.log(t)}}window.makeBridge=n,window.mp_bridge_listener=function(e){if("object"==typeof e.data&&void 0!==e.data.bridgeAction&&1==e.data.bridgeAction){if("broadcast"==e.data.data.index&&void 0!==window.MpFrameBridges)for(var t in window.MpFrameBridges)window.MpFrameBridges.hasOwnProperty(t)&&window.MpFrameBridges[t].execAction(e.data.name,e.data.data);n(e.data.data.index).execAction(e.data.name,e.data.data)}},void 0===window.MpBridgeListenerAttached&&(window.addEventListener?window.addEventListener("message",mp_bridge_listener):window.attachEvent("onmessage",mp_bridge_listener),window.MpBridgeListenerAttached=!0),t.exports={Bridge:n,callAction:r}},{}],7:[function(e,t,i){function n(e){if(e)return r(e)}function r(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}void 0!==t&&(t.exports=n),n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n,r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks["$"+e];if(i){i=i.slice(0);for(var n=0,r=i.length;n<r;++n)i[n].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],8:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,o,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i=this._events[e],a(i))return!1;if(r(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),u=1;u<n;u++)o[u-1]=arguments[u];i.apply(this,o)}else if(s(i)){for(n=arguments.length,o=new Array(n-1),u=1;u<n;u++)o[u-1]=arguments[u];for(l=i.slice(),n=l.length,u=0;u<n;u++)l[u].apply(this,o)}return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var i;i=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var n=!1;return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var i,n,o,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=this._events[e],o=i.length,n=-1,i===t||r(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(i)){for(a=o;a-- >0;)if(i[a]===t||i[a].listener&&i[a].listener===t){n=a;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i=this._events[e],r(i))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){return e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],9:[function(e,t,i){(function(e){"use strict";function i(){c=!0;for(var e,t,i=d.length;i;){for(t=d,d=[],e=-1;++e<i;)t[e]();i=d.length}c=!1}function n(e){1!==d.push(e)||c||r()}var r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var s=0,a=new o(i),u=e.document.createTextNode("");a.observe(u,{characterData:!0}),r=function(){u.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){i(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(i,0)};else{var l=new e.MessageChannel;l.port1.onmessage=i,r=function(){l.port2.postMessage(0)}}var c,d=[];t.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,i){"use strict";function n(){}function r(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,e!==n&&u(this,e)}function o(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function s(e,t,i){f(function(){var n;try{n=t(i)}catch(t){return y.reject(e,t)}n===e?y.reject(e,new TypeError("Cannot resolve promise with itself")):y.resolve(e,n)})}function a(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function u(e,t){function i(t){o||(o=!0,y.reject(e,t))}function n(t){
o||(o=!0,y.resolve(e,t))}function r(){t(n,i)}var o=!1,s=l(r);"error"===s.status&&i(s.value)}function l(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}function c(e){return e instanceof this?e:y.resolve(new this(n),e)}function d(e){var t=new this(n);return y.reject(t,e)}function p(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=new Array(i),s=0,a=-1,u=new this(n);++a<i;)!function(e,n){function a(e){o[n]=e,++s!==i||r||(r=!0,y.resolve(u,o))}t.resolve(e).then(a,function(e){r||(r=!0,y.reject(u,e))})}(e[a],a);return u}function h(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=-1,s=new this(n);++o<i;)!function(e){t.resolve(e).then(function(e){r||(r=!0,y.resolve(s,e))},function(e){r||(r=!0,y.reject(s,e))})}(e[o]);return s}var f=e("immediate"),y={},v=["REJECTED"],m=["FULFILLED"],g=["PENDING"];t.exports=r,r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if("function"!=typeof e&&this.state===m||"function"!=typeof t&&this.state===v)return this;var i=new this.constructor(n);if(this.state!==g){s(i,this.state===m?e:t,this.outcome)}else this.queue.push(new o(i,e,t));return i},o.prototype.callFulfilled=function(e){y.resolve(this.promise,e)},o.prototype.otherCallFulfilled=function(e){s(this.promise,this.onFulfilled,e)},o.prototype.callRejected=function(e){y.reject(this.promise,e)},o.prototype.otherCallRejected=function(e){s(this.promise,this.onRejected,e)},y.resolve=function(e,t){var i=l(a,t);if("error"===i.status)return y.reject(e,i.value);var n=i.value;if(n)u(e,n);else{e.state=m,e.outcome=t;for(var r=-1,o=e.queue.length;++r<o;)e.queue[r].callFulfilled(t)}return e},y.reject=function(e,t){e.state=v,e.outcome=t;for(var i=-1,n=e.queue.length;++i<n;)e.queue[i].callRejected(t);return e},r.resolve=c,r.reject=d,r.all=p,r.race=h},{immediate:9}],11:[function(e,t,i){!function(e,i){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=i():"function"==typeof define&&define.amd?define([],i):e.objectPath=i()}(this,function(){"use strict";function e(e){if(!e)return!0;if(o(e)&&0===e.length)return!0;for(var t in e)if(d.call(e,t))return!1;return!0}function t(e){return c.call(e)}function i(e){return"number"==typeof e||"[object Number]"===t(e)}function n(e){return"string"==typeof e||"[object String]"===t(e)}function r(e){return"object"==typeof e&&"[object Object]"===t(e)}function o(e){return"object"==typeof e&&"number"==typeof e.length&&"[object Array]"===t(e)}function s(e){return"boolean"==typeof e||"[object Boolean]"===t(e)}function a(e){var t=parseInt(e);return t.toString()===e?t:e}function u(t,r,o,s){if(i(r)&&(r=[r]),e(r))return t;if(n(r))return u(t,r.split("."),o,s);var l=a(r[0]);if(1===r.length){var c=t[l];return void 0!==c&&s||(t[l]=o),c}return void 0===t[l]&&(i(l)?t[l]=[]:t[l]={}),u(t[l],r.slice(1),o,s)}function l(t,r){if(i(r)&&(r=[r]),!e(t)){if(e(r))return t;if(n(r))return l(t,r.split("."));var s=a(r[0]),u=t[s];if(1===r.length)void 0!==u&&(o(t)?t.splice(s,1):delete t[s]);else if(void 0!==t[s])return l(t[s],r.slice(1));return t}}var c=Object.prototype.toString,d=Object.prototype.hasOwnProperty,p={};return p.ensureExists=function(e,t,i){return u(e,t,i,!0)},p.set=function(e,t,i,n){return u(e,t,i,n)},p.insert=function(e,t,i,n){var r=p.get(e,t);n=~~n,o(r)||(r=[],p.set(e,t,r)),r.splice(n,0,i)},p.empty=function(t,a){if(e(a))return t;if(!e(t)){var u,l;if(!(u=p.get(t,a)))return t;if(n(u))return p.set(t,a,"");if(s(u))return p.set(t,a,!1);if(i(u))return p.set(t,a,0);if(o(u))u.length=0;else{if(!r(u))return p.set(t,a,null);for(l in u)d.call(u,l)&&delete u[l]}}},p.push=function(e,t){var i=p.get(e,t);o(i)||(i=[],p.set(e,t,i)),i.push.apply(i,Array.prototype.slice.call(arguments,2))},p.coalesce=function(e,t,i){for(var n,r=0,o=t.length;r<o;r++)if(void 0!==(n=p.get(e,t[r])))return n;return i},p.get=function(t,r,o){if(i(r)&&(r=[r]),e(r))return t;if(e(t))return o;if(n(r))return p.get(t,r.split("."),o);var s=a(r[0]);return 1===r.length?void 0===t[s]?o:t[s]:p.get(t[s],r.slice(1),o)},p.del=function(e,t){return l(e,t)},p})},{}],12:[function(e,t,i){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var i=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),i.length>0)){i.shift()()}},!0),function(e){i.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],13:[function(e,t,i){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,i,o){t=t||"&",i=i||"=";var s={};if("string"!=typeof e||0===e.length)return s;e=e.split(t);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var u=e.length;a>0&&u>a&&(u=a);for(var l=0;l<u;++l){var c,d,p,h,f=e[l].replace(/\+/g,"%20"),y=f.indexOf(i);y>=0?(c=f.substr(0,y),d=f.substr(y+1)):(c=f,d=""),p=decodeURIComponent(c),h=decodeURIComponent(d),n(s,p)?r(s[p])?s[p].push(h):s[p]=[s[p],h]:s[p]=h}return s};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],14:[function(e,t,i){"use strict";function n(e,t){if(e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n));return i}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,i,a){return t=t||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(n){var s=encodeURIComponent(r(n))+i;return o(e[n])?e[n].map(function(e){return s+encodeURIComponent(r(e))}).join(t):s+encodeURIComponent(r(e[n]))}).join(t):a?encodeURIComponent(r(a))+i+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}},{}],15:[function(e,t,i){"use strict";i.decode=i.parse=e("./decode"),i.encode=i.stringify=e("./encode")},{"./decode":13,"./encode":14}],16:[function(e,t,i){t.exports=function(e,t,i){for(var n=0,r=e.length,o=3==arguments.length?i:e[n++];n<r;)o=t.call(null,o,e[n],++n,e);return o}},{}],17:[function(e,t,i){var n,r,o,s=e("object-path");o=function(e){return function(t){return typeof t===e}},r=function(e,t){var i=1,n=t||function(e,t){return t};return"-"===e[0]&&(i=-1,e=e.substr(1)),function(t,r){var o,a=n(e,s.get(t,e)),u=n(e,s.get(r,e));return a<u&&(o=-1),a>u&&(o=1),a===u&&(o=0),o*i}},n=function(){var e=Array.prototype.slice.call(arguments),t=e.filter(o("string")),i=e.filter(o("function"))[0];return function(e,n){for(var o=t.length,s=0,a=0;0===s&&a<o;)s=r(t[a],i)(e,n),a++;return s}},t.exports=n},{"object-path":11}],18:[function(e,t,i){function n(){}function r(e){switch({}.toString.call(e)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function o(e){if(!_(e))return e;var t=[];for(var i in e)null!=e[i]&&s(t,i,e[i]);return t.join("&")}function s(e,t,i){if(Array.isArray(i))return i.forEach(function(i){s(e,t,i)});e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}function a(e){for(var t,i,n={},r=e.split("&"),o=0,s=r.length;o<s;++o)i=r[o],t=i.split("="),n[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return n}function u(e){var t,i,n,r,o=e.split(/\r?\n/),s={};o.pop();for(var a=0,u=o.length;a<u;++a)i=o[a],t=i.indexOf(":"),n=i.slice(0,t).toLowerCase(),r=w(i.slice(t+1)),s[n]=r;return s}function l(e){return/[\/+]json\b/.test(e)}function c(e){return e.split(/ *; */).shift()}function d(e){return m(e.split(/ *; */),function(e,t){var i=t.split(/ *= */),n=i.shift(),r=i.shift();return n&&r&&(e[n]=r),e},{})}function p(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=u(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function h(e,t){var i=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new p(i)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,e.rawResponse=i.xhr&&i.xhr.responseText?i.xhr.responseText:null,e.statusCode=i.xhr&&i.xhr.status?i.xhr.status:null,i.callback(e)}if(i.emit("response",t),e)return i.callback(e,t);if(t.status>=200&&t.status<300)return i.callback(e,t);var n=new Error(t.statusText||"Unsuccessful HTTP response");n.original=e,n.response=t,n.status=t.status,i.callback(n,t)})}function f(e,t){var i=A("DELETE",e);return t&&i.end(t),i}var y,v=e("emitter"),m=e("reduce"),g=e("./request-base"),_=e("./is-object");y="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var A=t.exports=e("./request").bind(null,h);A.getXHR=function(){if(!(!y.XMLHttpRequest||y.location&&"file:"==y.location.protocol&&y.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1};var w="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};A.serializeObject=o,A.parseString=a,A.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},A.serialize={"application/x-www-form-urlencoded":o,"application/json":JSON.stringify},A.parse={"application/x-www-form-urlencoded":a,"application/json":JSON.parse},p.prototype.get=function(e){return this.header[e.toLowerCase()]},p.prototype.setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=c(t);var i=d(t);for(var n in i)this[n]=i[n]},p.prototype.parseBody=function(e){var t=A.parse[this.type];return!t&&l(this.type)&&(t=A.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null},p.prototype.setStatusProperties=function(e){1223===e&&(e=204);var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},p.prototype.toError=function(){var e=this.req,t=e.method,i=e.url,n="cannot "+t+" "+i+" ("+this.status+")",r=new Error(n);return r.status=this.status,r.method=t,r.url=i,r},A.Response=p,v(h.prototype);for(var b in g)h.prototype[b]=g[b];h.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr&&this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},h.prototype.type=function(e){return this.set("Content-Type",A.types[e]||e),this},h.prototype.responseType=function(e){return this._responseType=e,this},h.prototype.accept=function(e){return this.set("Accept",A.types[e]||e),this},h.prototype.auth=function(e,t,i){switch(i||(i={type:"basic"}),i.type){case"basic":var n=btoa(e+":"+t);this.set("Authorization","Basic "+n);break;case"auto":this.username=e,this.password=t}return this},h.prototype.query=function(e){return"string"!=typeof e&&(e=o(e)),e&&this._query.push(e),this},h.prototype.attach=function(e,t,i){return this._getFormData().append(e,t,i||t.name),this},h.prototype._getFormData=function(){return this._formData||(this._formData=new y.FormData),this._formData},h.prototype.send=function(e){var t=_(e),i=this._header["content-type"];if(t&&_(this._data))for(var n in e)this._data[n]=e[n];else"string"==typeof e?(i||this.type("form"),i=this._header["content-type"],this._data="application/x-www-form-urlencoded"==i?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||r(e)?this:(i||this.type("json"),this)},p.prototype.parse=function(e){return y.console&&console.warn("Client-side parse() method has been renamed to serialize(). This method is not compatible with superagent v2.0"),this.serialize(e),this},p.prototype.serialize=function(e){return this._parser=e,this},h.prototype.callback=function(e,t){var i=this._callback;this.clearTimeout(),i(e,t)},h.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},h.prototype.timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},h.prototype.withCredentials=function(){return this._withCredentials=!0,this},h.prototype.end=function(e){var t=this,i=this.xhr=A.getXHR(),o=this._query.join("&");this._timeout=15e3;var s=this._timeout,a=this._formData||this._data;this._callback=e||n,i.onreadystatechange=function(){if(4==i.readyState){var e;try{e=i.status}catch(t){e=0}if(0==e){if(t.timedout)return t.timeoutError();if(t.aborted)return;return t.crossDomainError()}t.emit("end")}};var u=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),e.direction="download",t.emit("progress",e)};this.hasListeners("progress")&&(i.onprogress=u);try{i.upload&&this.hasListeners("progress")&&(i.upload.onprogress=u)}catch(e){}if(s&&!this._timer&&(this._timer=setTimeout(function(){t.timedout=!0,t.abort()},s)),o&&(o=A.serializeObject(o),this.url+=~this.url.indexOf("?")?"&"+o:"?"+o),this.username&&this.password?i.open(this.method,this.url,!0,this.username,this.password):i.open(this.method,this.url,!0),this._withCredentials&&(i.withCredentials=!0),i.withCredentials=!0,"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof a&&!r(a)){var c=this._header["content-type"],d=this._parser||A.serialize[c?c.split(";")[0]:""];!d&&l(c)&&(d=A.serialize["application/json"]),d&&(a=d(a))}for(var p in this.header)null!=this.header[p]&&i.setRequestHeader(p,this.header[p]);return this._responseType&&(i.responseType=this._responseType),this.emit("request",this),i.send(void 0!==a?a:null),this},A.Request=h,A.get=function(e,t,i){var n=A("GET",e);return"function"==typeof t&&(i=t,t=null),t&&n.query(t),i&&n.end(i),n},A.head=function(e,t,i){var n=A("HEAD",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n},A.del=f,A.delete=f,A.patch=function(e,t,i){var n=A("PATCH",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n},A.post=function(e,t,i){var n=A("POST",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n},A.put=function(e,t,i){var n=A("PUT",e);return"function"==typeof t&&(i=t,t=null),t&&n.send(t),i&&n.end(i),n}},{"./is-object":19,"./request":21,"./request-base":20,emitter:7,reduce:16}],19:[function(e,t,i){function n(e){return null!=e&&"object"==typeof e}t.exports=n},{}],20:[function(e,t,i){var n=e("./is-object");i.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},i.parse=function(e){return this._parser=e,this},i.timeout=function(e){return this._timeout=e,this},i.then=function(e,t){return this.end(function(i,n){i?t(i):e(n)})},i.use=function(e){return e(this),this},i.get=function(e){return this._header[e.toLowerCase()]},i.getHeader=i.get,i.set=function(e,t){if(n(e)){for(var i in e)this.set(i,e[i]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},i.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},i.field=function(e,t){return this._getFormData().append(e,t),this}},{"./is-object":19}],21:[function(e,t,i){function n(e,t,i){return"function"==typeof i?new e("GET",t).end(i):2==arguments.length?new e("GET",t):new e(t,i)}t.exports=n},{}],22:[function(e,t,i){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],23:[function(e,t,i){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],24:[function(e,t,i){(function(t,n){function r(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(t)?n.showHidden=t:t&&i._extend(n,t),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,e,n.depth)}function o(e,t){var i=r.styles[t];return i?"["+r.colors[i][0]+"m"+e+"["+r.colors[i][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,i){t[e]=!0}),t}function u(e,t,n){if(e.customInspect&&t&&T(t.inspect)&&t.inspect!==i.inspect&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return _(r)||(r=u(e,r,n)),r}var o=l(e,t);if(o)return o;var s=Object.keys(t),y=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),E(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(t);if(0===s.length){if(T(t)){var v=t.name?": "+t.name:"";return e.stylize("[Function"+v+"]","special")}if(b(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(E(t))return c(t)}var m="",g=!1,A=["{","}"];if(f(t)&&(g=!0,A=["[","]"]),T(t)){m=" [Function"+(t.name?": "+t.name:"")+"]"}if(b(t)&&(m=" "+RegExp.prototype.toString.call(t)),k(t)&&(m=" "+Date.prototype.toUTCString.call(t)),E(t)&&(m=" "+c(t)),0===s.length&&(!g||0==t.length))return A[0]+m+A[1];if(n<0)return b(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var w;return w=g?d(e,t,n,y,s):s.map(function(i){return p(e,t,n,y,i,g)}),e.seen.pop(),h(w,m,A)}function l(e,t){if(w(t))return e.stylize("undefined","undefined");if(_(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}return g(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,i,n,r){for(var o=[],s=0,a=t.length;s<a;++s)D(t,String(s))?o.push(p(e,t,i,n,String(s),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(p(e,t,i,n,r,!0))}),o}function p(e,t,i,n,r,o){var s,a,l;if(l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},l.get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),D(n,r)||(s="["+r+"]"),a||(e.seen.indexOf(l.value)<0?(a=v(i)?u(e,l.value,null):u(e,l.value,i-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),w(s)){if(o&&r.match(/^\d+$/))return a;s=JSON.stringify(""+r),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function h(e,t,i){var n=0;return e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1]:i[0]+t+" "+e.join(", ")+" "+i[1]}function f(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function v(e){return null===e}function m(e){return null==e}function g(e){return"number"==typeof e}function _(e){return"string"==typeof e}function A(e){return"symbol"==typeof e}function w(e){return void 0===e}function b(e){return x(e)&&"[object RegExp]"===S(e)}function x(e){return"object"==typeof e&&null!==e}function k(e){return x(e)&&"[object Date]"===S(e)}function E(e){return x(e)&&("[object Error]"===S(e)||e instanceof Error)}function T(e){return"function"==typeof e}function C(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function S(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),F[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}i.format=function(e){if(!_(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(r(arguments[i]));return t.join(" ")}for(var i=1,n=arguments,o=n.length,s=String(e).replace(/%[sdj%]/g,function(e){if("%%"===e)return"%";if(i>=o)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return e}}),a=n[i];i<o;a=n[++i])v(a)||!x(a)?s+=" "+a:s+=" "+r(a);return s},i.deprecate=function(e,r){function o(){if(!s){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),s=!0}return e.apply(this,arguments)}if(w(n.process))return function(){return i.deprecate(e,r).apply(this,arguments)};if(t.noDeprecation===!0)return e;var s=!1;return o};var I,V={};i.debuglog=function(e){if(w(I)&&(I=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!V[e])if(new RegExp("\\b"+e+"\\b","i").test(I)){var n=t.pid;V[e]=function(){var t=i.format.apply(i,arguments);console.error("%s %d: %s",e,n,t)}}else V[e]=function(){};return V[e]},i.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=f,i.isBoolean=y,i.isNull=v,i.isNullOrUndefined=m,i.isNumber=g,i.isString=_,i.isSymbol=A,i.isUndefined=w,i.isRegExp=b,i.isObject=x,i.isDate=k,i.isError=E,i.isFunction=T,i.isPrimitive=C,i.isBuffer=e("./support/isBuffer");var F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];i.log=function(){console.log("%s - %s",L(),i.format.apply(i,arguments))},i.inherits=e("inherits"),i._extend=function(e,t){if(!t||!x(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e}}).call(this,e("pBGvAp"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":23,inherits:22,pBGvAp:12}],25:[function(e,t,i){t.exports=e("./lib/VASTPlayer")},{"./lib/VASTPlayer":29}],26:[function(e,t,i){"use strict";function n(e,t,i){t.on(e,function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];i.emit.apply(i,[e].concat(t))})}function r(e,t,i){i.forEach(function(i){t.listeners(i).length>0&&n(i,e,t)}),t.on("newListener",function(r){i.indexOf(r)>-1&&t.listeners(r).length<1&&n(r,e,t)})}function o(e){this.events=e.slice(),this.__private__={target:null,source:null}}o.prototype.from=function(e){return this.__private__.source=e,this.__private__.target&&r(e,this.__private__.target,this.events),this},o.prototype.to=function(e){return this.__private__.target=e,this.__private__.source&&r(this.__private__.source,e,this.events),this},t.exports=o},{}],27:[function(e,t,i){"use strict";function n(e){var t=this;r.call(this,Math.floor(e.duration||0)),this.video=e,[s.PLAYING,s.PAUSE,s.TIMEUPDATE].forEach(function(i){return e.addEventListener(i,function(){return t.tick()},!1)})}var r=e("./VideoTracker"),o=e("util").inherits,s=e("./enums/HTML_MEDIA_EVENTS");o(n,r),n.prototype._getState=function(){return{playing:!this.video.paused,currentTime:this.video.currentTime}},t.exports=n},{"./VideoTracker":31,"./enums/HTML_MEDIA_EVENTS":32,util:24}],28:[function(e,t,i){"use strict";function n(e){return e}function r(e,t){this.pauseFlag=1,this.resumeFlag=1,this.pixels=e.reduce(function(e,t){return(e[t.event]||(e[t.event]=[])).push(t.uri),e},{}),this.__private__={mapper:t||n}}e("./enums/VPAID_EVENTS");r.prototype.track=function(e){this.pixels,this.__private__.mapper,e.adVolume;console.log("–∑–∞—Ä—É")},t.exports=r},{"./enums/VPAID_EVENTS":34}],29:[function(e,t,i){"use strict";function n(){var e=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(navigator.platform)for(;e.length;)if(navigator.platform===e.pop())return!0;return!1}function r(){var e,t,i,n,o={},s=arguments.length;for(e=0;e<s;e++){t=arguments[e]||{};for(i in t)n=t[i],void 0===o[i]&&(o[i]=n),"object"==typeof n&&(o[i]=r(o[i],n))}return o}function o(e){return e}function s(){return new Error("VASTPlayer not ready.")}function a(e){return function(){var t=this,i=this.__private__.player;return this.ready?i[e].apply(i,arguments).then(function(){return t}):w.reject(s())}}function u(e){return{get:function(){if(!this.ready)throw s();return this.__private__.player[e]},set:function(t){if(!this.ready)throw s();return this.__private__.player[e]=t}}}function l(e,t){var i=this;c.call(this),this.__private__={container:e,config:r(t,{vast:{withCredentials:!0,resolveWrappers:!0,maxRedirects:7},tracking:{mapper:o}}),vast:null,ready:!1,player:null,pType:0},this.on(_.AdClickThru,function(e,t,n){if(this.chekcClicked())return!0;var r=e||i.vast.get("ads[0].creatives[0].videoClicks.clickThrough");n&&r&&window.open(r)})}var c=e("events").EventEmitter,d=e("util").inherits,p=e("vastacular").VAST,h=e("./players/JavaScriptVPAID"),f=e("./players/FlashVPAID"),y=e("./players/HTMLVideo"),v=e("./players/ANDROIDVideo"),m=e("./players/IOSVideo"),g=e("./enums/MIME"),_=e("./enums/VPAID_EVENTS"),A=e("./EventProxy"),w=e("lie"),b=e("./PixelReporter");d(l,c),Object.defineProperties(l.prototype,{container:{get:function(){return this.__private__.container}},config:{get:function(){return this.__private__.config}},vast:{get:function(){return this.__private__.vast}},ready:{get:function(){return this.__private__.ready}},adRemainingTime:u("adRemainingTime"),adDuration:u("adDuration"),adVolume:u("adVolume")}),l.prototype.chekcClicked=function(){return 4!=this.pType||this.__private__.player.privateStarted?0:(this.__private__.player.privateStarted=1,1)},l.prototype.load=function(e){var t=this,i=this.config.vast;return p.fetch(e,i).then(function(e){var i=n(),r=/(android)/i.test(navigator.userAgent),o=function(){var n=e.filter("ads[0].creatives[0].mediaFiles",function(e){return(e.type===g.JAVASCRIPT||"application/x-javascript"===e.type)&&"VPAID"===e.apiFramework}),o=e.filter("ads[0].creatives[0].mediaFiles",function(e){return e.type===g.FLASH&&"VPAID"===e.apiFramework}),s=e.filter("ads[0].creatives[0].mediaFiles",function(){return!0});return n.length>0?(t.pType=1,{player:new h(t.container),mediaFiles:n}):o.length>0?(t.pType=2,{player:new f(t.container,l.vpaidSWFLocation,t.config),mediaFiles:o}):(t.pType=3,i?{player:new m(t.container),mediaFiles:s}:r?(t.pType=4,{player:new v(t.container),mediaFiles:s}):{player:new y(t.container),mediaFiles:s})}(),s=e.get("ads[0].creatives[0].parameters"),a=[].concat(e.map("ads[0].impressions",function(e){return{event:"impression",uri:e.uri}}),e.map("ads[0].errors",function(e){return{event:"error",uri:e}}),e.get("ads[0].creatives[0].trackingEvents"),e.map("ads[0].creatives[0].videoClicks.clickTrackings",function(e){return{event:"clickThrough",uri:e}})),u=o.player,c=o.mediaFiles,d=new A(_),p=new b(a,t.config.tracking.mapper);return p.PlayToBridge=function(e,t){return 1},"function"==typeof t.config.bidgeFn&&(p.PlayToBridge=function(e,i){return t.config.bidgeFn(t.id_local_source,e,i),1}),d.from(u).to(t),t.__private__.vast=e,t.__private__.player=u,u.id1=t.id_local_source,u.load(c,s).then(function(){p.track(u)})}).then(function(){return t.__private__.ready=!0,t.emit("ready"),t}).catch(function(e){throw t.emit("error",e),e})},l.prototype.startAd=a("startAd"),l.prototype.stopAd=a("stopAd"),l.prototype.pauseAd=a("pauseAd"),l.prototype.resumeAd=a("resumeAd"),l.vpaidSWFLocation="https://apptoday.ru/dev/vast-player-vpaid.swf",t.exports=l},{"./EventProxy":26,"./PixelReporter":28,"./enums/MIME":33,"./enums/VPAID_EVENTS":34,"./players/ANDROIDVideo":36,"./players/FlashVPAID":37,"./players/HTMLVideo":38,"./players/IOSVideo":39,"./players/JavaScriptVPAID":41,events:8,lie:10,util:24,vastacular:52}],30:[function(e,t,i){"use strict";function n(e){var t=e.split(".").map(parseFloat);this.string=e,this.major=t[0],this.minor=t[1],this.patch=t[2],Object.freeze(this)}n.prototype.toString=function(){return this.string},t.exports=n},{}],31:[function(e,t,i){"use strict";function n(e,t){t.fired[e]||(t.emit(e),t.fired[e]=!0)}function r(e){o.apply(this,arguments),this.duration=e,this.seconds=Array.apply([],new Array(e)).map(function(){return!1}),this.fired=[a.AdVideoStart,a.AdVideoFirstQuartile,a.AdVideoMidpoint,a.AdVideoThirdQuartile,a.AdVideoComplete].reduce(function(e,t){return e[t]=!1,e},{})}var o=e("events").EventEmitter,s=e("util").inherits,a=e("./enums/VPAID_EVENTS");s(r,o),r.prototype.tick=function(){function e(e){var i=o[e-1];return t.slice(0,i).every(function(e){return e===!0})}var t=this.seconds,i=this._getState(),r=Math.round(i.currentTime)-1;r>-1&&this.emit(a.AdRemainingTimeChange,{sec:r,dur:this.duration});var o=[1,2,3,4].map(function(e){return Math.floor(this.duration/4*e)},this);i.playing&&(n(a.AdVideoStart,this),r>-1&&(this.seconds[r]=!0)),e(1)&&n(a.AdVideoFirstQuartile,this),e(2)&&n(a.AdVideoMidpoint,this),e(3)&&n(a.AdVideoThirdQuartile,this),e(4)&&n(a.AdVideoComplete,this)},t.exports=r},{"./enums/VPAID_EVENTS":34,events:8,util:24}],32:[function(e,t,i){"use strict";var n=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];n.forEach(function(e){this[e.toUpperCase()]=e},n),Object.freeze(n),t.exports=n},{}],33:[function(e,t,i){var n={JAVASCRIPT:"application/javascript",FLASH:"application/x-shockwave-flash"};Object.freeze(n),t.exports=n},{}],34:[function(e,t,i){"use strict";var n=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"];n.forEach(function(e){n[e]=e}),Object.freeze(n),t.exports=n},{}],35:[function(e,t,i){"use strict";var n=e("./window"),r=document.createElement("video"),o=e("./enums/MIME");i.isDesktop=!/Android|Silk|Mobile|PlayBook/.test(n.navigator.userAgent),i.canPlay=function(e){var t=n.navigator.mimeTypes,i=n.ActiveXObject;switch(e){case o.FLASH:try{return new i("ShockwaveFlash.ShockwaveFlash")?2:0}catch(e){return t&&t[o.FLASH]?2:0}return 0;case o.JAVASCRIPT:case"application/x-javascript":return 2;default:
if(r.canPlayType)switch(r.canPlayType(e)){case"probably":return 2;case"maybe":return 1;default:return 0}}return 0},Object.freeze(i)},{"./enums/MIME":33,"./window":51}],36:[function(e,t,i){"use strict";function n(e,t,i){return e.addEventListener(t,i,!1)}function r(e,t,i){return e.removeEventListener(t,i,!1)}function o(e,t,i){return n(e,t,function n(){return r(e,t,n),i.apply(this,arguments)})}function s(e,t){function i(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return d.reject(i());throw i()}return e.apply(this,arguments)}}function a(e,t){var i=t.width,n=e.map(function(e){return{mediaFile:e,playability:p(e.type)}}).filter(function(e){return e.playability>0}).sort(h("-playability","-mediaFile.bitrate")),r=n.map(function(e){return e.mediaFile.hasOwnProperty("width")&&e.mediaFile.width||(e.mediaFile.width=1e3),Math.abs(i-e.mediaFile.width)}),o=n[r.indexOf(Math.min.apply(Math,r))];return!o||o.playability<1?null:o.mediaFile}function u(e){this.container=e,this.video=null,this.privateStarted=0,this.__private__={hasPlayed:!1}}var l=e("events").EventEmitter,c=e("util").inherits,d=e("lie"),p=e("../environment").canPlay,h=e("sort-by"),f=e("../enums/VPAID_EVENTS"),y=e("../enums/HTML_MEDIA_EVENTS"),v=e("../HTMLVideoTracker"),m=e("../EventProxy");c(u,l),Object.defineProperties(u.prototype,{adRemainingTime:{get:s(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:s(function(){return this.video.duration})},adVolume:{get:s(function(){return this.video.volume}),set:s(function(e){this.video.volume=e})}}),u.prototype.load=function(e){var t=this;return new d(function(i,r){var s=document.createElement("video"),u=a(e,t.container.getBoundingClientRect());if(!u)return r(new Error("There are no playable <MediaFile>s."));s.setAttribute("playsinline",!0),s.setAttribute("webkit-playsinline",!0),s.src=u.uri,s.preload="auto",s.style.display="block",s.style.width="100%",s.style.height="100%",s.style.objectFit="contain",o(s,y.LOADEDMETADATA,function(){var e=new v(s);new m(f).from(e).to(t),t.video=s,i(t),t.emit(f.AdLoaded),n(s,y.DURATIONCHANGE,function(){t.emit(f.AdDurationChange)}),n(s,y.VOLUMECHANGE,function(){t.emit(f.AdVolumeChange)})}),o(s,y.ERROR,function(){var e=s.error;t.emit(f.AdError,e.message),r(e)}),o(s,y.PLAYING,function(){t.__private__.hasPlayed=!0,t.emit(f.AdImpression)}),o(s,y.ENDED,function(){t.stopAd()}),n(s,"click",function(){t.privateStarted,t.emit(f.AdClickThru,null,null,!0)}),t.container.appendChild(s)})},u.prototype.startAd=s(function(){var e=this;this.video;return this.__private__.hasPlayed?d.reject(new Error("The ad has already been started.")):new d(function(t){return t(e),!0})},!0),u.prototype.stopAd=s(function(){return this.container.removeChild(this.video),this.emit(f.AdStopped),d.resolve(this)},!0),u.prototype.pauseAd=s(function(){var e=this,t=this.video;return this.video.paused?d.resolve(this):new d(function(i){return o(t,y.PAUSE,function(){i(e),e.emit(f.AdPaused)}),i(e),t.pause()})},!0),u.prototype.resumeAd=s(function(){var e=this,t=this.video;return this.__private__.hasPlayed?this.video.paused?new d(function(i){return o(t,y.PLAY,function(){i(e),e.emit(f.AdPlaying)}),t.play()}):d.resolve(this):d.reject(new Error("The ad has not been started yet."))},!0),t.exports=u},{"../EventProxy":26,"../HTMLVideoTracker":27,"../enums/HTML_MEDIA_EVENTS":32,"../enums/VPAID_EVENTS":34,"../environment":35,events:8,lie:10,"sort-by":17,util:24}],37:[function(e,t,i){"use strict";function n(e,t,i){o.apply(this,arguments),this.container=e,this.width=i.width,this.height=i.height,this.swfURI=t,this.object=null}var r=e("./VPAIDFLASHClient"),o=e("./VPAID"),s=e("util").inherits,a=e("lie");e("../uuid"),e("querystring"),e("../enums/VPAID_EVENTS"),e("../VPAIDVersion");s(n,o),n.prototype.load=function(e,t){var i=this;e[0].uri,e[0].bitrate;this.playDelay=1;return new a(function(e,t){function n(n){if(n)return i.playDelay=1,void t(n);a.loadAdUnit("http://cdn-sys.brainient.com/flash/v6/select846.swf?video_id=a3f30b8e-2ad8-4123-bc58-42fccb3e48cd&user_id=1228&tzone=&settings=json&settingsPath=http://cdn-tags.brainient.com/1228/a3f30b8e-2ad8-4123-bc58-42fccb3e48cd/config.json",function(r,o){function s(e,n){console.log("handShake",e,n),o.initAd(i.width,i.height,"normal",-1,"","",function(e){if(r)return i.playDelay=0,void t(e)})}function a(n,s){if(r)return i.playDelay=0,void t(n);o.setAdVolume(.1),i.playDelay=0,e(i)}if(i.api=o,r)return i.playDelay=0,void t(n);o.handshakeVersion("2.0",s),o.on("AdLoaded",a)})}function o(e){if(i.playDelay){if(e>0)return void setTimeout(function(){o(e-1)},1e3);i.playDelay=1,t("flash 10 —Å–µ–∫")}}var s={wmode:"transparent",salign:"tl",align:"left",allowScriptAccess:"always",scale:"noScale",allowFullScreen:"true",quality:"high"},a=new r(i.container,n,{width:i.width,height:i.height,data:"https://apptoday.ru/dev/VPAIDFlash.swf"},s,{debug:!1,timeout:1e4});o(11110)})},n.prototype.startAd=function(){var e=this;return new a(function(t,i){t(e)})},n.prototype.resumeAd=function(){alert("–¥–∞ —ç—Ç–æ –æ–Ω–∏")},n.prototype.pauseAd=function(){alert(this.pau)},n.prototype.sendStatistic=function(e){var t="https://api.market-place.su/Product/video/swfstat.php?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(e));return void console.log(["to url",t])},t.exports=n},{"../VPAIDVersion":30,"../enums/VPAID_EVENTS":34,"../uuid":50,"./VPAID":42,"./VPAIDFLASHClient":44,lie:10,querystring:15,util:24}],38:[function(e,t,i){"use strict";function n(e,t,i){return e.addEventListener(t,i,!1)}function r(e,t,i){return e.removeEventListener(t,i,!1)}function o(e,t,i){return n(e,t,function n(){return r(e,t,n),i.apply(this,arguments)})}function s(e,t){function i(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return d.reject(i());throw i()}return e.apply(this,arguments)}}function a(e,t){var i=t.width,n=e.map(function(e){return{mediaFile:e,playability:p(e.type)}}).filter(function(e){return e.playability>0}).sort(h("-playability","-mediaFile.bitrate")),r=n.map(function(e){return e.mediaFile.hasOwnProperty("width")&&e.mediaFile.width||(e.mediaFile.width=1e3),Math.abs(i-e.mediaFile.width)}),o=n[r.indexOf(Math.min.apply(Math,r))];return!o||o.playability<1?null:o.mediaFile}function u(e){this.container=e,this.video=null,this.__private__={hasPlayed:!1}}var l=e("events").EventEmitter,c=e("util").inherits,d=e("lie"),p=e("../environment").canPlay,h=e("sort-by"),f=e("../enums/VPAID_EVENTS"),y=e("../enums/HTML_MEDIA_EVENTS"),v=e("../HTMLVideoTracker"),m=e("../EventProxy");c(u,l),Object.defineProperties(u.prototype,{adRemainingTime:{get:s(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:s(function(){return this.video.duration})},adVolume:{get:s(function(){return this.video.volume}),set:s(function(e){this.video.volume=e})}}),u.prototype.load=function(e){var t=this;return new d(function(i,r){var s=document.createElement("video"),u=a(e,t.container.getBoundingClientRect());if(!u)return r(new Error("There are no playable <MediaFile>s."));s.setAttribute("webkit-playsinline",!0),s.src=u.uri,s.preload="auto",s.style.display="block",s.style.width="100%",s.style.height="100%",s.style.objectFit="contain",o(s,y.LOADEDMETADATA,function(){var e=new v(s);new m(f).from(e).to(t),t.video=s,i(t),t.emit(f.AdLoaded),n(s,y.DURATIONCHANGE,function(){t.emit(f.AdDurationChange)}),n(s,y.VOLUMECHANGE,function(){t.emit(f.AdVolumeChange)})}),o(s,y.ERROR,function(){var e=s.error;t.emit(f.AdError,e.message),r(e)}),o(s,y.PLAYING,function(){t.__private__.hasPlayed=!0,t.emit(f.AdImpression)}),o(s,y.ENDED,function(){t.stopAd()}),n(s,"click",function(){t.emit(f.AdClickThru,null,null,!0)}),t.container.appendChild(s)})},u.prototype.startAd=s(function(){var e=this,t=this.video;return t.volume=.1,this.__private__.hasPlayed?d.reject(new Error("The ad has already been started.")):new d(function(i){return o(t,y.PLAYING,function(){i(e),e.emit(f.AdStarted)}),t.play()})},!0),u.prototype.stopAd=s(function(){return this.container.removeChild(this.video),this.emit(f.AdStopped),d.resolve(this)},!0),u.prototype.pauseAd=s(function(){var e=this,t=this.video;return this.video.paused?d.resolve(this):new d(function(i){return o(t,y.PAUSE,function(){i(e),e.emit(f.AdPaused)}),t.pause()})},!0),u.prototype.resumeAd=s(function(){var e=this,t=this.video;return this.__private__.hasPlayed?this.video.paused?new d(function(i){return o(t,y.PLAY,function(){i(e),e.emit(f.AdPlaying)}),t.play()}):d.resolve(this):d.reject(new Error("The ad has not been started yet."))},!0),t.exports=u},{"../EventProxy":26,"../HTMLVideoTracker":27,"../enums/HTML_MEDIA_EVENTS":32,"../enums/VPAID_EVENTS":34,"../environment":35,events:8,lie:10,"sort-by":17,util:24}],39:[function(e,t,i){"use strict";function n(e,t,i){return e.addEventListener(t,i,!1)}function r(e,t,i){return e.removeEventListener(t,i,!1)}function o(e,t,i){return n(e,t,function n(){return r(e,t,n),i.apply(this,arguments)})}function s(e,t){function i(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return d.reject(i());throw i()}return e.apply(this,arguments)}}function a(e,t){var i=t.width,n=e.map(function(e){return{mediaFile:e,playability:p(e.type)}}).filter(function(e){return e.playability>0}).sort(h("-playability","-mediaFile.bitrate")),r=n.map(function(e){return e.mediaFile.hasOwnProperty("width")&&e.mediaFile.width||(e.mediaFile.width=1e3),Math.abs(i-e.mediaFile.width)}),o=n[r.indexOf(Math.min.apply(Math,r))];return!o||o.playability<1?null:o.mediaFile}function u(e){this.container=e,this.video=null,this.__private__={hasPlayed:!1}}var l=e("events").EventEmitter,c=e("util").inherits,d=e("lie"),p=e("../environment").canPlay,h=e("sort-by"),f=e("../enums/VPAID_EVENTS"),y=e("../enums/HTML_MEDIA_EVENTS"),v=e("../HTMLVideoTracker"),m=e("../EventProxy");c(u,l),Object.defineProperties(u.prototype,{adRemainingTime:{get:s(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:s(function(){return this.video.duration})},adVolume:{get:s(function(){return this.video.volume}),set:s(function(e){this.video.volume=e})}}),u.prototype.load=function(e){var t=this;return new d(function(i,r){var s=document.createElement("video"),u=a(e,t.container.getBoundingClientRect());if(!u)return r(new Error("There are no playable <MediaFile>s."));s.setAttribute("muted",!0),s.setAttribute("playsinline",!0),s.setAttribute("webkit-playsinline",!0),s.src=u.uri,s.preload="auto",s.style.display="block",s.style.width="100%",s.style.height="100%",s.style.objectFit="contain",o(s,y.LOADEDMETADATA,function(){var e=new v(s);new m(f).from(e).to(t),t.video=s,i(t),t.emit(f.AdLoaded),n(s,y.DURATIONCHANGE,function(){t.emit(f.AdDurationChange)}),n(s,y.VOLUMECHANGE,function(){t.emit(f.AdVolumeChange)})}),o(s,y.ERROR,function(){var e=s.error;t.emit(f.AdError,e.message),r(e)}),o(s,y.PLAYING,function(){t.__private__.hasPlayed=!0,t.emit(f.AdImpression)}),o(s,y.ENDED,function(){t.stopAd()}),n(s,"click",function(){t.emit(f.AdClickThru,null,null,!0)}),t.container.appendChild(s)})},u.prototype.startAd=s(function(){var e=this,t=this.video;return this.__private__.hasPlayed?d.reject(new Error("The ad has already been started.")):new d(function(i){return o(t,y.PLAYING,function(){i(e),e.emit(f.AdStarted)}),window.enableInlineVideo(t,{everywhere:!0}),t.play()})},!0),u.prototype.stopAd=s(function(){return this.emit(f.AdStopped),d.resolve(this)},!0),u.prototype.pauseAd=s(function(){var e=this,t=this.video;return this.video.paused?d.resolve(this):(t.className="",new d(function(i){return o(t,y.PAUSE,function(){i(e),e.emit(f.AdPaused)}),t.pause()}))},!0),u.prototype.resumeAd=s(function(){var e=this,t=this.video;return this.__private__.hasPlayed?(t.className="IIV",this.video.paused?new d(function(i){return o(t,y.PLAY,function(){i(e),e.emit(f.AdPlaying)}),t.play()}):d.resolve(this)):d.reject(new Error("The ad has not been started yet."))},!0),t.exports=u},{"../EventProxy":26,"../HTMLVideoTracker":27,"../enums/HTML_MEDIA_EVENTS":32,"../enums/VPAID_EVENTS":34,"../environment":35,events:8,lie:10,"sort-by":17,util:24}],40:[function(e,t,i){"use strict";var n=function(){this.handshakeVersion=function(e,t){},this.initAd=function(e,t,i,n,r,o){},this.resizeAd=function(e,t,i,n){},this.startAd=function(e){},this.stopAd=function(e){},this.pauseAd=function(e){},this.resumeAd=function(e){},this.expandAd=function(e){},this.collapseAd=function(e){},this.skipAd=function(e){},this.getAdLinear=function(e){},this.etAdWidth=function(e){},this.getAdHeight=function(e){},this.getAdExpanded=function(e){},this.getAdSkippableState=function(e){},this.getAdRemainingTime=function(e){},this.getAdDuration=function(e){},this.setAdVolume=function(e,t){},this.getAdVolume=function(e){},this.getAdCompanions=function(e){},this.getAdIcons=function(e){}};Object.defineProperty(n,"EVENTS",{writable:!1,configurable:!1,value:["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"]}),t.exports.IVPAIDAdUnit=n},{}],41:[function(e,t,i){"use strict";function n(){o.apply(this,arguments),this.playDelay=1,this.playClean=0,this.mypaused=1,this.frame=null}var r=e("util").inherits,o=e("./VPAID"),s=e("lie"),a=e("../enums/VPAID_EVENTS"),u=e("../environment").isDesktop,l=e("../VPAIDVersion");r(n,o),n.prototype.load=function(e,t){var i=this,n=e[0].uri,r=e[0].bitrate;return new s(function(e,o){function s(e){}function c(e){i.playClean=1;try{i.container.removeChild(h)}catch(e){}i.frame=null,i.api=null,e&&o(e)}function d(e){if(!i.playClean){if(s(i.vpaApi),e>0)return void setTimeout(function(){d(e-1)},5e3);i.stopAd()}}function p(e){if(!i.playClean&&i.playDelay)return e>0?void setTimeout(function(){p(e-1)},1e3):void c(new Error("vpaid –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –≤ —Ç–µ—á–µ–Ω–∏–∏ 18 —Å–µ–∫"))}var h=document.createElement("iframe");h.scrolling="no";var f=document.createElement("script"),y=document.createElement("video");p(14),h.src="about:blank",h.style.width="100%",h.style.height="100%",h.style.display="block",h.style.opacity="0",h.style.border="none",y.setAttribute("webkit-playsinline","true"),y.style.display="block",y.style.width="100%",y.style.height="100%",y.style.objectFit="contain",i.container.appendChild(h),h.contentWindow.document.open(),h.contentWindow.document.close(),h.contentWindow.document.body.style.margin="0",i.frame=h,f.src=n,i.id1,console.log(["—Ç—Ä–µ—Ç—å—è —Å—Ç–∞–¥–∏—è",i.id1,f.src]),f.onload=function(){function n(){var e=h.getBoundingClientRect();i.resizeAd(e.width,e.height,"normal")}var s=h.contentWindow.getVPAIDAd();33!=i.id1&&34!=i.id1||(y.style.display="none");var p=h.getBoundingClientRect(),f=h.contentWindow.document.body,v=i.vpaidVersion=new l(s.handshakeVersion("2.0"));if(v.major>2)return o(new Error("VPAID version "+v+" is not supported."));h.contentWindow.addEventListener("resize",n,!1),a.forEach(function(e){return s.subscribe(function(){for(var t=new Array(arguments.length),n=arguments.length;n--;)t[n]=arguments[n];return i.emit.apply(i,[e].concat(t))},e)}),i.once(a.AdLoaded,function(){i.playDelay=0,h.style.opacity="1",i.api=s,31==i.id1||i.id1,e(i)}),i.once(a.AdError,function(e){c(new Error(e))}),i.once(a.AdStopped,function(){c()}),i.vpaApi=s,31!=i.id1&&32!=i.id1||i.once(a.AdPlaying,function(){d(12)}),s.initAd(p.width,p.height,"normal",r,{AdParameters:t},{slot:f,videoSlot:y,videoSlotCanAutoPlay:u})},f.onerror=function(){c(new Error("Failed to load MediaFile ["+n+"]."))},h.contentWindow.document.body.appendChild(y),h.contentWindow.document.head.appendChild(f)})},t.exports=n},{"../VPAIDVersion":30,"../enums/VPAID_EVENTS":34,"../environment":35,"./VPAID":42,lie:10,util:24}],42:[function(e,t,i){"use strict";function n(e,t){return function(){function i(){return new Error("Ad has not been loaded.")}function n(){return console.log(["called method:",e,o[e],r]),o[e].apply(o,r)}var r=arguments,o=this.api,s=this;if(console.log(e,o,t),!t){if(console.log(e,o,t),!o)throw i();return n()}return new a(function(e,r){return o?(s.once(t,function(){e(s)}),n()):r(i())})}}function r(e){this.container=e,this.api=null,this.vpaidVersion=null}var o=e("util").inherits,s=e("events").EventEmitter,a=e("lie"),u=e("../enums/VPAID_EVENTS");o(r,s),Object.defineProperties(r.prototype,{adLinear:{get:n("getAdLinear")},adWidth:{get:n("getAdWidth")},adHeight:{get:n("getAdHeight")},adExpanded:{get:n("getAdExpanded")},adSkippableState:{get:n("getAdSkippableState")},adRemainingTime:{get:n("getAdRemainingTime")},adDuration:{get:n("getAdDuration")},adVolume:{get:n("getAdVolume"),set:n("setAdVolume")},adCompanions:{get:n("getAdCompanions")},adIcons:{get:n("getAdIcons")}}),r.prototype.load=function(){throw new Error("VPAID subclass must implement load() method.")},r.prototype.resizeAd=n("resizeAd",u.AdSizeChange),r.prototype.startAd=n("startAd",u.AdStarted),r.prototype.stopAd=n("stopAd",u.AdStopped),r.prototype.pauseAd=n("pauseAd",u.AdPaused),r.prototype.resumeAd=n("resumeAd",u.AdPlaying),r.prototype.expandAd=n("expandAd",u.AdExpandedChange),r.prototype.collapseAd=n("collapseAd",u.AdExpandedChange),r.prototype.skipAd=n("skipAd",u.AdSkipped),t.exports=r},{"../enums/VPAID_EVENTS":34,events:8,lie:10,util:24}],43:[function(e,t,i){"use strict";function n(e){this._destroyed=!1,this._flash=e,this.handshakeVersion=function(e,t){this._flash.callFlashMethod("handshakeVersion",[e],t)},this.initAd=function(e,t,i,n,r,o,s){r=r||{AdParameters:""},o=o||{flashVars:""},this._flash.setSize(e,t),r=r||{AdParameters:""},o=o||{flashVars:""},this._flash.callFlashMethod("initAd",[this._flash.getWidth(),this._flash.getHeight(),i,n,r.AdParameters||"",o.flashVars||""],s)},this.setAdVolume=function(e,t){this._flash.callFlashMethod("setAdVolume",[e],t)},this.getAdVolume=function(e){this._flash.callFlashMethod("getAdVolume",[],e)},this.startAd=function(e){this._flash.callFlashMethod("startAd",[],e)},this.on=function(e,t){this._flash.on(e,t)},this.getAdLinear=function(e){this._flash.callFlashMethod("getAdLinear",[],e)},this.getAdWidth=function(e){this._flash.callFlashMethod("getAdWidth",[],e)},this.getAdHeight=function(e){this._flash.callFlashMethod("getAdHeight",[],e)},this.getAdExpanded=function(e){this._flash.callFlashMethod("getAdExpanded",[],e)},this.getAdSkippableState=function(e){this._flash.callFlashMethod("getAdSkippableState",[],e)},this.getAdRemainingTime=function(e){this._flash.callFlashMethod("getAdRemainingTime",[],e)},this.getAdDuration=function(e){this._flash.callFlashMethod("getAdDuration",[],e)},this.getAdCompanions=function(e){this._flash.callFlashMethod("getAdCompanions",[],e)},this.getAdIcons=function(e){this._flash.callFlashMethod("getAdIcons",[],e)}}(0,e("util").inherits)(n,e("./IVPAIDAdUnit").IVPAIDAdUnit),t.exports.VPAIDAdUnit=n},{"./IVPAIDAdUnit":40,util:24}],44:[function(e,t,i){"use strict";function n(e,t,i,d,h){function f(e){if(!g._playerLoading&&!g._destroyed)return console.log(["—Ç–∞–π–º–µ—Ä load",e]),e>0?void setTimeout(function(){f(e-1)},1e3):(g.destroy(),document.body.removeChild(m),y("flash 10 —Å–µ–∫"))}function y(e){return setTimeout(function(){t(new Error(e))},0),v}var v=this;if(this._vpaidParentEl=m,this._flashID=u(),this._destroyed=!1,this._playerLoading=0,t=t||s,i.width=a(i.width,500),i.height=a(i.height,350),!n.isSupported())return y("user don't support flash or doesn't have the minimum required version of flash "+p);d.movie=i.data;var m=document.createElement("DIV");document.body.appendChild(m),m.style.display="block!important";var g=(l(m,r),this);if(d.FlashVars="flashid="+r+"&handler="+c.VPAID_FLASH_HANDLER+"&debug="+h.debug+"salign="+d.salign,d.FlashVars="flashid="+r+"&handler="+c.VPAID_FLASH_HANDLER+"&debug=false",d.allowScriptAccess="always",this.el=o.createSWF(i,d,r),!this.el)return document.body.removeChild(m),y("user don't support flash or doesn't have the minimum required version of flash "+p);this._flash=new c(this.el,i.data,r,i.width,i.width,function(){g._playerLoading=1,t()}),f(10)}var r="vpaid_video_flash_tester_el",o=e("./myswf"),s=e("./utils").noop,a=e("./utils").isPositiveInt,u=e("./utils").unique("vpaid"),l=(e("./utils").callbackTimeout,e("./utils").createElementWithID),c=e("./jsFlashBridge").JSFlashBridge,d=e("./VPAIDAdUnit").VPAIDAdUnit,p="10.1.0";n.prototype._destroyAdUnit=function(){delete this._loadLater,this._adUnitLoad&&(this._adUnitLoad=null,this._flash.removeCallback(this._adUnitLoad)),this._adUnit&&(this._adUnit._destroy(),this._adUnit=null)},n.prototype.destroy=function(){this._destroyAdUnit(),this._flash&&(this._flash.destroy(),this._flash=null),this.el=null,this._destroyed=!0},n.prototype.loadAdUnit=function(e,t){if(this._flash.isReady()){var i=this;this._adUnitLoad=function(e,n){e||(i._adUnit=new d(i._flash)),i._adUnitLoad=null,t(e,i._adUnit)},this._flash.callFlashMethod("loadAdUnit",[e],this._adUnitLoad)}else this._loadLater={url:e,callback:t}},function(e,t,i){i=i||!1,Object.defineProperty(n,e,{writable:i,configurable:!1,value:t})}("isSupported",function(){return o.hasFlashPlayerVersion(p)},!0),n.swfobject=o,t.exports=n},{"./VPAIDAdUnit":43,"./jsFlashBridge":45,"./myswf":47,"./utils":49}],45:[function(e,t,i){"use strict";function n(e,t,i,n,o,l){this._el=e,this._flashID=i,this._flashURL=t,this._width=n,this._height=o,this._handlers=new a,this._callbacks=new s,this._uniqueMethodIdentifier=r(this._flashID),this._ready=!1,this._handShakeHandler=l,u.addInstance(this._flashID,this)}var r=e("./utils").unique,o=e("./utils").isPositiveInt,s=(e("./utils").stringEndsWith,e("./registry").SingleValueRegistry),a=e("./registry").MultipleValuesRegistry,u=e("./jsFlashBridgeRegistry");n.prototype._handShake=function(e,t){this._ready=!0,this._handShakeHandler&&(this._handShakeHandler(e,t),delete this._handShakeHandler)},n.prototype.on=function(e,t){console.log(["on event 1",this._handlers]),this._handlers.add(e,t),console.log(["on event 2",this._handlers])},n.prototype.setSize=function(e,t){this._width=o(e,this._width),this._height=o(t,this._height),this._el.setAttribute("width",this._width),this._el.setAttribute("height",this._height)},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n.prototype.isReady=function(){return this._ready},n.prototype.callFlashMethod=function(e,t,i){var n="";i&&(n=this._uniqueMethodIdentifier()+" / "+e,this._callbacks.add(n,i)),console.log(this._el);try{this._el[e]([n].concat(t))}catch(e){console.log(e),i?l.call(this,n,e):this._trigger("AdError",e)}},n.prototype.offAll=function(){return this._handlers.removeAll()},n.prototype.removeCallback=function(e){return this._callbacks.removeByValue(e)},n.prototype.removeAllCallbacks=function(){return this._callbacks.removeAll()},n.prototype.destroy=function(){this.offAll(),this.removeAllCallbacks(),u.removeInstanceByID(this._flashID),this._el.parentElement&&this._el.parentElement.removeChild(this._el)},n.prototype._trigger=function(e,t){var i=this;this._handlers.get(e).forEach(function(n){"AdClickThru"===e?n(t):setTimeout(function(){i._handlers.get(e).length>0&&n(t)},0)})},n.prototype._callCallback=function(e,t,i,n){if(!this._callbacks.get(t))return void(i&&""===t&&this.trigger("AdError",i));l.call(this,t,i,n)};var l=function(e,t,i){var n=this;setTimeout(function(){var r=n._callbacks.get(e);r&&(n._callbacks.remove(e),r(t,i))},0)};Object.defineProperty(n,"VPAID_FLASH_HANDLER",{writable:!1,configurable:!1,value:"vpaid_video_flash_handler"}),window.vpaid_video_flash_handler=function(e,t,i,n,r,o){console.log([t,n,i,r,o]);var s=u.getInstanceByID(e);s&&("handShake"===i?s._handShake(r,o):"event"!==t?s._callCallback(i,n,r,o):s._trigger(i,o))},t.exports.JSFlashBridge=n},{"./jsFlashBridgeRegistry":46,"./registry":48,"./utils":49}],46:[function(e,t,i){"use strict";var n=e("./registry").SingleValueRegistry,r=new n,o={};Object.defineProperty(o,"addInstance",{writable:!1,configurable:!1,value:function(e,t){r.add(e,t)}}),Object.defineProperty(o,"getInstanceByID",{writable:!1,configurable:!1,value:function(e){return r.get(e)}}),Object.defineProperty(o,"removeInstanceByID",{writable:!1,configurable:!1,value:function(e){return r.remove(e)}}),t.exports=o},{"./registry":48}],47:[function(e,t,i){"use strict";function n(e){e+="";var t=w.ua.pv,i=e.split(".");return i[0]=r(i[0]),i[1]=r(i[1])||0,i[2]=r(i[2])||0,t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>=i[2]}function r(e){return parseInt(e,10)}function o(e){return e&&e.nodeType&&1===e.nodeType}function s(e){return o(e)?e.id:e}function a(e){if(o(e))return e;var t=null;try{t=p.getElementById(e)}catch(e){}return t}function u(e){return p.createElement(e)}function l(e,t,i){var n=u("param");n.setAttribute("name",t),n.setAttribute("value",i),e.appendChild(n)}function c(e,t){var i=u("div");return i.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",i.firstChild}var d=window,p=document,h=navigator,f="undefined",y="object",v="Shockwave Flash",m="ShockwaveFlash.ShockwaveFlash",g="application/x-shockwave-flash",_=!1,A=[],w={hasFlashPlayerVersion:n,ua:function(){var e=typeof p.getElementById!==f&&typeof p.getElementsByTagName!==f&&typeof p.createElement!==f,t=h.userAgent.toLowerCase(),i=h.platform.toLowerCase(),n=i?/win/.test(i):/win/.test(t),o=i?/mac/.test(i):/mac/.test(t),s=!!/webkit/.test(t)&&parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")),a="Microsoft Internet Explorer"===h.appName,u=[0,0,0],l=null;if(typeof h.plugins!==f&&typeof h.plugins[v]===y)(l=h.plugins[v].description)&&typeof h.mimeTypes!==f&&h.mimeTypes[g]&&h.mimeTypes[g].enabledPlugin&&(_=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),u[0]=r(l.replace(/^(.*)\..*$/,"$1")),u[1]=r(l.replace(/^.*\.(.*)\s.*$/,"$1")),u[2]=/[a-zA-Z]/.test(l)?r(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof d.ActiveXObject!==f)try{var c=new ActiveXObject(m);c&&(l=c.GetVariable("$version"))&&(a=!0,l=l.split(" ")[1].split(","),u=[r(l[0]),r(l[1]),r(l[2])])}catch(e){}return{w3:e,pv:u,wk:s,ie:a,win:n,mac:o}}(),createSWF:function(e,t,i){var n,r=a(i);if(i=s(i),this.ua.wk&&this.ua.wk<312)return n;if(r){var o,d,p,h=u(this.ua.ie?"div":y);typeof e.id===f&&(e.id=i);for(p in t)t.hasOwnProperty(p)&&"movie"!==p.toLowerCase()&&l(h,p,t[p]);this.ua.ie&&(h=c(e.data,h.innerHTML));for(o in e)e.hasOwnProperty(o)&&(d=o.toLowerCase(),"styleclass"===d?h.setAttribute("class",e[o]):"classid"!==d&&"data"!==d&&h.setAttribute(o,e[o]));this.ua.ie?A[A.length]=e.id:h.setAttribute("data",e.data),r.parentNode.replaceChild(h,r),n=h}return n}};t.exports=w},{}],48:[function(e,t,i){"use strict";function n(){this._registries={}}function r(){this._registries={}}n.prototype.add=function(e,t){this._registries[e]||(this._registries[e]=[]),this._registries[e].indexOf(t)===-1&&this._registries[e].push(t)},n.prototype.get=function(e){return this._registries[e]||[]},n.prototype.filterKeys=function(e){return Object.keys(this._registries).filter(e)},n.prototype.findByValue=function(e){return Object.keys(this._registries).filter(function(t){return this._registries[t].indexOf(e)!==-1})},n.prototype.remove=function(e,t){if(this._registries[e]){var i=this._registries[e].indexOf(t);if(!(i<0))return this._registries[e].splice(i,1)}},n.prototype.removeByKey=function(e){var t=this._registries[e];return delete this._registries[e],t},n.prototype.removeByValue=function(e){return this.findByValue(e).map(function(t){return this.remove(t,e)})},n.prototype.removeAll=function(){var e=this._registries;return this._registries={},e},n.prototype.size=function(){return Object.keys(this._registries).length},r.prototype.add=function(e,t){this._registries[e]=t},r.prototype.get=function(e){return this._registries[e]},r.prototype.filterKeys=function(e){return Object.keys(this._registries).filter(e)},r.prototype.findByValue=function(e){return Object.keys(this._registries).filter(function(t){return this._registries[t]===e})},r.prototype.remove=function(e){var t=this._registries[e];return delete this._registries[e],t},r.prototype.removeByValue=function(e){return this.findByValue(e).map(function(e){return this.remove(e)})},r.prototype.removeAll=function(){var e=this._registries;return this._registries={},e},r.prototype.size=function(){return Object.keys(this._registries).length},t.exports.SingleValueRegistry=r,t.exports.MultipleValuesRegistry=n},{}],49:[function(e,t,i){"use strict";function n(){}function r(e,t,i){var r=setTimeout(function(){t=n,i()},e);return function(){clearTimeout(r),console.log(arguments),t.apply(this,arguments)}}var o=-1;i.unique=function(e){return function(){return e+"_"+ ++o}},i.noop=n,i.callbackTimeout=r,i.createElementWithID=function(e,t,i){i=i||!1;var n=document.createElement("div");return n.id=t,i&&(e.innerHTML=""),e.appendChild(n),n},i.isPositiveInt=function(e,t){return!isNaN(parseFloat(e))&&isFinite(e)&&e>0?e:t};var s=function(){return String.prototype.endsWith?String.prototype.endsWith:function(e,t){var i=this.toString();(void 0===t||t>i.length)&&(t=i.length),t-=e.length;var n=i.indexOf(e,t);return n!==-1&&n===t}}();i.stringEndsWith=function(e,t){return s.call(e,t)},i.hideFlashEl=function(e){e.style.position="absolute",e.style.left="-1px",e.style.top="-1px",e.style.width="1px",e.style.height="1px"}},{}],50:[function(e,t,i){"use strict";var n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r=n.length;t.exports=function(e){for(var t="";e--;)t+=n.charAt(Math.floor(Math.random()*r));return t}},{}],51:[function(e,t,i){t.exports=window},{}],52:[function(e,t,i){i.VAST=e("./lib/VAST")},{"./lib/VAST":53}],53:[function(e,t,i){"use strict";function n(){}function r(e){h({description:null,survey:null},e)}function o(){}function s(e){h({trackingEvents:[],parameters:null,videoClicks:null},e),(e.mediaFiles||[]).forEach(function(e){h({id:null,bitrate:null,scalable:null,maintainAspectRatio:null,apiFramework:null},e)})}function a(e){e.companions.forEach(function(e){h({expandedWidth:null,expandedHeight:null,apiFramework:null,trackingEvents:[],clickThrough:null,altText:null,parameters:null},e)})}function u(e){h({trackingEvents:[]},e),e.ads.forEach(function(e){h({id:null,expandedWidth:null,expandedHeight:null,scalable:null,maintainAspectRatio:null,minSuggestedDuration:null,apiFramework:null,clickThrough:null,parameters:null},e)})}function l(e){p(e,this,!0),this.ads.forEach(function(e){h({system:{version:null},errors:[]},e),e.creatives.forEach(function(e){h({id:null,sequence:null,adID:null},e),_[e.type](e)}),g[e.type](e)}),this.__private__={wrappers:[],inlines:[]}}var c=e("lie"),d=e("superagent"),p=e("./utils/copy"),h=e("./utils/defaults"),f=e("./utils/extend"),y=e("./utils/nodeify_promise"),v=Array.prototype.push,m=e("./xml_from_vast"),g={inline:r,wrapper:o},_={linear:s,companions:a,nonLinear:u};Object.defineProperties(l.prototype,{wrappers:{get:function(){var e=this.__private__.wrappers;return e.length=0,v.apply(e,this.filter("ads",function(e){return"wrapper"===e.type})),e}},inlines:{get:function(){var e=this.__private__.inlines;return e.length=0,v.apply(e,this.filter("ads",function(e){return"inline"===e.type})),e}}}),l.prototype.get=function(e){return((e||"").match(/[^\[\]\.]+/g)||[]).reduce(function(e,t){return(e||void 0)&&e[t]},this)},l.prototype.set=function(e,t){function i(e,t){switch(e.input.charAt(t)){case".":return Object;case"[":return Array;case"]":return i(e,t+1);default:return null}}var n=function(){for(var t,n=/[^\[\]\.]+/g,r=[];t=n.exec(e);)r.push({token:t[0],type:i(t,t.index+t[0].length)});return r}(),r=n.pop(),o=n.reduce(function(e,t){return e[t.token]||(e[t.token]=new t.type)},this);if(!e)throw new Error("prop must be specified.");return o[r.token]=t},l.prototype.map=function(e,t){var i=this.get(e)||[],n=i.length,r=[];if(!(i instanceof Array))return r;for(var o=0;o<n;o++)r.push(t.call(this,i[o],o,i));return r},
l.prototype.filter=function(e,t){var i=this.get(e)||[],n=i.length,r=[];if(!(i instanceof Array))return r;for(var o=0;o<n;o++)t.call(this,i[o],o,i)&&r.push(i[o]);return r},l.prototype.find=function(e,t){var i=this.get(e)||[],n=i.length;if(i instanceof Array)for(var r=0;r<n;r++)if(t.call(this,i[r],r,i))return i[r]},l.prototype.toPOJO=function(){var e=JSON.parse(JSON.stringify(this));return delete e.__private__,e},l.prototype.copy=function(){return new this.constructor(this.toPOJO())},l.prototype.resolveWrappers=function(){function e(e,t){function i(e){return function(t){return t.type===e}}var n=function(e){return{linear:e.filter(i("linear")),companions:e.filter(i("companions")),nonLinear:e.filter(i("nonLinear"))}}(e.creatives);return h(e.impressions,t.impressions),h(e.errors,t.errors),void 0!==e.extensions&&h(e.extensions,t.extensions),t.creatives.forEach(function(e){h(n[e.type].shift()||{},e)}),v.apply(t.creatives,"wrapper"!==t.type?[]:["linear","companions","nonLinear"].reduce(function(e,t){return e.concat(n[t])},[])),t}var t=isNaN(arguments[0])?1/0:arguments[0],i="function"==typeof arguments[0]?arguments[0]:arguments[1],n=this.constructor,r=this;return 0===t?c.reject(new Error("Too many redirects were made.")):y(c.all(this.map("wrappers",function(e){return c.resolve(d.get(e.vastAdTagURI)).then(function(t){return{wrapper:e,response:n.pojoFromXML(t.text).ads}})})).then(function(t){var i=t.map(function(e){return e.wrapper}),o=t.map(function(e){return e.response});return new n(f(r.toPOJO(),{ads:r.map("ads",function(t){var n=i.indexOf(t),r=i[n],s=o[n];return s?s.map(e.bind(null,r)):[t]}).reduce(function(e,t){return e.concat(t)})}))}).then(function(e){return e.get("wrappers.length")>0?e.resolveWrappers(t-1):e}),i)},l.prototype.toXML=function(){var e=this.validate();if(!e.valid)throw new Error("VAST is invalid: "+e.reasons.join(", "));return m(this)},l.prototype.validate=function(){function e(e,t){e||s.push(t)}function t(t){e(o.get(t),t+" is required")}function i(t){e(o.get(t+".length")>0,t+" must contain at least one value")}function r(e,n){n.exists.map(e).forEach(t),n.atLeastOne.map(e).forEach(i)}var o=this,s=[],a={inline:function(e){var t={linear:function(e){r(e,{exists:["duration"],atLeastOne:["mediaFiles"]})},companions:function(e){o.get(e("companions")).forEach(function(t,i){function n(t){return e("companions["+i+"]."+t)}r(n,{exists:[],atLeastOne:["resources"]})})},nonLinear:function(e){o.get(e("ads")).forEach(function(t,i){function n(t){return e("ads["+i+"]."+t)}r(n,{exists:[],atLeastOne:["resources"]})})}};r(e,{exists:["title"],atLeastOne:["creatives"]}),o.get(e("creatives")).forEach(function(i,o){function s(t){return e("creatives["+o+"]."+t)}r(s,{exists:["type"],atLeastOne:[]}),(t[i.type]||n)(s)})},wrapper:function(e){r(e,{exists:["vastAdTagURI"],atLeastOne:[]})}};return r(function(e){return e},{exists:[],atLeastOne:["ads"]}),this.get("ads").forEach(function(e,t){function i(e){return"ads["+t+"]."+e}r(i,{exists:["type","system.name"],atLeastOne:["impressions"]}),(a[e.type]||n)(i)}),{valid:0===s.length,reasons:0===s.length?null:s}},l.pojoFromXML=e("./pojo_from_xml"),l.fetch=function(e){var t="object"==typeof arguments[1]?arguments[1]||{}:{},i="function"==typeof arguments[2]?arguments[2]:arguments[1],n=this;return y(c.resolve(d.get(e).set(t.headers||{})).then(function(e){var i=new n(n.pojoFromXML(e.text));return t.resolveWrappers?i.resolveWrappers(t.maxRedirects):i}),i)},t.exports=l},{"./pojo_from_xml":54,"./utils/copy":56,"./utils/defaults":57,"./utils/extend":58,"./utils/nodeify_promise":59,"./xml_from_vast":66,lie:10,superagent:18}],54:[function(e,t,i){"use strict";function n(e){return e[0]||{attributes:{}}}function r(e){return e.find("StaticResource,IFrameResource,HTMLResource").map(function(e){return{type:e.tag.replace(/Resource$/,"").toLowerCase(),creativeType:e.attributes.creativeType,data:e.value}})}function o(e){var t=n(e.find("Duration")),i=e.find("Tracking"),r=n(e.find("AdParameters")),o=e.find("VideoClicks")[0],s=e.find("MediaFile");return{type:"linear",duration:d(t.value)||void 0,trackingEvents:i.map(function(e){return{event:e.attributes.event,uri:e.value}}),parameters:r.value,videoClicks:o&&function(){var e=n(o.find("ClickThrough")),t=o.find("ClickTracking"),i=o.find("CustomClick");return{clickThrough:e.value,clickTrackings:t.map(function(e){return e.value}),customClicks:i.map(function(e){return{id:e.attributes.id,uri:e.value}})}}(),mediaFiles:s.map(function(e){var t=e.attributes;return{id:t.id,delivery:t.delivery,type:t.type,uri:e.value,bitrate:y(t.bitrate),width:y(t.width),height:y(t.height),scalable:p(t.scalable),maintainAspectRatio:p(t.maintainAspectRatio),apiFramework:t.apiFramework}})}}function s(e){return{type:"companions",companions:e.find("Companion").map(function(e){var t=e.find("Tracking"),i=n(e.find("CompanionClickThrough")),o=n(e.find("AltText")),s=n(e.find("AdParameters"));return{id:e.attributes.id,width:y(e.attributes.width),height:y(e.attributes.height),expandedWidth:y(e.attributes.expandedWidth),expandedHeight:y(e.attributes.expandedHeight),apiFramework:e.attributes.apiFramework,resources:r(e),trackingEvents:t.map(function(e){return{event:e.attributes.event,uri:e.value}}),clickThrough:i.value,altText:o.value,parameters:s.value}})}}function a(e){var t=e.find("NonLinear"),i=e.find("Tracking");return{type:"nonLinear",ads:t.map(function(e){var t=n(e.find("NonLinearClickThrough")),i=n(e.find("AdParameters"));return{id:e.attributes.id,width:y(e.attributes.width),height:y(e.attributes.height),expandedWidth:y(e.attributes.expandedWidth),expandedHeight:y(e.attributes.expandedHeight),scalable:p(e.attributes.scalable),maintainAspectRatio:p(e.attributes.maintainAspectRatio),minSuggestedDuration:d(e.attributes.minSuggestedDuration)||void 0,apiFramework:e.attributes.apiFramework,resources:r(e),clickThrough:t.value,parameters:i.value}}),trackingEvents:i.map(function(e){return{event:e.attributes.event,uri:e.value}})}}function u(e){var t=n(e.find("AdTitle")),i=n(e.find("Description")),r=n(e.find("Survey"));return{type:"inline",title:t.value,description:i.value,survey:r.value}}function l(e){return{type:"wrapper",vastAdTagURI:n(e.find("VASTAdTagURI")).value}}var c=e("./utils/parse_xml"),d=e("./utils/timestamp_to_seconds"),p=e("./utils/string_to_boolean"),h=e("./utils/extend"),f=e("./utils/trim_object"),y=e("./utils/numberify"),v={linear:o,companions:s,nonLinear:a},m={inline:u,wrapper:l};t.exports=function(e){var t=c(e);if(!t("VAST")[0])throw new Error("["+e+"] is not a valid VAST document.");return f({version:n(t("VAST")).attributes.version,ads:t("Ad").map(function(e){var t=n(e.find("Wrapper,InLine")).tag.toLowerCase(),i=n(e.find("AdSystem")),r=e.find("Error"),o=e.find("Impression"),s=e.find("Creative"),a=e.find("Extension"),u=a.map(function(e){if(e&&e.attributes)return e.value?e.value=e.value.replace(/^\s+|\s+$/,""):e.value="",{type:e.attributes.type,value:e.value}});return h({id:e.attributes.id,system:{name:i.value,version:i.attributes.version},errors:r.map(function(e){return e.value}),impressions:o.map(function(e){return{uri:e.value,id:e.attributes.id}}),extensions:u,creatives:s.map(function(e){var t=function(){switch(n(e.find("Linear,CompanionAds,NonLinearAds")).tag){case"Linear":return"linear";case"CompanionAds":return"companions";case"NonLinearAds":return"nonLinear"}}();return h({id:e.attributes.id,sequence:y(e.attributes.sequence),adID:e.attributes.AdID},v[t](e))})},m[t](e))})},!0)}},{"./utils/extend":58,"./utils/numberify":60,"./utils/parse_xml":61,"./utils/string_to_boolean":63,"./utils/timestamp_to_seconds":64,"./utils/trim_object":65}],55:[function(e,t,i){"use strict";function n(e){return null!==e&&void 0!==e}function r(e){return void 0!==e?String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function o(e){for(var t="";e--;)t+=" ";return t}function s(e){return(void 0!==e?function(e){for(var t,i,n=[],r=/]]>/g,o=0;t=r.exec(e);)i=t.index+2,n.push(t.input.substring(o,i)),o=i;return n.push(e.substring(o,e.length)),n}(String(e)):[""]).reduce(function(e,t){return e+"<![CDATA["+t+"]]>"},"")}function a(e){return e.cdata?s(e.value):r(e.value)}function u(e,t,i){var s=e.tag,l=e.attributes||{},c=Object.keys(l),d=e.children||[],p=e.value,h=d.length>0,f=c.every(function(e){return n(l[e])})&&c.length>0,y=n(p)||h||f,v=o(t),m="<"+s+Object.keys(l).reduce(function(e,t){return i&&!n(l[t])?e:e+" "+t+'="'+r(l[t])+'"'},"")+">",g="</"+s+">";return!i||y||e.required?h?[v+m].concat(e.children.reduce(function(e,n){return e.concat(u(n,t+4,i))},[]),[v+g]):[v+m+a(e)+g]:[]}t.exports=function(e,t){return['<?xml version="1.0" encoding="UTF-8"?>'].concat(u(e,0,t)).join("\n")}},{}],56:[function(e,t,i){"use strict";function n(e,t,i){return Object.keys(e).reduce(function(t,n){return t[n]=i?o(e[n],null,!0):e[n],t},t||{})}function r(e,t,i){var n=t||[];return s.apply(n,i?e.map(function(e){return o(e,null,!0)}):e),n}function o(e){var t=("object"==typeof arguments[1]||null)&&arguments[1],i="boolean"==typeof arguments[1]?arguments[1]:arguments[2];return Object(e)!==e?e:e instanceof Array?r(e,t,i):n(e,t,i)}var s=Array.prototype.push;t.exports=o},{}],57:[function(e,t,i){"use strict";function n(e){return Object(e)===e}function r(e){return e instanceof Array}var o=Array.prototype.push;t.exports=function e(t,i){return[t,i].every(r)?(o.apply(i,t.filter(function(e){return i.indexOf(e)<0})),i):Object.keys(t).reduce(function(i,r){return[t[r],i[r]].every(n)&&e(t[r],i[r]),r in i||(i[r]=t[r]),i},i)}},{}],58:[function(e,t,i){"use strict";t.exports=function(){return Array.prototype.slice.call(arguments).reduce(function(e,t){return Object.keys(t||{}).reduce(function(e,i){return e[i]=t[i],e},e)},{})}},{}],59:[function(e,t,i){"use strict";t.exports=function(e,t){return"function"!=typeof t?e:(e.then(function(e){t(null,e)},function(e){t(e)}),e)}},{}],60:[function(e,t,i){"use strict";t.exports=function(e){if(/string|number|boolean/.test(typeof e))return isNaN(e)?void 0:Number(e)}},{}],61:[function(e,t,i){"use strict";function n(e){var t=e.childElementCount>0;return{tag:e.tagName,value:t?null:e.textContent,attributes:a.call(e.attributes,function(e,t){return e[t.name]=t.value,e},{}),find:function(t){return r(e.querySelectorAll(t))},children:function(){return s.call(e.childNodes,function(e){return e instanceof Element}).map(n)}}}function r(e){return o.call(e,n)}var o=Array.prototype.map,s=Array.prototype.filter,a=Array.prototype.reduce,u=new DOMParser;t.exports=function(e){var t=u.parseFromString(e,"application/xml");return function(e){return r(t.querySelectorAll(e))}}},{}],62:[function(e,t,i){"use strict";function n(e){return(e>9?"":"0")+e.toString()}t.exports=function(e){return Number(e)!==e?null:[Math.floor(e/60/60),Math.floor(e/60%60),Math.floor(e%60%60)].map(n).join(":")}},{}],63:[function(e,t,i){"use strict";t.exports=function(e){switch((e||"").toLowerCase()){case"true":return!0;case"false":return!1}}},{}],64:[function(e,t,i){"use strict";t.exports=function(e){var t=(e||"").match(/^(\d\d):(\d\d):(\d\d)$/);return t&&t.slice(1,4).map(parseFloat).reduce(function(e,t,i){return e+t*Math.pow(60,Math.abs(i-2))},0)}},{}],65:[function(e,t,i){"use strict";t.exports=function e(t,i){return Object(t)!==t?t:Object.keys(t).reduce(function(n,r){return i&&t[r]instanceof Array?n[r]=t[r].filter(function(e){return void 0!==e}).map(function(t){return e(t,!0)}):i&&t[r]instanceof Object?n[r]=e(t[r],!0):void 0!==t[r]&&(n[r]=t[r]),n},{})}},{}],66:[function(e,t,i){"use strict";function n(e){return{tag:"TrackingEvents",children:e.map(function(e){return{tag:"Tracking",attributes:{event:e.event},value:e.uri,cdata:!0}})}}function r(e){return e.map(function(e){return{tag:function(e){switch(e){case"static":return"StaticResource";case"iframe":return"IFrameResource";case"html":return"HTMLResource"}}(e.type),attributes:{creativeType:e.creativeType},value:e.data,cdata:!0}})}function o(e){return{tag:"AdParameters",value:e.parameters}}function s(e){return{tag:"Linear",children:[{tag:"Duration",value:l(e.duration)},n(e.trackingEvents),o(e)].concat(e.videoClicks?[{tag:"VideoClicks",children:[{tag:"ClickThrough",value:e.videoClicks.clickThrough,cdata:!0}].concat(e.videoClicks.clickTrackings.map(function(e){return{tag:"ClickTracking",value:e,cdata:!0}}),e.videoClicks.customClicks.map(function(e){return{tag:"CustomClick",attributes:{id:e.id},value:e.uri,cdata:!0}}))}]:[],[{tag:"MediaFiles",children:e.mediaFiles.map(function(e){return{tag:"MediaFile",attributes:{id:e.id,width:e.width,height:e.height,bitrate:e.bitrate,type:e.type,delivery:e.delivery,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,apiFramework:e.apiFramework},value:e.uri,cdata:!0}})}])}}function a(e){return{tag:"CompanionAds",children:e.companions.map(function(e){return{tag:"Companion",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,apiFramework:e.apiFramework},children:r(e.resources).concat([n(e.trackingEvents),{tag:"CompanionClickThrough",value:e.clickThrough,cdata:!0},{tag:"AltText",value:e.altText},o(e)])}})}}function u(e){return{tag:"NonLinearAds",children:e.ads.map(function(e){return{tag:"NonLinear",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,minSuggestedDuration:l(e.minSuggestedDuration),apiFramework:e.apiFramework},children:r(e.resources).concat([{tag:"NonLinearClickThrough",value:e.clickThrough,cdata:!0},o(e)])}}).concat([n(e.trackingEvents)])}}var l=e("./utils/seconds_to_timestamp"),c=e("./utils/compile_xml"),d={linear:s,companions:a,nonLinear:u};t.exports=function(e){return c({tag:"VAST",attributes:{version:e.get("version")},children:e.map("ads",function(e){return{tag:"Ad",attributes:{id:e.id},children:[{tag:function(){switch(e.type){case"inline":return"InLine";case"wrapper":return"Wrapper"}}(),children:[{tag:"AdSystem",attributes:{version:e.system.version},value:e.system.name},{tag:"AdTitle",value:e.title},{tag:"Description",value:e.description},{tag:"Survey",value:e.survey,cdata:!0},{tag:"VASTAdTagURI",value:e.vastAdTagURI,cdata:!0}].concat(e.errors.map(function(e){return{tag:"Error",value:e,cdata:!0}}),e.impressions.map(function(e){return{tag:"Impression",value:e.uri,cdata:!0,attributes:{id:e.id}}}),[{tag:"Creatives",children:e.creatives.map(function(e){return{tag:"Creative",attributes:{id:e.id,sequence:e.sequence,AdID:e.adID},children:[function(t){return d[t](e)}(e.type)]}}),required:!0}])}]}})},!0)}},{"./utils/compile_xml":55,"./utils/seconds_to_timestamp":62}],67:[function(e,t,i){"use strict";function n(e){console.log("MyVastEnded"),CallAction("adEvent",{index:e.page_index,eventName:"MyVastEnded"},window.parent)}var r=e("./../models_1/dispatcher"),o=e("./../models_1/configurator"),s=e("./../models_1/iFrameBridge");window.Bridge=s.Bridge,window.CallAction=s.callAction;var a=function(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,i,n){e[i]=n});return e}();if(void 0===a.index&&(a.index="broadcast"),a.hasOwnProperty("site")&&a.site)var u=a.site;else var u=function(){var e=window.location!=window.parent.location?document.referrer:document.location.href;return new URL(e).hostname}();new o({auth:{affiliate_id:a.affiliate_id,pid:a.pid,host:u},successFn:function(e){e.page_index=a.index,a.hasOwnProperty("site")&&a.site&&(e.site=a.site),r.prototype.timerToCloseFn=function(){if(this.timerToClose<0)return void this.playExit();this.timerToClose--;var e=this;setTimeout(function(){e.timerToCloseFn()},1e3)},window.colorPixels=new r("mycontoller","container","placeholder"),window.colorPixels.playType=1,window.colorPixels.timerToClose=80,window.colorPixels.timerToCloseFn(),window.colorPixels.setConfig(e,n)}})},{"./../models_1/configurator":3,"./../models_1/dispatcher":4,"./../models_1/iFrameBridge":6}]},{},[67]);