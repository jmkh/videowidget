!function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return r(n||e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t,n){var i={getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},setCookie:function(e,t,n){n=n||{};var i=n.expires;if("number"==typeof i&&i){var r=new Date;r.setTime(r.getTime()+1e3*i),i=n.expires=r}i&&i.toUTCString&&(n.expires=i.toUTCString()),t=encodeURIComponent(t);var o=e+"="+t;for(var a in n){o+="; "+a;var s=n[a];s!==!0&&(o+="="+s)}document.cookie=o},deleteCookie:function(e){this.setCookie(e,"",{expires:-1})},hashCode:function(e){return e.split("").reduce(function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e},0)},getUserID:function(){var e=this.getCookie("MpVideoVisitorID"),t=this;return e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),t.setCookie("MpVideoVisitorID",e,{expires:864e3})),e},saveObject:function(e,t){var n=btoa(encodeURIComponent(JSON.stringify(e))),i=t||this.hashCode(n).toString(16);return this.setCookie(i,n,{expires:864e3}),i},getObject:function(e,t){var n=this.getCookie(e),i=null;if(void 0!==n&&n){var r=decodeURIComponent(atob(n));i=JSON.parse(r)}return void 0!==t&&t&&this.deleteCookie(e),i}};t.exports=i},{}],2:[function(e,t,n){function i(e){this.slot=e||document.querySelector("#videoslot"),this.slot.style.position="absolute",this.slot.style.top="0",this.slot.style.left="0",this.slot.style.width="100%",this.slot.style.height="100%",this.slot.style.zIndex=-1,this.tick=function(){},this.player=null;var t=r.getUserID(),n=r.getObject(t);n||(n={mute:!1,tvo:.2,vo:.7}),this.plSettings=n}var r=e("./CookieDriver");i.prototype.clear=function(){this.slot.innerHTML="",this.slot.style.display="none",this.slot.style.zIndex=-1},i.prototype.renderControl=function(e,t){switch(e){case"timeoutEl":var n=parseInt(t.dur)-parseInt(t.sec);n=n>0?n:0;var i="<span class='innerSpan'>Реклама: "+n;return t.showControls&&t.skipTime>0&&(i+="  Пропустить через: "+(t.skipTime>0?t.skipTime:0)),i+=" </span>";case"advLink":return"<span class='innerSpan' >"+t+"</span>";case"skipAd":return"<span class='innerSpan'>Пропустить </span>";case"closeAd":return"<span class='innerSpan'> </span>";case"muteButton":return"<span class='innerSpan "+(t?"un":"")+"mute'> </span>";default:return""}},i.prototype.init=function(e){var t=this;t.clear(),t.slot.style.zIndex=999,t.player=e,t.player.adVolume=t.plSettings.mute?0:t.plSettings.vo,t.Extentions={linkTxt:"Перейти на сайт рекламодателя",isClickable:0,controls:0,skipTime:"00:10",skipTime2:"00:05",skipAd:[],addClick:[]},t.player.vast.map("ads[0].extensions",function(e){"linkTxt"==e.type&&e.value&&(t.Extentions.linkTxt=e.value.replace(/^\s+|\s+$/,"")),"isClickable"==e.type&&e.value&&(t.Extentions.isClickable=e.value.replace(/^\s+|\s+$/,"")),"controls"==e.type&&e.value&&(t.Extentions.controls=e.value.replace(/^\s+|\s+$/,"")),"skipTime"==e.type&&e.value&&(t.Extentions.skipTime=e.value.replace(/^\s+|\s+$/,"")),"skipTime2"==e.type&&e.value&&(t.Extentions.skipTime2=e.value.replace(/^\s+|\s+$/,"")),"skipAd"==e.type&&e.value&&t.Extentions.skipAd.push(e.value.replace(/^\s+|\s+$/,"")),"addClick"==e.type&&e.value&&t.Extentions.addClick.push(e.value.replace(/^\s+|\s+$/,""))}),t.drawControls(),t.clickable.onclick=function(){t.ConrolePaused(t.Extentions.isClickable)},t.player.on("AdRemainingTimeChange",function(e){t.ControllerAction(e)}),this.slot.style.display="block"},i.prototype.drawControls=function(){var e=this;e.clickable=document.createElement("DIV"),e.clickable.setAttribute("id","clickable"),e.clickable.style.width="100%",e.clickable.style.height="100%",e.clickable.style.border="1px solid #000000",e.clickable.style.position="absolute",e.clickable.style.top="0",e.clickable.style.left="0",e.clickable.style.cursor="pointer",e.clickable.style.zIndex=1e3,e.slot.appendChild(e.clickable),e.resumeButton=document.createElement("DIV"),e.resumeButton.style.zIndex=1003,e.resumeButton.style.color="#FFFFFF",e.resumeButton.style.width="100%",e.resumeButton.style.height="100%",e.resumeButton.style.cursor="pointer",e.resumeButton.style.display="none",e.resumeButton.className="resume-play",e.clickable.appendChild(e.resumeButton);var t=document.createElement("div");t.id="timeoutDiv",e.player.timeoutDiv=t,e.slot.appendChild(t);var n=document.createElement("div");n.id="closeDiv",e.player.closeDiv=n,e.slot.appendChild(n),n.innerHTML=e.renderControl("closeAd"),n.style.display="none",n.onclick=function(t){t.preventDefault(),e.player.emit("close"),e.player.stopAd()};var i=document.createElement("div");e.player.skipDiv=i,i.id="skipDiv",e.slot.appendChild(i),i.innerHTML=e.renderControl("skipAd"),i.style.display="none",i.onclick=function(t){t.preventDefault(),e.player.emit("skip");for(var n=0;n<e.Extentions.skipAd.length;n++)(new Image).src=e.Extentions.skipAd[n];e.player.stopAd()};var o=document.createElement("div");o.id="advLink",e.player.advLink=o,e.slot.appendChild(o),o.innerHTML=e.renderControl("advLink",decodeURIComponent(e.Extentions.linkTxt)),e.player.vast.get("ads[0].creatives[0].videoClicks.clickThrough")||(o.style.display="none"),o.onclick=function(t){t.preventDefault();for(var n=0;n<e.Extentions.addClick.length;n++)(new Image).src=e.Extentions.addClick[n];e.ConrolePaused(1)};var a=document.createElement("div");a.id="muteButton",a.style.border="1px solid red",a.style.zIndex=9999,a.style.position="absolute",e.player.muteButton=a,e.slot.appendChild(a),a.innerHTML=e.renderControl("muteButton",e.player.adVolume),a.onclick=function(t){t.preventDefault(),e.player.adVolume=e.player.adVolume?0:.6;var n=r.getUserID();return e.player.adVolume?e.plSettings.mute=!1:e.plSettings.mute=!0,r.saveObject(e.plSettings,n),e.player.muteButton.innerHTML=e.renderControl("muteButton",e.player.adVolume),!1}},i.prototype.ControllerAction=function(e){var t=this;if(void 0!==t.player.timeoutDiv){var n=(60*parseInt(t.Extentions.skipTime.split(":")[0])+parseInt(t.Extentions.skipTime.split(":")[1]))%parseInt(e.dur),i=(60*parseInt(t.Extentions.skipTime2.split(":")[0])+parseInt(t.Extentions.skipTime2.split(":")[1]))%parseInt(e.dur);n>i&&(n=i);var r=i<=parseInt(e.sec)&&i>0,o=n<=parseInt(e.sec)&&n>0;e.skipTime=n-parseInt(e.sec),e.showControls="1"==t.Extentions.controls;var a=t.renderControl("timeoutEl",e);t.player.timeoutDiv.innerHTML=a,"1"==t.Extentions.controls&&r&&(t.player.closeDiv.style.display="block"),"1"==t.Extentions.controls&&o&&(t.player.skipDiv.style.display="block")}},i.prototype.ConrolePaused=function(e){if(this.player.isPaused)void 0!==this.resumeButton&&(this.resumeButton.style.display="none"),this.player.isPaused=0,this.player.resumeAd();else{this.player.isPaused=1,this.player.pauseAd(),this.resumeButton,this.resumeButton.style.display="block",this.player.emit("clickThrough");var t=this.player.vast.get("ads[0].creatives[0].videoClicks.clickThrough");e&&t&&window.open(t)}},t.exports=i},{"./CookieDriver":1}],3:[function(e,t,n){"use strict";function i(){var e=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(navigator.platform)for(;e.length;)if(navigator.platform===e.pop())return!0;return!1}function r(e){var t={size:{width:"350",height:"400"},container:"#mp-video-widget-container-56015401b3da9-20",auth:{affiliate_id:"56015401b3da9",pid:"20"},errorFn:function(){},successFn:function(e){}},n=t;for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var a=this;this.loaded=!1;var s=n.auth.host.replace(/^www\./,"");this.configUrl="https://widget.market-place.su/videoopt/"+n.auth.affiliate_id+"_"+n.auth.pid+"_"+s+".json?p="+Math.random();var u=e.errorFn||function(){};e.successFn;o.ajax(this.configUrl,{errorFn:u,successFn:function(e){try{var t=JSON.parse(e);if(void 0!==t.error)throw new Error("Виджет удалён.");for(var r in t)t.hasOwnProperty(r)&&(a[r]=t[r]);var s=/Android|Silk|Mobile|PlayBook/.test(window.navigator.userAgent),u=i();switch(a.isDesktop=!s,!0){case u:a.ads=t["ads-mobile"].iOS;break;case s:a.ads=t["ads-mobile"].Android}o.ajax("https://widget.market-place.su/proxy_referer/",{errorFn:function(){},successFn:function(e){try{var i=JSON.parse(e);a.loaded=!0,a.referer=i,n.successFn(a),window.parent.postMessage(t,"*")}catch(e){console.log("битая конфигурация",e)}}})}catch(e){console.log("битая конфигурация",e)}}})}var o=e("./httpclient");t.exports=r},{"./httpclient":5}],4:[function(e,t,n){"use strict";function i(e,t,n){this.controller=document.getElementById(e),this.container=document.getElementById(e),this.placeholder=document.getElementById(n),this.extraslot=document.createElement("DIV"),this.extraslot.id="videoslot",this.container.appendChild(this.extraslot),this.VideoSlot=new a(this.extraslot),this.queueToPLay=[],this.queueToPlaySemaphore=0,this.queueSemaphores={},this.queueToPlayExit=0,this.loadedStatuses={},this.cachedConf={},this.loadedCnt=0,this.playedCnt=0,this.playedRoliks={},this.config={},this.links=[],this.AllowedStart=0,this.timerToClose=80,this.collbackFunction=function(){},this.indexMassive={},this.indexDefault={},this.cacheStatisticIndexes={},this.cookieUserid=o.getUserID(),this.lastDriverId=0,this.mytype="Autoplay",this.playedAllCnt={},this.playedJumpedTop={},this.popularTrailer=0,this.OverplayAuto=0,this.OverplayDescFirst=0,this.referer="http://apptoday.ru";var i=this;void 0===this.GlobalMyGUITemp&&(this.GlobalMyGUITemp="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),window.GlobalMyGUITemp=this.GlobalMyGUITemp),this.fromUrl=window.location!=window.parent.location?document.referrer:document.location.href,this.fromDomain=new URL(this.fromUrl).hostname,window.addEventListener("resize",function(){i.calculateParameters()},!1),i.calculateParameters()}var r=e("vast-player"),o=e("./CookieDriver"),a=e("./VideoSlot"),s=e("./iFrameBridge");window.Bridge=s.Bridge,window.CallAction=s.callAction,i.prototype.firstPlaySignal=function(){this.OverplayDescFirst||(this.OverplayDescFirst=1)},i.prototype.calculateParameters=function(){screen.width,screen.height},i.prototype.setConfig=function(e,t){if(e.hasOwnProperty("site")&&(this.fromDomain=e.site,console.log(["domain родителя",this.fromDomain])),e.hasOwnProperty("adslimit")||(e.adslimit=2),this.config=e,e.hasOwnProperty("referer")&&e.referer&&(this.referer=e.referer),this.collbackFunction=t,e.hasOwnProperty("type"))switch(e.type){case"1":this.mytype="Autoplay";break;case"2":this.mytype="Context";break;case"3":this.mytype="Overlay";break;case"4":this.mytype="VAST-Link";break;default:this.mytype="Video"}this.loadedCnt=e.ads.length,this.restartQueue(),this.loadedCnt=e.ads.length,this.initQueue(e.ads)},i.prototype.clearController=function(){this.controller.style.display="none"},i.prototype.showController=function(){this.controller.style.display="block"},i.prototype.clearContainer=function(){this.container.style.display="none"},i.prototype.showContainer=function(){this.container.style.display="block"},i.prototype.clearPlaceholder=function(){this.placeholder.style.display="none"},i.prototype.showPlaceholder=function(){this.placeholder.style.display="block"},i.prototype.timerToCloseFn=function(){if(this.timerToClose<0){this.LastControllerPan=document.createElement("DIV"),this.LastControllerPan.style.position="absolute",this.LastControllerPan.style.top="calc(50% - 50px)",this.LastControllerPan.style.left="calc(50% - 50px)",this.LastControllerPan.style.opacity="0.5",this.LastControllerPan.style.filter="alpha(Opacity=50)",this.LastControllerPan.style.color="#FFFFFF",this.LastControllerPan.style.zIndex="4500",this.LastControllerPan.className="lastController",this.LastcloseRemain=document.createElement("DIV"),this.LastcloseRemain.style.display="block",this.LastcloseRemain.style.marginLeft="5px",this.LastcloseRemain.fontSize="12px",this.LastcloseDiv=document.createElement("DIV"),this.LastcloseDiv.style.marginLeft="5px",this.LastcloseDiv.style.backgroundImage="url(https://apptoday.ru/ug/img/exit.png) ",this.LastcloseDiv.style.backgroundRepeat="no-repeat",this.LastcloseDiv.style.backgroundSize="contain",this.LastcloseDiv.style.content="",this.LastcloseDiv.className="hover_button",this.LastcloseDiv.style.width="100px",this.LastcloseDiv.style.height="100px",this.LastcloseDiv.title="закрыть рекламу",this.LastcloseDiv.style.cursor="pointer",this.LastcloseDiv.style.display="block";var e=this;return this.LastcloseDiv.onmouseout=function(){e.LastControllerPan.style.opacity="0.5",e.LastControllerPan.style.filter="alpha(Opacity=50)"},this.LastcloseDiv.onmouseover=function(){e.LastControllerPan.style.opacity="0.8",e.LastControllerPan.style.filter="alpha(Opacity=80)"},this.LastcloseDiv.onclick=function(){return document.body.innerHTML="",e.config.hasOwnProperty("page_index")?window.parent.postMessage({name:"die",data:{index:e.config.page_index},bridgeAction:!0},"*"):window.parent.postMessage({die:1},"*"),!0},this.LastControllerPan.appendChild(this.LastcloseRemain),this.LastControllerPan.appendChild(this.LastcloseDiv),void(this.controller&&this.controller.appendChild(this.LastControllerPan))}this.timerToClose--;var e=this;setTimeout(function(){e.timerToCloseFn()},1e3)},i.prototype.restartQueue=function(e){this.indexMassive={},this.predLoadQueue=[],this.queueToPlayExit=0,this.cachedFlagMy=0,this.loadedCnt=0,this.predLoadQueueCachedObjects={},this.loadedStatuses={},this.queueToPLay=[],this.queueSemaphores={}},i.prototype.CheckOverplaySrc=function(e){return(31==e||32==e)&&(this.OverplayAuto=1,!0)},i.prototype.calculatePlayed=function(){var e,t=0;for(e in this.playedRoliks)t++;return t},i.prototype.prepareFrame=function(e){var t=document.createElement("DIV");return t.id=e,t.style.display="none",t.style.width="100%",t.style.height="100%",this.container.appendChild(t),t},i.prototype.checkSemaphores=function(){var e,t=0,n=0;for(e in this.queueSemaphores)n++,this.queueSemaphores[e]&&(t=1);return!!t},i.prototype.deleteSemaphore=function(e){this.queueSemaphores[e]=0},i.prototype.setSemaphore=function(e){this.queueSemaphores[e]=1},i.prototype.dispatchQueue=function(e,t){if(console.log([1,t.message]),!this.queueToPlayExit){this.deleteSemaphore(e),t.player&&(t.player.container.style.display="none");var n,i=0,r=0;for(n in this.loadedStatuses)0==this.loadedStatuses[n]&&(i|=1),r++;r<this.loadedCnt&&(i|=2),this.queueToPLay.length&&(i|=4),this.checkSemaphores()&&(i|=8),i||this.playExit()}},i.prototype.initQueue=function(e){if(!this.queueToPlayExit){this.cachedFlagMy=1;for(var t=0,n=e.length;t<n;t++)t&&this.loadedCnt/t<=2&&(this.indexMassive[e[t].id]=2),20!=e[t].pivot.id_block&&28!=e[t].pivot.id_block||(this.popularTrailer=6),this.CheckOverplaySrc(e[t].id),this.predLoadQueue.push(e[t]);this.formLoadQueue(0)}},i.prototype.formLoadQueue=function(e){if(!this.predLoadQueueCachedObjects.hasOwnProperty(e)&&!this.queueToPlayExit){var t=this.calculatePlayed();if(this.config.adslimit<=t)return this.predLoadQueue=[],void(this.loadedCnt=t);this.predLoadQueueCachedObjects[e]=1;var n=this,i=this.predLoadQueue.shift();if(i){var o="bycredit_"+i.id,a=this.prepareFrame(o),s=new r(a,{withCredentials:!0,bidgeFn:function(e,t,i){switch(t){case"firstQuartile":n.sendStatistic({id:e,eventName:"filterPlayMedia"}),n.formLoadQueue(e)}n.sendStatistic({id:e,eventName:t}),void 0!==n.config.page_index&&CallAction("adEvent",{index:n.config.page_index,eventName:t},window.parent)}});s.id_local_source=i.id,s.local_title=i.title,s.local_src=i.src,this.loadQueue(s)}}},i.prototype.loadQueue=function(e){if(!this.queueToPlayExit){var t=this,n=e.local_src.replace(/\{([a-z]+)\}/g,function(e){switch(e.replace(/[\{\}]+/g,"")){case"rnd":return Math.random();case"ref":return encodeURIComponent(t.referer)}return e});this.loadedStatuses[e.id_local_source]=0,this.sendStatistic({id:e.id_local_source,eventName:"srcRequest"}),e.load(n).then(function(){console.log(["loaded 1"]),t.sendStatistic({id:e.id_local_source,eventName:"startPlayMedia",mess:""}),e.once("AdError",function(n){t.sendStatistic({id:e.id_local_source,eventName:"errorPlayMedia",mess:""}),t.formLoadQueue(e.id_local_source),t.dispatchQueue(e.id_local_source,{player:e,message:"вернул "+e.local_title+JSON.stringify(n)})}),e.once("AdStopped",function(){t.dispatchQueue(e.id_local_source,{player:e,message:" остановлен "+e.local_title})}),t.loadedStatuses[e.id_local_source]=1,e.startAd().then(function(n){t.queueToPLay.length||3==e.id_local_source||36==e.id_local_source||40==e.id_local_source?(e.pau=1,e.pauseAd()):e.pau=0,t.filterQueue(e)}).catch(function(n){t.sendStatistic({id:e.id_local_source,eventName:"errorPlayMedia",mess:""}),t.formLoadQueue(e.id_local_source),t.loadedStatuses[e.id_local_source]=2,t.dispatchQueue(e.id_local_source,{player:e,message:"не играет "+e.local_title+JSON.stringify(n)})})}).catch(function(n){t.sendStatistic({id:e.id_local_source,eventName:"errorPlayMedia",mess:""}),t.formLoadQueue(e.id_local_source),t.loadedStatuses[e.id_local_source]=2,t.dispatchQueue(e.id_local_source,{player:e,message:"ошибка "+e.local_title+JSON.stringify(n)})})}},i.prototype.filterQueue=function(e){this.queueToPlayExit||(this.queueToPLay.push(e),this.playQueue())},i.prototype.playQueue=function(){if(!this.queueToPlayExit){var e=this;if(this.checkSemaphores())return void setTimeout(function(){e.playQueue()},500);var t=this.queueToPLay.shift();this.setSemaphore(t.id_local_source);var n=t.container;if(this.showController(),this.showContainer(),this.clearPlaceholder(),n.style.display="block",this.firstPlaySignal(),this.VideoSlot.clear(),3!=t.pType&&36!=t.pType||this.VideoSlot.init(t),4==t.pType||this.CheckOverplaySrc(t.id_local_source)){var i=1;t.on("AdRemainingTimeChange",function(t){i&&(i=0,e.clearPlaceholder())}),this.VideoSlot.clear(),2==this.playType&&t.once("AdPlaying",function(){e.container.style.opacity="0",e.container.style.filter="alpha(Opacity=0)"}),this.CheckOverplaySrc(t.id_local_source)&&t.once("AdPlaying",function(){e.OverplayAut=2,t.container.style.opacity="1",t.container.style.filter="alpha(Opacity=100)",e.container.style.opacity="1",e.container.style.filter="alpha(Opacity=100)",e.formLoadQueue(t.id_local_source),e.sendStatistic({id:t.id_local_source,eventName:"filterPlayMedia"})}),t.once("AdClickThru",function(n,i,r){e.showPlaceholder(),t.__private__.player.video.play(),t.container.style.opacity="1",t.container.style.filter="alpha(Opacity=100)",e.container.style.opacity="1",e.container.style.filter="alpha(Opacity=100)",e.VideoSlot.init(t)})}else t.container.style.opacity="1",t.container.style.filter="alpha(Opacity=100)",e.container.style.opacity="1",e.container.style.filter="alpha(Opacity=100)",1!=this.OverplayAut&&1==t.pau&&t.resumeAd()}},i.prototype.playExit=function(){this.queueToPlayExit||(this.queueToPlayExit=1,this.VideoSlot.clear(),this.controller.style.display="none",this.collbackFunction(this.config))},i.prototype.sendStatistic=function(e){if(!this.indexDefault.hasOwnProperty(e.id)){var t="";if(void 0!==e.eventName&&(void 0===this.cacheStatisticIndexes[e.id]&&(this.cacheStatisticIndexes[e.id]={}),void 0!==e.mess&&(t=e.mess),void 0===this.cacheStatisticIndexes[e.id][e.eventName])){switch(e.eventName){case"filterPlayMedia":this.playedRoliks[e.id]="fd"}this.cacheStatisticIndexes[e.id][e.eventName]=1;var n={key:this.GlobalMyGUITemp,fromUrl:encodeURIComponent(this.fromUrl),pid:this.config.pid,affiliate_id:this.config.affiliate_id,cookie_id:this.cookieUserid,id_src:e.id,event:e.eventName,mess:t},i="https://api.market-place.su/Product/video/l1stat.php?p="+Math.random()+"&data="+encodeURIComponent(JSON.stringify(n));new Image(1,1).src=i}}},i.prototype.playAds=function(e,t){var n=this,i="bycredit_"+e.id,o=this.prepareFrame(i),a=new r(o,{withCredentials:!0,bidgeFn:function(e,t,n){t}});a.id_local_source=e.id,a.local_title=e.title,a.local_src=e.src,a.id_local_source;var s=a.local_src.replace(/\{([a-z]+)\}/g,function(e){switch(e.replace(/[\{\}]+/g,"")){case"rnd":return Math.random();case"ref":return encodeURIComponent(n.referer)}return e});a.load(s).then(function(){a.once("AdError",function(e){a.container.style.display="none",n.VideoSlot.clear(),t()}),a.once("AdStopped",function(){a.container.style.display="none",n.VideoSlot.clear(),t()}),a.id_local_source==-5&&(a.__private__.player.video.muted=!0,a.__private__.player.video.controls=!0),a.startAd().then(function(e){if(a.pauseAd(),n.showController(),n.showContainer(),n.clearPlaceholder(),o.style.display="block",3==a.pType&&(a.id_local_source==-5?a.__private__.player.video.controls=!0:n.VideoSlot.init(a)),4!=a.pType)a.container.style.opacity="1",a.container.style.filter="alpha(Opacity=100)",n.container.style.opacity="1",n.container.style.filter="alpha(Opacity=100)",a.resumeAd();else{if(a.id_local_source==-4)return a.container.style.display="none",n.VideoSlot.clear(),void t();var i=1;a.on("AdRemainingTimeChange",function(e){i&&(i=0,n.clearPlaceholder())}),n.VideoSlot.clear(),2==n.playType&&(n.container.style.opacity="0",n.container.style.filter="alpha(Opacity=0)"),a.once("AdClickThru",function(e,t,i){n.showPlaceholder(),a.__private__.player.video.play(),a.container.style.opacity="1",a.container.style.filter="alpha(Opacity=100)",n.container.style.opacity="1",n.container.style.filter="alpha(Opacity=100)",a.id_local_source==-5||n.VideoSlot.init(a)})}}).catch(function(e){a.container.style.display="none",n.VideoSlot.clear(),t()})}).catch(function(e){a.container.style.display="none",n.VideoSlot.clear(),t()})},i.prototype.playDefault=function(e){if(1&this.popularTrailer)return void e();this.popularTrailer|=1;if(this.config.hasOwnProperty("default")&&this.config.default){var t={id:-3,src:this.config.default,priority:"10",title:"Заглушка",created_at:"2017-03-22 16:29:45",updated_at:"2017-03-22 16:29:45",pivot:{id_block:"-3",id_source:"-3",prioritet:"0"}};this.playAds(t,e)}else e()},i.prototype.playTvigle=function(e){if(2&this.popularTrailer)return void e();if(console.log("play tvigle 1"),this.popularTrailer|=2,/(android)/i.test(navigator.userAgent))return void e();var t={id:-4,src:"https://video.market-place.su/vast/tvigle.xml?r={rnd}",priority:"10",title:"Твигл",created_at:"2017-03-22 16:29:45",updated_at:"2017-03-22 16:29:45",pivot:{id_block:"-4",id_source:"-4",prioritet:"0"}};this.playAds(t,e)},i.prototype.playTrailer=function(e){if(4&this.popularTrailer)return void e();this.popularTrailer|=4;var t={id:-5,src:"https://video.market-place.su/proxy_trailer/",priority:"10",title:"Трейлеры",created_at:"2017-03-22 16:29:45",updated_at:"2017-03-22 16:29:45",pivot:{id_block:"-5",id_source:"-5",prioritet:"0"}};this.playAds(t,e)},t.exports=i},{"./CookieDriver":1,"./VideoSlot":2,"./iFrameBridge":6,"vast-player":25}],5:[function(e,t,n){"use strict";var i={ajax:function(e,t){var n=e;t=t||{};var i=t.errorFn||function(){},r=t.successFn||function(){},o=t.type||"GET",a=t.data||{},s=JSON.stringify(a);if(o=o.toUpperCase(),window.XMLHttpRequest)var u=new XMLHttpRequest;else var u=new ActiveXObject("Microsoft.XMLHTTP");if("GET"==o){s=null,n.indexOf("?")<0&&(n+="?1=1");for(var c in a)a.hasOwnProperty(c)&&(n+="&"+c+"="+a[c])}u.open(o,n,!0),u.onreadystatechange=function(){4==u.readyState?200==u.status?r({response:u.responseText}):i({status:u.status}):i({status:u.readyState})},u.onreadystatechange=function(){4==u.readyState&&(200==u.status?r(u.responseText):i({status:u.status}))};try{u.withCredentials=t.withCredentials||!1,u.send(s)}catch(e){}}};t.exports=i},{}],6:[function(e,t,n){"use strict";function i(e){var e=e||o();return void 0===window.MpFrameBridges&&(window.MpFrameBridges={}),void 0!==window.MpFrameBridges[e]?window.MpFrameBridges[e]:(window.MpFrameBridges[e]=new a(e),window.MpFrameBridges[e])}function r(e,t,n){n.postMessage({name:e,data:t,bridgeAction:!0},"*")}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function a(e){this.index=e||o();var t={default:function(){}};this.execAction=function(e,n){(t[e]||t.default||function(){}).call(this,n)},this.addAction=function(e,n){t[e]=n},this.showActions=function(){console.log(t)}}window.makeBridge=i,window.mp_bridge_listener=function(e){if("object"==typeof e.data&&void 0!==e.data.bridgeAction&&1==e.data.bridgeAction){if("broadcast"==e.data.data.index&&void 0!==window.MpFrameBridges)for(var t in window.MpFrameBridges)window.MpFrameBridges.hasOwnProperty(t)&&window.MpFrameBridges[t].execAction(e.data.name,e.data.data);i(e.data.data.index).execAction(e.data.name,e.data.data)}},void 0===window.MpBridgeListenerAttached&&(window.addEventListener?window.addEventListener("message",mp_bridge_listener):window.attachEvent("onmessage",mp_bridge_listener),window.MpBridgeListenerAttached=!0),t.exports={Bridge:i,callAction:r}},{}],7:[function(e,t,n){function i(e){if(e)return r(e)}function r(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}void 0!==t&&(t.exports=i),i.prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},i.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i,r=0;r<n.length;r++)if((i=n[r])===t||i.fn===t){n.splice(r,1);break}return this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var i=0,r=n.length;i<r;++i)n[i].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],8:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,o,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,o=new Array(i-1),u=1;u<i;u++)o[u-1]=arguments[u];n.apply(this,o)}else if(a(n)){for(i=arguments.length,o=new Array(i-1),u=1;u<i;u++)o[u-1]=arguments[u];for(c=n.slice(),i=c.length,u=0;u<i;u++)c[u].apply(this,o)}return!0},i.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned){var n;n=s(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,o,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],o=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.listenerCount=function(e,t){return e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],9:[function(e,t,n){(function(e){"use strict";function n(){l=!0;for(var e,t,n=p.length;n;){for(t=p,p=[],e=-1;++e<n;)t[e]();n=p.length}l=!1}function i(e){1!==p.push(e)||l||r()}var r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,s=new o(n),u=e.document.createTextNode("");s.observe(u,{characterData:!0}),r=function(){u.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,r=function(){c.port2.postMessage(0)}}var l,p=[];t.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,n){"use strict";function i(){}function r(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,e!==i&&u(this,e)}function o(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){f(function(){var i;try{i=t(n)}catch(t){return y.reject(e,t)}i===e?y.reject(e,new TypeError("Cannot resolve promise with itself")):y.resolve(e,i)})}function s(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function u(e,t){function n(t){o||(o=!0,y.reject(e,t))}function i(t){o||(o=!0,y.resolve(e,t))}function r(){t(i,n)}var o=!1,a=c(r);"error"===a.status&&n(a.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function l(e){return e instanceof this?e:y.resolve(new this(i),e)}function p(e){var t=new this(i);return y.reject(t,e)}function d(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([])
;for(var o=new Array(n),a=0,s=-1,u=new this(i);++s<n;)!function(e,i){function s(e){o[i]=e,++a!==n||r||(r=!0,y.resolve(u,o))}t.resolve(e).then(s,function(e){r||(r=!0,y.reject(u,e))})}(e[s],s);return u}function h(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=-1,a=new this(i);++o<n;)!function(e){t.resolve(e).then(function(e){r||(r=!0,y.resolve(a,e))},function(e){r||(r=!0,y.reject(a,e))})}(e[o]);return a}var f=e("immediate"),y={},v=["REJECTED"],m=["FULFILLED"],g=["PENDING"];t.exports=r,r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if("function"!=typeof e&&this.state===m||"function"!=typeof t&&this.state===v)return this;var n=new this.constructor(i);if(this.state!==g){a(n,this.state===m?e:t,this.outcome)}else this.queue.push(new o(n,e,t));return n},o.prototype.callFulfilled=function(e){y.resolve(this.promise,e)},o.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},o.prototype.callRejected=function(e){y.reject(this.promise,e)},o.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},y.resolve=function(e,t){var n=c(s,t);if("error"===n.status)return y.reject(e,n.value);var i=n.value;if(i)u(e,i);else{e.state=m,e.outcome=t;for(var r=-1,o=e.queue.length;++r<o;)e.queue[r].callFulfilled(t)}return e},y.reject=function(e,t){e.state=v,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},r.resolve=l,r.reject=p,r.all=d,r.race=h},{immediate:9}],11:[function(e,t,n){!function(e,n){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=n():"function"==typeof define&&define.amd?define([],n):e.objectPath=n()}(this,function(){"use strict";function e(e){if(!e)return!0;if(o(e)&&0===e.length)return!0;for(var t in e)if(p.call(e,t))return!1;return!0}function t(e){return l.call(e)}function n(e){return"number"==typeof e||"[object Number]"===t(e)}function i(e){return"string"==typeof e||"[object String]"===t(e)}function r(e){return"object"==typeof e&&"[object Object]"===t(e)}function o(e){return"object"==typeof e&&"number"==typeof e.length&&"[object Array]"===t(e)}function a(e){return"boolean"==typeof e||"[object Boolean]"===t(e)}function s(e){var t=parseInt(e);return t.toString()===e?t:e}function u(t,r,o,a){if(n(r)&&(r=[r]),e(r))return t;if(i(r))return u(t,r.split("."),o,a);var c=s(r[0]);if(1===r.length){var l=t[c];return void 0!==l&&a||(t[c]=o),l}return void 0===t[c]&&(n(c)?t[c]=[]:t[c]={}),u(t[c],r.slice(1),o,a)}function c(t,r){if(n(r)&&(r=[r]),!e(t)){if(e(r))return t;if(i(r))return c(t,r.split("."));var a=s(r[0]),u=t[a];if(1===r.length)void 0!==u&&(o(t)?t.splice(a,1):delete t[a]);else if(void 0!==t[a])return c(t[a],r.slice(1));return t}}var l=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d={};return d.ensureExists=function(e,t,n){return u(e,t,n,!0)},d.set=function(e,t,n,i){return u(e,t,n,i)},d.insert=function(e,t,n,i){var r=d.get(e,t);i=~~i,o(r)||(r=[],d.set(e,t,r)),r.splice(i,0,n)},d.empty=function(t,s){if(e(s))return t;if(!e(t)){var u,c;if(!(u=d.get(t,s)))return t;if(i(u))return d.set(t,s,"");if(a(u))return d.set(t,s,!1);if(n(u))return d.set(t,s,0);if(o(u))u.length=0;else{if(!r(u))return d.set(t,s,null);for(c in u)p.call(u,c)&&delete u[c]}}},d.push=function(e,t){var n=d.get(e,t);o(n)||(n=[],d.set(e,t,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},d.coalesce=function(e,t,n){for(var i,r=0,o=t.length;r<o;r++)if(void 0!==(i=d.get(e,t[r])))return i;return n},d.get=function(t,r,o){if(n(r)&&(r=[r]),e(r))return t;if(e(t))return o;if(i(r))return d.get(t,r.split("."),o);var a=s(r[0]);return 1===r.length?void 0===t[a]?o:t[a]:d.get(t[a],r.slice(1),o)},d.del=function(e,t){return c(e,t)},d})},{}],12:[function(e,t,n){function i(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){n.shift()()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=i,r.addListener=i,r.once=i,r.off=i,r.removeListener=i,r.removeAllListeners=i,r.emit=i,r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],13:[function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;e=e.split(t);var s=1e3;o&&"number"==typeof o.maxKeys&&(s=o.maxKeys);var u=e.length;s>0&&u>s&&(u=s);for(var c=0;c<u;++c){var l,p,d,h,f=e[c].replace(/\+/g,"%20"),y=f.indexOf(n);y>=0?(l=f.substr(0,y),p=f.substr(y+1)):(l=f,p=""),d=decodeURIComponent(l),h=decodeURIComponent(p),i(a,d)?r(a[d])?a[d].push(h):a[d]=[a[d],h]:a[d]=h}return a};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],14:[function(e,t,n){"use strict";function i(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),function(i){var a=encodeURIComponent(r(i))+n;return o(e[i])?e[i].map(function(e){return a+encodeURIComponent(r(e))}).join(t):a+encodeURIComponent(r(e[i]))}).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},{}],15:[function(e,t,n){"use strict";n.decode=n.parse=e("./decode"),n.encode=n.stringify=e("./encode")},{"./decode":13,"./encode":14}],16:[function(e,t,n){t.exports=function(e,t,n){for(var i=0,r=e.length,o=3==arguments.length?n:e[i++];i<r;)o=t.call(null,o,e[i],++i,e);return o}},{}],17:[function(e,t,n){var i,r,o,a=e("object-path");o=function(e){return function(t){return typeof t===e}},r=function(e,t){var n=1,i=t||function(e,t){return t};return"-"===e[0]&&(n=-1,e=e.substr(1)),function(t,r){var o,s=i(e,a.get(t,e)),u=i(e,a.get(r,e));return s<u&&(o=-1),s>u&&(o=1),s===u&&(o=0),o*n}},i=function(){var e=Array.prototype.slice.call(arguments),t=e.filter(o("string")),n=e.filter(o("function"))[0];return function(e,i){for(var o=t.length,a=0,s=0;0===a&&s<o;)a=r(t[s],n)(e,i),s++;return a}},t.exports=i},{"object-path":11}],18:[function(e,t,n){function i(){}function r(e){switch({}.toString.call(e)){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function o(e){if(!w(e))return e;var t=[];for(var n in e)null!=e[n]&&a(t,n,e[n]);return t.join("&")}function a(e,t,n){if(Array.isArray(n))return n.forEach(function(n){a(e,t,n)});e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}function s(e){for(var t,n,i={},r=e.split("&"),o=0,a=r.length;o<a;++o)n=r[o],t=n.split("="),i[decodeURIComponent(t[0])]=decodeURIComponent(t[1]);return i}function u(e){var t,n,i,r,o=e.split(/\r?\n/),a={};o.pop();for(var s=0,u=o.length;s<u;++s)n=o[s],t=n.indexOf(":"),i=n.slice(0,t).toLowerCase(),r=A(n.slice(t+1)),a[i]=r;return a}function c(e){return/[\/+]json\b/.test(e)}function l(e){return e.split(/ *; */).shift()}function p(e){return m(e.split(/ *; */),function(e,t){var n=t.split(/ *= */),i=n.shift(),r=n.shift();return i&&r&&(e[i]=r),e},{})}function d(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||void 0===this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=u(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function h(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new d(n)}catch(t){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=t,e.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,e.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(e)}if(n.emit("response",t),e)return n.callback(e,t);if(t.status>=200&&t.status<300)return n.callback(e,t);var i=new Error(t.statusText||"Unsuccessful HTTP response");i.original=e,i.response=t,i.status=t.status,n.callback(i,t)})}function f(e,t){var n=_("DELETE",e);return t&&n.end(t),n}var y,v=e("emitter"),m=e("reduce"),g=e("./request-base"),w=e("./is-object");y="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var _=t.exports=e("./request").bind(null,h);_.getXHR=function(){if(!(!y.XMLHttpRequest||y.location&&"file:"==y.location.protocol&&y.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1};var A="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};_.serializeObject=o,_.parseString=s,_.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},_.serialize={"application/x-www-form-urlencoded":o,"application/json":JSON.stringify},_.parse={"application/x-www-form-urlencoded":s,"application/json":JSON.parse},d.prototype.get=function(e){return this.header[e.toLowerCase()]},d.prototype.setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=l(t);var n=p(t);for(var i in n)this[i]=n[i]},d.prototype.parseBody=function(e){var t=_.parse[this.type];return!t&&c(this.type)&&(t=_.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null},d.prototype.setStatusProperties=function(e){1223===e&&(e=204);var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},d.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,i="cannot "+t+" "+n+" ("+this.status+")",r=new Error(i);return r.status=this.status,r.method=t,r.url=n,r},_.Response=d,v(h.prototype);for(var b in g)h.prototype[b]=g[b];h.prototype.abort=function(){if(!this.aborted)return this.aborted=!0,this.xhr&&this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this},h.prototype.type=function(e){return this.set("Content-Type",_.types[e]||e),this},h.prototype.responseType=function(e){return this._responseType=e,this},h.prototype.accept=function(e){return this.set("Accept",_.types[e]||e),this},h.prototype.auth=function(e,t,n){switch(n||(n={type:"basic"}),n.type){case"basic":var i=btoa(e+":"+t);this.set("Authorization","Basic "+i);break;case"auto":this.username=e,this.password=t}return this},h.prototype.query=function(e){return"string"!=typeof e&&(e=o(e)),e&&this._query.push(e),this},h.prototype.attach=function(e,t,n){return this._getFormData().append(e,t,n||t.name),this},h.prototype._getFormData=function(){return this._formData||(this._formData=new y.FormData),this._formData},h.prototype.send=function(e){var t=w(e),n=this._header["content-type"];if(t&&w(this._data))for(var i in e)this._data[i]=e[i];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],this._data="application/x-www-form-urlencoded"==n?this._data?this._data+"&"+e:e:(this._data||"")+e):this._data=e;return!t||r(e)?this:(n||this.type("json"),this)},d.prototype.parse=function(e){return y.console&&console.warn("Client-side parse() method has been renamed to serialize(). This method is not compatible with superagent v2.0"),this.serialize(e),this},d.prototype.serialize=function(e){return this._parser=e,this},h.prototype.callback=function(e,t){var n=this._callback;this.clearTimeout(),n(e,t)},h.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},h.prototype.timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},h.prototype.withCredentials=function(){return this._withCredentials=!0,this},h.prototype.end=function(e){var t=this,n=this.xhr=_.getXHR(),o=this._query.join("&");this._timeout=15e3;var a=this._timeout,s=this._formData||this._data;this._callback=e||i,n.onreadystatechange=function(){if(4==n.readyState){var e;try{e=n.status}catch(t){e=0}if(0==e){if(t.timedout)return t.timeoutError();if(t.aborted)return;return t.crossDomainError()}t.emit("end")}};var u=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),e.direction="download",t.emit("progress",e)};this.hasListeners("progress")&&(n.onprogress=u);try{n.upload&&this.hasListeners("progress")&&(n.upload.onprogress=u)}catch(e){}if(a&&!this._timer&&(this._timer=setTimeout(function(){t.timedout=!0,t.abort()},a)),o&&(o=_.serializeObject(o),this.url+=~this.url.indexOf("?")?"&"+o:"?"+o),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),n.withCredentials=!0,"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof s&&!r(s)){var l=this._header["content-type"],p=this._parser||_.serialize[l?l.split(";")[0]:""];!p&&c(l)&&(p=_.serialize["application/json"]),p&&(s=p(s))}for(var d in this.header)null!=this.header[d]&&n.setRequestHeader(d,this.header[d]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send(void 0!==s?s:null),this},_.Request=h,_.get=function(e,t,n){var i=_("GET",e);return"function"==typeof t&&(n=t,t=null),t&&i.query(t),n&&i.end(n),i},_.head=function(e,t,n){var i=_("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i},_.del=f,_.delete=f,_.patch=function(e,t,n){var i=_("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i},_.post=function(e,t,n){var i=_("POST",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i},_.put=function(e,t,n){var i=_("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&i.send(t),n&&i.end(n),i}},{"./is-object":19,"./request":21,"./request-base":20,emitter:7,reduce:16}],19:[function(e,t,n){function i(e){return null!=e&&"object"==typeof e}t.exports=i},{}],20:[function(e,t,n){var i=e("./is-object");n.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},n.parse=function(e){return this._parser=e,this},n.timeout=function(e){return this._timeout=e,this},n.then=function(e,t){return this.end(function(n,i){n?t(n):e(i)})},n.use=function(e){return e(this),this},n.get=function(e){return this._header[e.toLowerCase()]},n.getHeader=n.get,n.set=function(e,t){if(i(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},n.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},n.field=function(e,t){return this._getFormData().append(e,t),this}},{"./is-object":19}],21:[function(e,t,n){function i(e,t,n){return"function"==typeof n?new e("GET",t).end(n):2==arguments.length?new e("GET",t):new e(t,n)}t.exports=i},{}],22:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],23:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],24:[function(e,t,n){(function(t,i){function r(e,t){var i={seen:[],stylize:a};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),y(t)?i.showHidden=t:t&&n._extend(i,t),A(i.showHidden)&&(i.showHidden=!1),A(i.depth)&&(i.depth=2),A(i.colors)&&(i.colors=!1),A(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),u(i,e,i.depth)}function o(e,t){var n=r.styles[t];return n?"["+r.colors[n][0]+"m"+e+"["+r.colors[n][1]+"m":e}function a(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function u(e,t,i){if(e.customInspect&&t&&k(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(i,e);return w(r)||(r=u(e,r,i)),r}var o=c(e,t);if(o)return o;var a=Object.keys(t),y=s(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),T(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(t);if(0===a.length){if(k(t)){var v=t.name?": "+t.name:"";return e.stylize("[Function"+v+"]","special")}if(b(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(E(t))return e.stylize(Date.prototype.toString.call(t),"date");if(T(t))return l(t)}var m="",g=!1,_=["{","}"];if(f(t)&&(g=!0,_=["[","]"]),k(t)){m=" [Function"+(t.name?": "+t.name:"")+"]"}if(b(t)&&(m=" "+RegExp.prototype.toString.call(t)),E(t)&&(m=" "+Date.prototype.toUTCString.call(t)),T(t)&&(m=" "+l(t)),0===a.length&&(!g||0==t.length))return _[0]+m+_[1];if(i<0)return b(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var A;return A=g?p(e,t,i,y,a):a.map(function(n){return d(e,t,i,y,n,g)}),e.seen.pop(),h(A,m,_)}function c(e,t){if(A(t))return e.stylize("undefined","undefined");if(w(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):y(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,i,r){for(var o=[],a=0,s=t.length;a<s;++a)D(t,String(a))?o.push(d(e,t,n,i,String(a),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(d(e,t,n,i,r,!0))}),o}function d(e,t,n,i,r,o){var a,s,c;if(c=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]},c.get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),D(i,r)||(a="["+r+"]"),s||(e.seen.indexOf(c.value)<0?(s=v(n)?u(e,c.value,null):u(e,c.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n"))):s=e.stylize("[Circular]","special")),A(a)){if(o&&r.match(/^\d+$/))return s;a=JSON.stringify(""+r),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e,t,n){var i=0;return e.reduce(function(e,t){return i++,t.indexOf("\n")>=0&&i++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function f(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function v(e){return null===e}function m(e){return null==e}function g(e){return"number"==typeof e}function w(e){return"string"==typeof e}function _(e){return"symbol"==typeof e}function A(e){return void 0===e}function b(e){return x(e)&&"[object RegExp]"===S(e)}function x(e){return"object"==typeof e&&null!==e}function E(e){return x(e)&&"[object Date]"===S(e)}function T(e){return x(e)&&("[object Error]"===S(e)||e instanceof Error)}function k(e){return"function"==typeof e}function C(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function S(e){return Object.prototype.toString.call(e)}function P(e){return e<10?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[P(e.getHours()),P(e.getMinutes()),P(e.getSeconds())].join(":");return[e.getDate(),O[e.getMonth()],t].join(" ")}function D(e,t){return Object.prototype.hasOwnProperty.call(e,t)}n.format=function(e){if(!w(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(r(arguments[n]));return t.join(" ")}for(var n=1,i=arguments,o=i.length,a=String(e).replace(/%[sdj%]/g,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return e}}),s=i[n];n<o;s=i[++n])v(s)||!x(s)?a+=" "+s:a+=" "+r(s);return a},n.deprecate=function(e,r){function o(){if(!a){if(t.throwDeprecation)throw new Error(r);t.traceDeprecation?console.trace(r):console.error(r),a=!0}return e.apply(this,arguments)}if(A(i.process))return function(){return n.deprecate(e,r).apply(this,arguments)};if(t.noDeprecation===!0)return e;var a=!1;return o};var V,I={};n.debuglog=function(e){if(A(V)&&(V=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(V)){var i=t.pid;I[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,i,t)}}else I[e]=function(){};return I[e]},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=f,n.isBoolean=y,n.isNull=v,n.isNullOrUndefined=m,n.isNumber=g,n.isString=w,n.isSymbol=_,n.isUndefined=A,n.isRegExp=b,n.isObject=x,n.isDate=E,n.isError=T,n.isFunction=k,n.isPrimitive=C,n.isBuffer=e("./support/isBuffer");var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",L(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!x(t))return e;for(var n=Object.keys(t),i=n.length;i--;)e[n[i]]=t[n[i]];return e}}).call(this,e("pBGvAp"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":23,inherits:22,pBGvAp:12}],25:[function(e,t,n){t.exports=e("./lib/VASTPlayer")},{"./lib/VASTPlayer":29}],26:[function(e,t,n){"use strict";function i(e,t,n){t.on(e,function(){for(var t=[],i=arguments.length;i--;)t[i]=arguments[i];n.emit.apply(n,[e].concat(t))})}function r(e,t,n){n.forEach(function(n){t.listeners(n).length>0&&i(n,e,t)}),t.on("newListener",function(r){n.indexOf(r)>-1&&t.listeners(r).length<1&&i(r,e,t)})}function o(e){this.events=e.slice(),this.__private__={target:null,source:null}}o.prototype.from=function(e){return this.__private__.source=e,this.__private__.target&&r(e,this.__private__.target,this.events),this},o.prototype.to=function(e){return this.__private__.target=e,this.__private__.source&&r(this.__private__.source,e,this.events),this},t.exports=o},{}],27:[function(e,t,n){"use strict";function i(e){var t=this;r.call(this,Math.floor(e.duration||0)),this.video=e,[a.PLAYING,a.PAUSE,a.TIMEUPDATE].forEach(function(n){return e.addEventListener(n,function(){return t.tick()},!1)})}var r=e("./VideoTracker"),o=e("util").inherits,a=e("./enums/HTML_MEDIA_EVENTS");o(i,r),i.prototype._getState=function(){return{playing:!this.video.paused,currentTime:this.video.currentTime}},t.exports=i},{"./VideoTracker":31,"./enums/HTML_MEDIA_EVENTS":32,util:24}],28:[function(e,t,n){"use strict";function i(e){return e}function r(e,t){(e||[]).forEach(function(e){(new Image).src=t(e)})}function o(e,t){this.pauseFlag=1,this.resumeFlag=1,this.pixels=e.reduce(function(e,t){return(e[t.event]||(e[t.event]=[])).push(t.uri),e},{}),this.__private__={mapper:t||i}}var a=e("./enums/VPAID_EVENTS");o.prototype.track=function(e){function t(e,t,a){function u(e){return s((t||i)(e))}return function(){if(!a||a()){var t=o.PlayToBridge(e,n[e]);switch(e){case"pause":if(!o.pauseFlag)return void(o.pauseFlag=1);break;case"resume":if(!o.resumeFlag)return void(o.resumeFlag=1)}t&&r(n[e],u)}}}var n=this.pixels,o=this,s=this.__private__.mapper,u=e.adVolume;e.on(a.AdSkipped,t("skip")),e.on(a.AdStarted,t("creativeView")),e.on(a.AdVolumeChange,t("unmute",null,function(){return 0===u&&e.adVolume>0})),e.on(a.AdVolumeChange,t("mute",null,function(){return u>0&&0===e.adVolume})),e.on(a.AdImpression,t("impression")),e.on(a.AdVideoStart,t("start")),e.on(a.AdVideoFirstQuartile,t("firstQuartile")),e.on(a.AdVideoMidpoint,t("midpoint")),e.on(a.AdVideoThirdQuartile,t("thirdQuartile")),e.on(a.AdVideoComplete,t("complete")),e.on(a.AdClickThru,t("clickThrough")),e.on(a.AdUserAcceptInvitation,t("acceptInvitationLinear")),e.on(a.AdUserMinimize,t("collapse")),e.on(a.AdUserClose,t("closeLinear")),e.on(a.AdPaused,t("pause")),e.on(a.AdPlaying,t("resume")),e.on(a.AdError,t("error",function(e){return e.replace(/\[ERRORCODE\]/g,901)})),e.on(a.AdVolumeChange,function(){u=e.adVolume})},t.exports=o},{"./enums/VPAID_EVENTS":34}],29:[function(e,t,n){"use strict";function i(){var e=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"];if(navigator.platform)for(;e.length;)if(navigator.platform===e.pop())return!0;return!1}function r(){var e=!1;if(void 0!==navigator.plugins&&"object"==typeof navigator.plugins["Shockwave Flash"])e=!0;else if(void 0!==window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")&&(e=!0)}catch(e){}return e}function o(){var e,t,n,i,r={},a=arguments.length;for(e=0;e<a;e++){t=arguments[e]||{};for(n in t)i=t[n],void 0===r[n]&&(r[n]=i),"object"==typeof i&&(r[n]=o(r[n],i))}return r}function a(e){return e}function s(){return new Error("VASTPlayer not ready.")}function u(e){return function(){var t=this,n=this.__private__.player;return this.ready?n[e].apply(n,arguments).then(function(){return t}):b.reject(s())}}function c(e){return{get:function(){if(!this.ready)throw s();return this.__private__.player[e]},set:function(t){if(!this.ready)throw s();return this.__private__.player[e]=t}}}function l(e,t){var n=this;p.call(this),this.__private__={container:e,config:o(t,{vast:{withCredentials:!0,resolveWrappers:!0,maxRedirects:7},tracking:{mapper:a}}),vast:null,ready:!1,player:null,pType:0},this.on(_.AdClickThru,function(e,t,i){if(this.chekcClicked())return!0;var r=e||n.vast.get("ads[0].creatives[0].videoClicks.clickThrough");i&&r&&window.open(r)})}var p=e("events").EventEmitter,d=e("util").inherits,h=e("vastacular").VAST,f=e("./players/JavaScriptVPAID"),y=e("./players/FlashVPAID"),v=e("./players/HTMLVideo"),m=e("./players/ANDROIDVideo"),g=e("./players/IOSVideo"),w=e("./enums/MIME"),_=e("./enums/VPAID_EVENTS"),A=e("./EventProxy"),b=e("lie"),x=e("./PixelReporter");d(l,p),Object.defineProperties(l.prototype,{container:{get:function(){return this.__private__.container}},config:{get:function(){return this.__private__.config}},vast:{get:function(){return this.__private__.vast}},ready:{get:function(){return this.__private__.ready}},adRemainingTime:c("adRemainingTime"),adDuration:c("adDuration"),adVolume:c("adVolume")}),l.prototype.chekcClicked=function(){return 4!=this.pType||this.__private__.player.privateStarted?0:(this.__private__.player.privateStarted=1,1)},l.prototype.load=function(e){var t=this,n=this.config.vast;return h.fetch(e,n).then(function(e){var n=i(),o=/(android)/i.test(navigator.userAgent),a=function(){var i=e.filter("ads[0].creatives[0].mediaFiles",function(e){return(e.type===w.JAVASCRIPT||"application/x-javascript"===e.type)&&"VPAID"===e.apiFramework}),a=e.filter("ads[0].creatives[0].mediaFiles",function(e){return e.type===w.FLASH&&"VPAID"===e.apiFramework&&r()}),s=e.filter("ads[0].creatives[0].mediaFiles",function(){return!0});return i.length>0?(t.pType=1,{player:new f(t.container),mediaFiles:i}):a.length>0?(t.pType=2,{player:new y(t.container,l.vpaidSWFLocation),mediaFiles:a}):(t.pType=3,n?{player:new g(t.container),mediaFiles:s}:o?(t.pType=4,{player:new m(t.container),mediaFiles:s}):{player:new v(t.container),mediaFiles:s})}(),s=e.get("ads[0].creatives[0].parameters"),u=[].concat(e.map("ads[0].impressions",function(e){return{event:"impression",uri:e.uri}}),e.map("ads[0].errors",function(e){return{event:"error",uri:e}}),e.get("ads[0].creatives[0].trackingEvents"),e.map("ads[0].creatives[0].videoClicks.clickTrackings",function(e){return{event:"clickThrough",uri:e}})),c=a.player,p=a.mediaFiles,d=new A(_),h=new x(u,t.config.tracking.mapper);return h.PlayToBridge=function(e,t){return 1},"function"==typeof t.config.bidgeFn&&(h.PlayToBridge=function(e,n){return t.config.bidgeFn(t.id_local_source,e,n),1}),d.from(c).to(t),t.__private__.vast=e,t.__private__.player=c,c.id1=t.id_local_source,c.load(p,s).then(function(){h.track(c)})}).then(function(){return t.__private__.ready=!0,t.emit("ready"),t}).catch(function(e){throw t.emit("error",e),e})},l.prototype.startAd=u("startAd"),l.prototype.stopAd=u("stopAd"),l.prototype.pauseAd=u("pauseAd"),l.prototype.resumeAd=u("resumeAd"),l.vpaidSWFLocation="https://cdn.jsdelivr.net/vast-player/0.2.9/vast-player--vpaid.swf",t.exports=l},{"./EventProxy":26,"./PixelReporter":28,"./enums/MIME":33,"./enums/VPAID_EVENTS":34,"./players/ANDROIDVideo":36,"./players/FlashVPAID":37,"./players/HTMLVideo":38,"./players/IOSVideo":39,"./players/JavaScriptVPAID":40,events:8,lie:10,util:24,vastacular:44}],30:[function(e,t,n){"use strict";function i(e){var t=e.split(".").map(parseFloat);this.string=e,this.major=t[0],this.minor=t[1],this.patch=t[2],Object.freeze(this)}i.prototype.toString=function(){return this.string},t.exports=i},{}],31:[function(e,t,n){"use strict";function i(e,t){t.fired[e]||(t.emit(e),t.fired[e]=!0)}function r(e){o.apply(this,arguments),this.duration=e,this.seconds=Array.apply([],new Array(e)).map(function(){return!1}),this.fired=[s.AdVideoStart,s.AdVideoFirstQuartile,s.AdVideoMidpoint,s.AdVideoThirdQuartile,s.AdVideoComplete].reduce(function(e,t){return e[t]=!1,e},{})}var o=e("events").EventEmitter,a=e("util").inherits,s=e("./enums/VPAID_EVENTS");a(r,o),r.prototype.tick=function(){function e(e){var n=o[e-1];return t.slice(0,n).every(function(e){return e===!0})}var t=this.seconds,n=this._getState(),r=Math.round(n.currentTime)-1;r>-1&&this.emit(s.AdRemainingTimeChange,{sec:r,dur:this.duration});var o=[1,2,3,4].map(function(e){return Math.floor(this.duration/4*e)},this);n.playing&&(i(s.AdVideoStart,this),r>-1&&(this.seconds[r]=!0)),e(1)&&i(s.AdVideoFirstQuartile,this),e(2)&&i(s.AdVideoMidpoint,this),e(3)&&i(s.AdVideoThirdQuartile,this),e(4)&&i(s.AdVideoComplete,this)},t.exports=r},{"./enums/VPAID_EVENTS":34,events:8,util:24}],32:[function(e,t,n){"use strict";var i=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];i.forEach(function(e){this[e.toUpperCase()]=e},i),Object.freeze(i),t.exports=i},{}],33:[function(e,t,n){var i={JAVASCRIPT:"application/javascript",FLASH:"application/x-shockwave-flash"};Object.freeze(i),t.exports=i},{}],34:[function(e,t,n){"use strict"
;var i=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"];i.forEach(function(e){i[e]=e}),Object.freeze(i),t.exports=i},{}],35:[function(e,t,n){"use strict";var i=e("./window"),r=document.createElement("video"),o=e("./enums/MIME");n.isDesktop=!/Android|Silk|Mobile|PlayBook/.test(i.navigator.userAgent),n.canPlay=function(e){var t=i.navigator.mimeTypes,n=i.ActiveXObject;switch(e){case o.FLASH:try{return new n("ShockwaveFlash.ShockwaveFlash")?2:0}catch(e){return t&&t[o.FLASH]?2:0}return 0;case o.JAVASCRIPT:case"application/x-javascript":return 2;default:if(r.canPlayType)switch(r.canPlayType(e)){case"probably":return 2;case"maybe":return 1;default:return 0}}return 0},Object.freeze(n)},{"./enums/MIME":33,"./window":43}],36:[function(e,t,n){"use strict";function i(e,t,n){return e.addEventListener(t,n,!1)}function r(e,t,n){return e.removeEventListener(t,n,!1)}function o(e,t,n){return i(e,t,function i(){return r(e,t,i),n.apply(this,arguments)})}function a(e,t){function n(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return p.reject(n());throw n()}return e.apply(this,arguments)}}function s(e,t){var n=t.width,i=e.map(function(e){return{mediaFile:e,playability:d(e.type)}}).filter(function(e){return e.playability>0}).sort(h("-playability","-mediaFile.bitrate")),r=i.map(function(e){return e.mediaFile.hasOwnProperty("width")&&e.mediaFile.width||(e.mediaFile.width=1e3),Math.abs(n-e.mediaFile.width)}),o=i[r.indexOf(Math.min.apply(Math,r))];return!o||o.playability<1?null:o.mediaFile}function u(e){this.container=e,this.video=null,this.privateStarted=0,this.__private__={hasPlayed:!1}}var c=e("events").EventEmitter,l=e("util").inherits,p=e("lie"),d=e("../environment").canPlay,h=e("sort-by"),f=e("../enums/VPAID_EVENTS"),y=e("../enums/HTML_MEDIA_EVENTS"),v=e("../HTMLVideoTracker"),m=e("../EventProxy");l(u,c),Object.defineProperties(u.prototype,{adRemainingTime:{get:a(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:a(function(){return this.video.duration})},adVolume:{get:a(function(){return this.video.volume}),set:a(function(e){this.video.volume=e})}}),u.prototype.load=function(e){var t=this;return new p(function(n,r){var a=document.createElement("video"),u=s(e,t.container.getBoundingClientRect());if(!u)return r(new Error("There are no playable <MediaFile>s."));a.setAttribute("playsinline",!0),a.setAttribute("webkit-playsinline",!0),a.src=u.uri,a.preload="auto",a.style.display="block",a.style.width="100%",a.style.height="100%",a.style.objectFit="contain",o(a,y.LOADEDMETADATA,function(){var e=new v(a);new m(f).from(e).to(t),t.video=a,n(t),t.emit(f.AdLoaded),i(a,y.DURATIONCHANGE,function(){t.emit(f.AdDurationChange)}),i(a,y.VOLUMECHANGE,function(){t.emit(f.AdVolumeChange)})}),o(a,y.ERROR,function(){var e=a.error;t.emit(f.AdError,e.message),r(e)}),o(a,y.PLAYING,function(){t.__private__.hasPlayed=!0,t.emit(f.AdImpression)}),o(a,y.ENDED,function(){t.stopAd()}),i(a,"click",function(){t.privateStarted,t.emit(f.AdClickThru,null,null,!0)}),t.container.appendChild(a)})},u.prototype.startAd=a(function(){var e=this;this.video;return this.__private__.hasPlayed?p.reject(new Error("The ad has already been started.")):new p(function(t){return t(e),!0})},!0),u.prototype.stopAd=a(function(){return this.container.removeChild(this.video),this.emit(f.AdStopped),p.resolve(this)},!0),u.prototype.pauseAd=a(function(){var e=this,t=this.video;return this.video.paused?p.resolve(this):new p(function(n){return o(t,y.PAUSE,function(){n(e),e.emit(f.AdPaused)}),n(e),t.pause()})},!0),u.prototype.resumeAd=a(function(){var e=this,t=this.video;return this.__private__.hasPlayed?this.video.paused?new p(function(n){return o(t,y.PLAY,function(){n(e),e.emit(f.AdPlaying)}),t.play()}):p.resolve(this):p.reject(new Error("The ad has not been started yet."))},!0),t.exports=u},{"../EventProxy":26,"../HTMLVideoTracker":27,"../enums/HTML_MEDIA_EVENTS":32,"../enums/VPAID_EVENTS":34,"../environment":35,events:8,lie:10,"sort-by":17,util:24}],37:[function(e,t,n){"use strict";function i(e,t){r.apply(this,arguments),this.swfURI=t,this.object=null}var r=e("./VPAID"),o=e("util").inherits,a=e("lie"),s=e("../uuid"),u=e("querystring"),c=e("../enums/VPAID_EVENTS"),l=e("../VPAIDVersion");o(i,r),i.prototype.load=function(e,t){var n=this,i=e[0].uri,r=e[0].bitrate;return this.playDelay=1,new a(function(e,o){function a(e){if(n.playDelay){if(console.log(["таймер ",e]),e>0)return void setTimeout(function(){a(e-1)},1e3);n.playDelay=1,o("flash 50 сек")}}function p(e){n.container.removeChild(d),n.api=null,n.object=null,delete window[h],e&&o(e)}var d=document.createElement("object"),h="vast_player__"+s(20),f=u.stringify({vpaidURI:i,eventCallback:h});d.type="application/x-shockwave-flash",d.data=n.swfURI+"?"+f,d.style.display="block",d.style.width="100%",d.style.height="100%",d.style.border="none",d.style.opacity="0",d.innerHTML=['<param name="movie" value="'+n.swfURI+'">','<param name="flashvars" value="'+f+'">','<param name="quality" value="high">','<param name="play" value="false">','<param name="loop" value="false">','<param name="wmode" value="opaque">','<param name="scale" value="noscale">','<param name="salign" value="lt">','<param name="allowScriptAccess" value="always">'].join("\n"),n.object=d,window[h]=function(e){switch(console.log(["event",e.type]),e.type){case c.AdClickThru:return n.emit(e.type,e.url,e.Id,e.playerHandles);case c.AdInteraction:case c.AdLog:return n.emit(e.type,e.Id);case c.AdError:return n.emit(e.type,e.message);default:return n.emit(e.type)}},n.once("VPAIDInterfaceReady",function(){var e=d.getBoundingClientRect(),i=n.vpaidVersion=new l(d.handshakeVersion("2.0"));if(i.major>2)return o(new Error("VPAID version "+i+" is not supported."));n.on("VPAIDInterfaceResize",function(){var e=d.getBoundingClientRect();n.resizeAd(e.width,e.height,"normal")}),d.initAd(e.width,e.height,"normal",r,t,null)}),n.once(c.AdPlaying,function(){a(50)}),n.once(c.AdLoaded,function(){n.api=d,d.style.opacity="1",e(n)}),n.once(c.AdError,function(e){p(new Error(e))}),n.once(c.AdStopped,p),n.container.appendChild(d)})},t.exports=i},{"../VPAIDVersion":30,"../enums/VPAID_EVENTS":34,"../uuid":42,"./VPAID":41,lie:10,querystring:15,util:24}],38:[function(e,t,n){"use strict";function i(e,t,n){return e.addEventListener(t,n,!1)}function r(e,t,n){return e.removeEventListener(t,n,!1)}function o(e,t,n){return i(e,t,function i(){return r(e,t,i),n.apply(this,arguments)})}function a(e,t){function n(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return p.reject(n());throw n()}return e.apply(this,arguments)}}function s(e,t){var n=t.width,i=e.map(function(e){return{mediaFile:e,playability:d(e.type)}}).filter(function(e){return e.playability>0}).sort(h("-playability","-mediaFile.bitrate")),r=i.map(function(e){return e.mediaFile.hasOwnProperty("width")&&e.mediaFile.width||(e.mediaFile.width=1e3),Math.abs(n-e.mediaFile.width)}),o=i[r.indexOf(Math.min.apply(Math,r))];return!o||o.playability<1?null:o.mediaFile}function u(e){this.container=e,this.video=null,this.__private__={hasPlayed:!1}}var c=e("events").EventEmitter,l=e("util").inherits,p=e("lie"),d=e("../environment").canPlay,h=e("sort-by"),f=e("../enums/VPAID_EVENTS"),y=e("../enums/HTML_MEDIA_EVENTS"),v=e("../HTMLVideoTracker"),m=e("../EventProxy");l(u,c),Object.defineProperties(u.prototype,{adRemainingTime:{get:a(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:a(function(){return this.video.duration})},adVolume:{get:a(function(){return this.video.volume}),set:a(function(e){this.video.volume=e})}}),u.prototype.load=function(e){var t=this;return new p(function(n,r){var a=document.createElement("video"),u=s(e,t.container.getBoundingClientRect());if(!u)return r(new Error("There are no playable <MediaFile>s."));a.setAttribute("webkit-playsinline",!0),a.src=u.uri,a.preload="auto",a.style.display="block",a.style.width="100%",a.style.height="100%",a.style.objectFit="contain",o(a,y.LOADEDMETADATA,function(){var e=new v(a);new m(f).from(e).to(t),t.video=a,n(t),t.emit(f.AdLoaded),i(a,y.DURATIONCHANGE,function(){t.emit(f.AdDurationChange)}),i(a,y.VOLUMECHANGE,function(){t.emit(f.AdVolumeChange)})}),o(a,y.ERROR,function(){var e=a.error;t.emit(f.AdError,e.message),r(e)}),o(a,y.PLAYING,function(){t.__private__.hasPlayed=!0,t.emit(f.AdImpression)}),o(a,y.ENDED,function(){t.stopAd()}),i(a,"click",function(){t.emit(f.AdClickThru,null,null,!0)}),t.container.appendChild(a)})},u.prototype.startAd=a(function(){var e=this,t=this.video;return t.volume=.1,this.__private__.hasPlayed?p.reject(new Error("The ad has already been started.")):new p(function(n){return o(t,y.PLAYING,function(){n(e),e.emit(f.AdStarted)}),t.play()})},!0),u.prototype.stopAd=a(function(){return this.container.removeChild(this.video),this.emit(f.AdStopped),p.resolve(this)},!0),u.prototype.pauseAd=a(function(){var e=this,t=this.video;return this.video.paused?p.resolve(this):new p(function(n){return o(t,y.PAUSE,function(){n(e),e.emit(f.AdPaused)}),t.pause()})},!0),u.prototype.resumeAd=a(function(){var e=this,t=this.video;return this.__private__.hasPlayed?this.video.paused?new p(function(n){return o(t,y.PLAY,function(){n(e),e.emit(f.AdPlaying)}),t.play()}):p.resolve(this):p.reject(new Error("The ad has not been started yet."))},!0),t.exports=u},{"../EventProxy":26,"../HTMLVideoTracker":27,"../enums/HTML_MEDIA_EVENTS":32,"../enums/VPAID_EVENTS":34,"../environment":35,events:8,lie:10,"sort-by":17,util:24}],39:[function(e,t,n){"use strict";function i(e,t,n){return e.addEventListener(t,n,!1)}function r(e,t,n){return e.removeEventListener(t,n,!1)}function o(e,t,n){return i(e,t,function i(){return r(e,t,i),n.apply(this,arguments)})}function a(e,t){function n(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return p.reject(n());throw n()}return e.apply(this,arguments)}}function s(e,t){var n=t.width,i=e.map(function(e){return{mediaFile:e,playability:d(e.type)}}).filter(function(e){return e.playability>0}).sort(h("-playability","-mediaFile.bitrate")),r=i.map(function(e){return e.mediaFile.hasOwnProperty("width")&&e.mediaFile.width||(e.mediaFile.width=1e3),Math.abs(n-e.mediaFile.width)}),o=i[r.indexOf(Math.min.apply(Math,r))];return!o||o.playability<1?null:o.mediaFile}function u(e){this.container=e,this.video=null,this.__private__={hasPlayed:!1}}var c=e("events").EventEmitter,l=e("util").inherits,p=e("lie"),d=e("../environment").canPlay,h=e("sort-by"),f=e("../enums/VPAID_EVENTS"),y=e("../enums/HTML_MEDIA_EVENTS"),v=e("../HTMLVideoTracker"),m=e("../EventProxy");l(u,c),Object.defineProperties(u.prototype,{adRemainingTime:{get:a(function(){return this.video.duration-this.video.currentTime})},adDuration:{get:a(function(){return this.video.duration})},adVolume:{get:a(function(){return this.video.volume}),set:a(function(e){this.video.volume=e})}}),u.prototype.load=function(e){var t=this;return new p(function(n,r){var a=document.createElement("video"),u=s(e,t.container.getBoundingClientRect());if(!u)return r(new Error("There are no playable <MediaFile>s."));a.setAttribute("muted",!0),a.setAttribute("playsinline",!0),a.setAttribute("webkit-playsinline",!0),a.src=u.uri,a.preload="auto",a.style.display="block",a.style.width="100%",a.style.height="100%",a.style.objectFit="contain",o(a,y.LOADEDMETADATA,function(){var e=new v(a);new m(f).from(e).to(t),t.video=a,n(t),t.emit(f.AdLoaded),i(a,y.DURATIONCHANGE,function(){t.emit(f.AdDurationChange)}),i(a,y.VOLUMECHANGE,function(){t.emit(f.AdVolumeChange)})}),o(a,y.ERROR,function(){var e=a.error;t.emit(f.AdError,e.message),r(e)}),o(a,y.PLAYING,function(){t.__private__.hasPlayed=!0,t.emit(f.AdImpression)}),o(a,y.ENDED,function(){t.stopAd()}),i(a,"click",function(){t.emit(f.AdClickThru,null,null,!0)}),t.container.appendChild(a)})},u.prototype.startAd=a(function(){var e=this,t=this.video;return this.__private__.hasPlayed?p.reject(new Error("The ad has already been started.")):new p(function(n){return o(t,y.PLAYING,function(){n(e),e.emit(f.AdStarted)}),window.enableInlineVideo(t,{everywhere:!0}),t.play()})},!0),u.prototype.stopAd=a(function(){return this.emit(f.AdStopped),p.resolve(this)},!0),u.prototype.pauseAd=a(function(){var e=this,t=this.video;return this.video.paused?p.resolve(this):(t.className="",new p(function(n){return o(t,y.PAUSE,function(){n(e),e.emit(f.AdPaused)}),t.pause()}))},!0),u.prototype.resumeAd=a(function(){var e=this,t=this.video;return this.__private__.hasPlayed?(t.className="IIV",this.video.paused?new p(function(n){return o(t,y.PLAY,function(){n(e),e.emit(f.AdPlaying)}),t.play()}):p.resolve(this)):p.reject(new Error("The ad has not been started yet."))},!0),t.exports=u},{"../EventProxy":26,"../HTMLVideoTracker":27,"../enums/HTML_MEDIA_EVENTS":32,"../enums/VPAID_EVENTS":34,"../environment":35,events:8,lie:10,"sort-by":17,util:24}],40:[function(e,t,n){"use strict";function i(){o.apply(this,arguments),this.playDelay=1,this.playClean=0,this.mypaused=1,this.frame=null}var r=e("util").inherits,o=e("./VPAID"),a=e("lie"),s=e("../enums/VPAID_EVENTS"),u=e("../environment").isDesktop,c=e("../VPAIDVersion");r(i,o),i.prototype.load=function(e,t){var n=this,i=e[0].uri,r=e[0].bitrate;return new a(function(e,o){function a(e){}function l(e){n.playClean=1;try{n.container.removeChild(h)}catch(e){}n.frame=null,n.api=null,e&&o(e)}function p(e){if(!n.playClean){if(a(n.vpaApi),e>0)return void setTimeout(function(){p(e-1)},5e3);n.stopAd()}}function d(e){if(!n.playClean&&n.playDelay)return e>0?void setTimeout(function(){d(e-1)},1e3):void l(new Error("vpaid не загрузился в течении 18 сек"))}var h=document.createElement("iframe");h.scrolling="no";var f=document.createElement("script"),y=document.createElement("video");d(14),h.src="about:blank",h.style.width="100%",h.style.height="100%",h.style.display="block",h.style.opacity="0",h.style.border="none",y.setAttribute("webkit-playsinline","true"),y.style.display="block",y.style.width="100%",y.style.height="100%",y.style.objectFit="contain",n.container.appendChild(h),h.contentWindow.document.open(),h.contentWindow.document.close(),h.contentWindow.document.body.style.margin="0",n.frame=h,f.src=i,n.id1,console.log(["третья стадия",n.id1,f.src]),f.onload=function(){function i(){var e=h.getBoundingClientRect();n.resizeAd(e.width,e.height,"normal")}var a=h.contentWindow.getVPAIDAd();33!=n.id1&&34!=n.id1||(y.style.display="none");var d=h.getBoundingClientRect(),f=h.contentWindow.document.body,v=n.vpaidVersion=new c(a.handshakeVersion("2.0"));if(v.major>2)return o(new Error("VPAID version "+v+" is not supported."));h.contentWindow.addEventListener("resize",i,!1),s.forEach(function(e){return a.subscribe(function(){for(var t=new Array(arguments.length),i=arguments.length;i--;)t[i]=arguments[i];return n.emit.apply(n,[e].concat(t))},e)}),n.once(s.AdLoaded,function(){n.playDelay=0,h.style.opacity="1",n.api=a,31==n.id1||n.id1,e(n)}),n.once(s.AdError,function(e){l(new Error(e))}),n.once(s.AdStopped,function(){l()}),n.vpaApi=a,31!=n.id1&&32!=n.id1||n.once(s.AdPlaying,function(){p(12)}),a.initAd(d.width,d.height,"normal",r,{AdParameters:t},{slot:f,videoSlot:y,videoSlotCanAutoPlay:u})},f.onerror=function(){l(new Error("Failed to load MediaFile ["+i+"]."))},h.contentWindow.document.body.appendChild(y),h.contentWindow.document.head.appendChild(f)})},t.exports=i},{"../VPAIDVersion":30,"../enums/VPAID_EVENTS":34,"../environment":35,"./VPAID":41,lie:10,util:24}],41:[function(e,t,n){"use strict";function i(e,t){return function(){function n(){return new Error("Ad has not been loaded.")}function i(){return o[e].apply(o,r)}var r=arguments,o=this.api,a=this;if(!t){if(!o)throw n();return i()}return new s(function(e,r){return o?(a.once(t,function(){e(a)}),i()):r(n())})}}function r(e){this.container=e,this.api=null,this.vpaidVersion=null}var o=e("util").inherits,a=e("events").EventEmitter,s=e("lie"),u=e("../enums/VPAID_EVENTS");o(r,a),Object.defineProperties(r.prototype,{adLinear:{get:i("getAdLinear")},adWidth:{get:i("getAdWidth")},adHeight:{get:i("getAdHeight")},adExpanded:{get:i("getAdExpanded")},adSkippableState:{get:i("getAdSkippableState")},adRemainingTime:{get:i("getAdRemainingTime")},adDuration:{get:i("getAdDuration")},adVolume:{get:i("getAdVolume"),set:i("setAdVolume")},adCompanions:{get:i("getAdCompanions")},adIcons:{get:i("getAdIcons")}}),r.prototype.load=function(){throw new Error("VPAID subclass must implement load() method.")},r.prototype.resizeAd=i("resizeAd",u.AdSizeChange),r.prototype.startAd=i("startAd",u.AdStarted),r.prototype.stopAd=i("stopAd",u.AdStopped),r.prototype.pauseAd=i("pauseAd",u.AdPaused),r.prototype.resumeAd=i("resumeAd",u.AdPlaying),r.prototype.expandAd=i("expandAd",u.AdExpandedChange),r.prototype.collapseAd=i("collapseAd",u.AdExpandedChange),r.prototype.skipAd=i("skipAd",u.AdSkipped),t.exports=r},{"../enums/VPAID_EVENTS":34,events:8,lie:10,util:24}],42:[function(e,t,n){"use strict";var i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r=i.length;t.exports=function(e){for(var t="";e--;)t+=i.charAt(Math.floor(Math.random()*r));return t}},{}],43:[function(e,t,n){t.exports=window},{}],44:[function(e,t,n){n.VAST=e("./lib/VAST")},{"./lib/VAST":45}],45:[function(e,t,n){"use strict";function i(){}function r(e){h({description:null,survey:null},e)}function o(){}function a(e){h({trackingEvents:[],parameters:null,videoClicks:null},e),(e.mediaFiles||[]).forEach(function(e){h({id:null,bitrate:null,scalable:null,maintainAspectRatio:null,apiFramework:null},e)})}function s(e){e.companions.forEach(function(e){h({expandedWidth:null,expandedHeight:null,apiFramework:null,trackingEvents:[],clickThrough:null,altText:null,parameters:null},e)})}function u(e){h({trackingEvents:[]},e),e.ads.forEach(function(e){h({id:null,expandedWidth:null,expandedHeight:null,scalable:null,maintainAspectRatio:null,minSuggestedDuration:null,apiFramework:null,clickThrough:null,parameters:null},e)})}function c(e){d(e,this,!0),this.ads.forEach(function(e){h({system:{version:null},errors:[]},e),e.creatives.forEach(function(e){h({id:null,sequence:null,adID:null},e),w[e.type](e)}),g[e.type](e)}),this.__private__={wrappers:[],inlines:[]}}var l=e("lie"),p=e("superagent"),d=e("./utils/copy"),h=e("./utils/defaults"),f=e("./utils/extend"),y=e("./utils/nodeify_promise"),v=Array.prototype.push,m=e("./xml_from_vast"),g={inline:r,wrapper:o},w={linear:a,companions:s,nonLinear:u};Object.defineProperties(c.prototype,{wrappers:{get:function(){var e=this.__private__.wrappers;return e.length=0,v.apply(e,this.filter("ads",function(e){return"wrapper"===e.type})),e}},inlines:{get:function(){var e=this.__private__.inlines;return e.length=0,v.apply(e,this.filter("ads",function(e){return"inline"===e.type})),e}}}),c.prototype.get=function(e){return((e||"").match(/[^\[\]\.]+/g)||[]).reduce(function(e,t){return(e||void 0)&&e[t]},this)},c.prototype.set=function(e,t){function n(e,t){switch(e.input.charAt(t)){case".":return Object;case"[":return Array;case"]":return n(e,t+1);default:return null}}var i=function(){for(var t,i=/[^\[\]\.]+/g,r=[];t=i.exec(e);)r.push({token:t[0],type:n(t,t.index+t[0].length)});return r}(),r=i.pop(),o=i.reduce(function(e,t){return e[t.token]||(e[t.token]=new t.type)},this);if(!e)throw new Error("prop must be specified.");return o[r.token]=t},c.prototype.map=function(e,t){var n=this.get(e)||[],i=n.length,r=[];if(!(n instanceof Array))return r;for(var o=0;o<i;o++)r.push(t.call(this,n[o],o,n));return r},c.prototype.filter=function(e,t){var n=this.get(e)||[],i=n.length,r=[];if(!(n instanceof Array))return r;for(var o=0;o<i;o++)t.call(this,n[o],o,n)&&r.push(n[o]);return r},c.prototype.find=function(e,t){var n=this.get(e)||[],i=n.length;if(n instanceof Array)for(var r=0;r<i;r++)if(t.call(this,n[r],r,n))return n[r]},c.prototype.toPOJO=function(){var e=JSON.parse(JSON.stringify(this));return delete e.__private__,e},c.prototype.copy=function(){return new this.constructor(this.toPOJO())},c.prototype.resolveWrappers=function(){function e(e,t){function n(e){return function(t){return t.type===e}}var i=function(e){return{linear:e.filter(n("linear")),companions:e.filter(n("companions")),nonLinear:e.filter(n("nonLinear"))}}(e.creatives);return h(e.impressions,t.impressions),h(e.errors,t.errors),void 0!==e.extensions&&h(e.extensions,t.extensions),t.creatives.forEach(function(e){h(i[e.type].shift()||{},e)}),v.apply(t.creatives,"wrapper"!==t.type?[]:["linear","companions","nonLinear"].reduce(function(e,t){return e.concat(i[t])},[])),t}var t=isNaN(arguments[0])?1/0:arguments[0],n="function"==typeof arguments[0]?arguments[0]:arguments[1],i=this.constructor,r=this;return 0===t?l.reject(new Error("Too many redirects were made.")):y(l.all(this.map("wrappers",function(e){return l.resolve(p.get(e.vastAdTagURI)).then(function(t){return{wrapper:e,response:i.pojoFromXML(t.text).ads}})})).then(function(t){var n=t.map(function(e){return e.wrapper}),o=t.map(function(e){return e.response});return new i(f(r.toPOJO(),{ads:r.map("ads",function(t){var i=n.indexOf(t),r=n[i],a=o[i];return a?a.map(e.bind(null,r)):[t]}).reduce(function(e,t){return e.concat(t)})}))}).then(function(e){return e.get("wrappers.length")>0?e.resolveWrappers(t-1):e}),n)},c.prototype.toXML=function(){var e=this.validate();if(!e.valid)throw new Error("VAST is invalid: "+e.reasons.join(", "));return m(this)},c.prototype.validate=function(){function e(e,t){e||a.push(t)}function t(t){e(o.get(t),t+" is required")}function n(t){e(o.get(t+".length")>0,t+" must contain at least one value")}function r(e,i){i.exists.map(e).forEach(t),i.atLeastOne.map(e).forEach(n)}var o=this,a=[],s={inline:function(e){var t={linear:function(e){r(e,{exists:["duration"],atLeastOne:["mediaFiles"]})},companions:function(e){o.get(e("companions")).forEach(function(t,n){function i(t){return e("companions["+n+"]."+t)}r(i,{exists:[],atLeastOne:["resources"]})})},nonLinear:function(e){o.get(e("ads")).forEach(function(t,n){function i(t){return e("ads["+n+"]."+t)}r(i,{exists:[],atLeastOne:["resources"]})})}};r(e,{exists:["title"],atLeastOne:["creatives"]}),o.get(e("creatives")).forEach(function(n,o){function a(t){return e("creatives["+o+"]."+t)}r(a,{exists:["type"],atLeastOne:[]}),(t[n.type]||i)(a)})},wrapper:function(e){r(e,{exists:["vastAdTagURI"],atLeastOne:[]})}};return r(function(e){return e},{exists:[],atLeastOne:["ads"]}),this.get("ads").forEach(function(e,t){function n(e){return"ads["+t+"]."+e}r(n,{exists:["type","system.name"],atLeastOne:["impressions"]}),(s[e.type]||i)(n)}),{valid:0===a.length,reasons:0===a.length?null:a}},c.pojoFromXML=e("./pojo_from_xml"),c.fetch=function(e){var t="object"==typeof arguments[1]?arguments[1]||{}:{},n="function"==typeof arguments[2]?arguments[2]:arguments[1],i=this;return y(l.resolve(p.get(e).set(t.headers||{})).then(function(e){var n=new i(i.pojoFromXML(e.text));return t.resolveWrappers?n.resolveWrappers(t.maxRedirects):n}),n)},t.exports=c},{"./pojo_from_xml":46,"./utils/copy":48,"./utils/defaults":49,"./utils/extend":50,"./utils/nodeify_promise":51,"./xml_from_vast":58,lie:10,superagent:18}],46:[function(e,t,n){"use strict";function i(e){return e[0]||{attributes:{}}}function r(e){return e.find("StaticResource,IFrameResource,HTMLResource").map(function(e){return{type:e.tag.replace(/Resource$/,"").toLowerCase(),creativeType:e.attributes.creativeType,data:e.value}})}function o(e){var t=i(e.find("Duration")),n=e.find("Tracking"),r=i(e.find("AdParameters")),o=e.find("VideoClicks")[0],a=e.find("MediaFile");return{type:"linear",duration:p(t.value)||void 0,trackingEvents:n.map(function(e){return{event:e.attributes.event,uri:e.value}}),parameters:r.value,videoClicks:o&&function(){var e=i(o.find("ClickThrough")),t=o.find("ClickTracking"),n=o.find("CustomClick");return{clickThrough:e.value,clickTrackings:t.map(function(e){return e.value}),customClicks:n.map(function(e){return{id:e.attributes.id,uri:e.value}})}}(),mediaFiles:a.map(function(e){var t=e.attributes;return{id:t.id,delivery:t.delivery,type:t.type,uri:e.value,bitrate:y(t.bitrate),width:y(t.width),height:y(t.height),scalable:d(t.scalable),maintainAspectRatio:d(t.maintainAspectRatio),apiFramework:t.apiFramework}})}}function a(e){return{type:"companions",companions:e.find("Companion").map(function(e){var t=e.find("Tracking"),n=i(e.find("CompanionClickThrough")),o=i(e.find("AltText")),a=i(e.find("AdParameters"));return{id:e.attributes.id,width:y(e.attributes.width),height:y(e.attributes.height),expandedWidth:y(e.attributes.expandedWidth),expandedHeight:y(e.attributes.expandedHeight),apiFramework:e.attributes.apiFramework,resources:r(e),trackingEvents:t.map(function(e){return{event:e.attributes.event,uri:e.value}}),clickThrough:n.value,altText:o.value,parameters:a.value}})}}function s(e){var t=e.find("NonLinear"),n=e.find("Tracking");return{type:"nonLinear",ads:t.map(function(e){var t=i(e.find("NonLinearClickThrough")),n=i(e.find("AdParameters"));return{id:e.attributes.id,width:y(e.attributes.width),height:y(e.attributes.height),expandedWidth:y(e.attributes.expandedWidth),expandedHeight:y(e.attributes.expandedHeight),scalable:d(e.attributes.scalable),maintainAspectRatio:d(e.attributes.maintainAspectRatio),minSuggestedDuration:p(e.attributes.minSuggestedDuration)||void 0,apiFramework:e.attributes.apiFramework,resources:r(e),clickThrough:t.value,parameters:n.value}}),trackingEvents:n.map(function(e){return{event:e.attributes.event,uri:e.value}})}}function u(e){var t=i(e.find("AdTitle")),n=i(e.find("Description")),r=i(e.find("Survey"));return{type:"inline",title:t.value,description:n.value,survey:r.value}}function c(e){return{type:"wrapper",vastAdTagURI:i(e.find("VASTAdTagURI")).value}}var l=e("./utils/parse_xml"),p=e("./utils/timestamp_to_seconds"),d=e("./utils/string_to_boolean"),h=e("./utils/extend"),f=e("./utils/trim_object"),y=e("./utils/numberify"),v={linear:o,companions:a,nonLinear:s},m={inline:u,wrapper:c};t.exports=function(e){var t=l(e);if(!t("VAST")[0])throw new Error("["+e+"] is not a valid VAST document.");return f({version:i(t("VAST")).attributes.version,ads:t("Ad").map(function(e){var t=i(e.find("Wrapper,InLine")).tag.toLowerCase(),n=i(e.find("AdSystem")),r=e.find("Error"),o=e.find("Impression"),a=e.find("Creative"),s=e.find("Extension"),u=s.map(function(e){if(e&&e.attributes)return e.value?e.value=e.value.replace(/^\s+|\s+$/,""):e.value="",{type:e.attributes.type,value:e.value}});return h({id:e.attributes.id,system:{name:n.value,version:n.attributes.version},errors:r.map(function(e){return e.value}),impressions:o.map(function(e){return{uri:e.value,id:e.attributes.id}}),extensions:u,creatives:a.map(function(e){var t=function(){switch(i(e.find("Linear,CompanionAds,NonLinearAds")).tag){case"Linear":return"linear";case"CompanionAds":return"companions";case"NonLinearAds":return"nonLinear"}}();return h({id:e.attributes.id,sequence:y(e.attributes.sequence),adID:e.attributes.AdID},v[t](e))})},m[t](e))})},!0)}},{"./utils/extend":50,"./utils/numberify":52,"./utils/parse_xml":53,"./utils/string_to_boolean":55,"./utils/timestamp_to_seconds":56,"./utils/trim_object":57}],47:[function(e,t,n){"use strict";function i(e){return null!==e&&void 0!==e}function r(e){return void 0!==e?String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function o(e){for(var t="";e--;)t+=" ";return t}function a(e){return(void 0!==e?function(e){for(var t,n,i=[],r=/]]>/g,o=0;t=r.exec(e);)n=t.index+2,i.push(t.input.substring(o,n)),o=n;return i.push(e.substring(o,e.length)),i}(String(e)):[""]).reduce(function(e,t){return e+"<![CDATA["+t+"]]>"},"")}function s(e){return e.cdata?a(e.value):r(e.value)}function u(e,t,n){var a=e.tag,c=e.attributes||{},l=Object.keys(c),p=e.children||[],d=e.value,h=p.length>0,f=l.every(function(e){return i(c[e])})&&l.length>0,y=i(d)||h||f,v=o(t),m="<"+a+Object.keys(c).reduce(function(e,t){return n&&!i(c[t])?e:e+" "+t+'="'+r(c[t])+'"'},"")+">",g="</"+a+">";return!n||y||e.required?h?[v+m].concat(e.children.reduce(function(e,i){return e.concat(u(i,t+4,n))},[]),[v+g]):[v+m+s(e)+g]:[]}t.exports=function(e,t){return['<?xml version="1.0" encoding="UTF-8"?>'].concat(u(e,0,t)).join("\n")}},{}],48:[function(e,t,n){"use strict";function i(e,t,n){return Object.keys(e).reduce(function(t,i){return t[i]=n?o(e[i],null,!0):e[i],t},t||{})}function r(e,t,n){var i=t||[];return a.apply(i,n?e.map(function(e){return o(e,null,!0)}):e),i}function o(e){var t=("object"==typeof arguments[1]||null)&&arguments[1],n="boolean"==typeof arguments[1]?arguments[1]:arguments[2];return Object(e)!==e?e:e instanceof Array?r(e,t,n):i(e,t,n)}var a=Array.prototype.push;t.exports=o},{}],49:[function(e,t,n){"use strict";function i(e){return Object(e)===e}function r(e){return e instanceof Array}var o=Array.prototype.push;t.exports=function e(t,n){return[t,n].every(r)?(o.apply(n,t.filter(function(e){return n.indexOf(e)<0})),n):Object.keys(t).reduce(function(n,r){return[t[r],n[r]].every(i)&&e(t[r],n[r]),r in n||(n[r]=t[r]),n},n)}},{}],50:[function(e,t,n){"use strict";t.exports=function(){return Array.prototype.slice.call(arguments).reduce(function(e,t){return Object.keys(t||{}).reduce(function(e,n){return e[n]=t[n],e},e)},{})}},{}],51:[function(e,t,n){"use strict";t.exports=function(e,t){return"function"!=typeof t?e:(e.then(function(e){t(null,e)},function(e){t(e)}),e)}},{}],52:[function(e,t,n){"use strict";t.exports=function(e){if(/string|number|boolean/.test(typeof e))return isNaN(e)?void 0:Number(e)}},{}],53:[function(e,t,n){"use strict";function i(e){var t=e.childElementCount>0;return{tag:e.tagName,value:t?null:e.textContent,attributes:s.call(e.attributes,function(e,t){return e[t.name]=t.value,e},{}),find:function(t){return r(e.querySelectorAll(t))},children:function(){return a.call(e.childNodes,function(e){return e instanceof Element}).map(i)}}}function r(e){return o.call(e,i)}var o=Array.prototype.map,a=Array.prototype.filter,s=Array.prototype.reduce,u=new DOMParser;t.exports=function(e){var t=u.parseFromString(e,"application/xml");return function(e){return r(t.querySelectorAll(e))}}},{}],54:[function(e,t,n){"use strict";function i(e){return(e>9?"":"0")+e.toString()}t.exports=function(e){return Number(e)!==e?null:[Math.floor(e/60/60),Math.floor(e/60%60),Math.floor(e%60%60)].map(i).join(":")}},{}],55:[function(e,t,n){"use strict";t.exports=function(e){switch((e||"").toLowerCase()){case"true":return!0;case"false":return!1}}},{}],56:[function(e,t,n){"use strict";t.exports=function(e){var t=(e||"").match(/^(\d\d):(\d\d):(\d\d)$/);return t&&t.slice(1,4).map(parseFloat).reduce(function(e,t,n){return e+t*Math.pow(60,Math.abs(n-2))},0)}},{}],57:[function(e,t,n){"use strict";t.exports=function e(t,n){return Object(t)!==t?t:Object.keys(t).reduce(function(i,r){return n&&t[r]instanceof Array?i[r]=t[r].filter(function(e){return void 0!==e}).map(function(t){return e(t,!0)}):n&&t[r]instanceof Object?i[r]=e(t[r],!0):void 0!==t[r]&&(i[r]=t[r]),i},{})}},{}],58:[function(e,t,n){"use strict";function i(e){return{tag:"TrackingEvents",children:e.map(function(e){return{tag:"Tracking",attributes:{event:e.event},value:e.uri,cdata:!0}})}}function r(e){return e.map(function(e){return{tag:function(e){switch(e){case"static":return"StaticResource";case"iframe":return"IFrameResource";case"html":return"HTMLResource"}}(e.type),attributes:{creativeType:e.creativeType},value:e.data,cdata:!0}})}function o(e){return{tag:"AdParameters",value:e.parameters}}function a(e){return{tag:"Linear",children:[{tag:"Duration",value:c(e.duration)},i(e.trackingEvents),o(e)].concat(e.videoClicks?[{tag:"VideoClicks",children:[{tag:"ClickThrough",
value:e.videoClicks.clickThrough,cdata:!0}].concat(e.videoClicks.clickTrackings.map(function(e){return{tag:"ClickTracking",value:e,cdata:!0}}),e.videoClicks.customClicks.map(function(e){return{tag:"CustomClick",attributes:{id:e.id},value:e.uri,cdata:!0}}))}]:[],[{tag:"MediaFiles",children:e.mediaFiles.map(function(e){return{tag:"MediaFile",attributes:{id:e.id,width:e.width,height:e.height,bitrate:e.bitrate,type:e.type,delivery:e.delivery,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,apiFramework:e.apiFramework},value:e.uri,cdata:!0}})}])}}function s(e){return{tag:"CompanionAds",children:e.companions.map(function(e){return{tag:"Companion",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,apiFramework:e.apiFramework},children:r(e.resources).concat([i(e.trackingEvents),{tag:"CompanionClickThrough",value:e.clickThrough,cdata:!0},{tag:"AltText",value:e.altText},o(e)])}})}}function u(e){return{tag:"NonLinearAds",children:e.ads.map(function(e){return{tag:"NonLinear",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,minSuggestedDuration:c(e.minSuggestedDuration),apiFramework:e.apiFramework},children:r(e.resources).concat([{tag:"NonLinearClickThrough",value:e.clickThrough,cdata:!0},o(e)])}}).concat([i(e.trackingEvents)])}}var c=e("./utils/seconds_to_timestamp"),l=e("./utils/compile_xml"),p={linear:a,companions:s,nonLinear:u};t.exports=function(e){return l({tag:"VAST",attributes:{version:e.get("version")},children:e.map("ads",function(e){return{tag:"Ad",attributes:{id:e.id},children:[{tag:function(){switch(e.type){case"inline":return"InLine";case"wrapper":return"Wrapper"}}(),children:[{tag:"AdSystem",attributes:{version:e.system.version},value:e.system.name},{tag:"AdTitle",value:e.title},{tag:"Description",value:e.description},{tag:"Survey",value:e.survey,cdata:!0},{tag:"VASTAdTagURI",value:e.vastAdTagURI,cdata:!0}].concat(e.errors.map(function(e){return{tag:"Error",value:e,cdata:!0}}),e.impressions.map(function(e){return{tag:"Impression",value:e.uri,cdata:!0,attributes:{id:e.id}}}),[{tag:"Creatives",children:e.creatives.map(function(e){return{tag:"Creative",attributes:{id:e.id,sequence:e.sequence,AdID:e.adID},children:[function(t){return p[t](e)}(e.type)]}}),required:!0}])}]}})},!0)}},{"./utils/compile_xml":47,"./utils/seconds_to_timestamp":54}],59:[function(e,t,n){"use strict";function i(e){console.log("MyVastEnded"),CallAction("adEvent",{index:e.page_index,eventName:"MyVastEnded"},window.parent)}var r=e("./../models_1/dispatcher"),o=e("./../models_1/configurator"),a=e("./../models_1/iFrameBridge");window.Bridge=a.Bridge,window.CallAction=a.callAction;var s=function(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,n,i){e[n]=i});return e}();if(void 0===s.index&&(s.index="broadcast"),s.hasOwnProperty("site")&&s.site)var u=s.site;else var u=function(){var e=window.location!=window.parent.location?document.referrer:document.location.href;return new URL(e).hostname}();new o({auth:{affiliate_id:s.affiliate_id,pid:s.pid,host:u},successFn:function(e){e.page_index=s.index,s.hasOwnProperty("site")&&s.site&&(e.site=s.site),r.prototype.timerToCloseFn=function(){if(this.timerToClose<0)return void this.playExit();this.timerToClose--;var e=this;setTimeout(function(){e.timerToCloseFn()},1e3)},window.colorPixels=new r("mycontoller","container","placeholder"),window.colorPixels.playType=1,window.colorPixels.timerToClose=80,window.colorPixels.timerToCloseFn(),window.colorPixels.setConfig(e,i)}})},{"./../models_1/configurator":3,"./../models_1/dispatcher":4,"./../models_1/iFrameBridge":6}]},{},[59]);